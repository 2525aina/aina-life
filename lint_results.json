[
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/app/calendar/page.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'formatTime' is assigned a value but never used.",
        "line": 38,
        "column": 13,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 38,
        "endColumn": 23
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 307,
        "column": 162,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 307,
        "endColumn": 165,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [20299, 20302], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [20299, 20302], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 1,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useState, useMemo } from 'react';\nimport { AppLayout } from '@/components/features/AppLayout';\nimport { usePetContext } from '@/contexts/PetContext';\nimport { useMembers } from '@/hooks/useMembers';\nimport { useEntries, useCalendarEntries } from '@/hooks/useEntries';\nimport { useFriends } from '@/hooks/useFriends';\nimport { useCustomTasks } from '@/hooks/useCustomTasks';\nimport { useTimeFormat } from '@/hooks/useTimeFormat';\nimport { EntryDetailSheet } from '@/components/features/EntryDetailSheet';\nimport { EntryEditSheet } from '@/components/features/EntryEditSheet';\nimport { EntryNewSheet } from '@/components/features/EntryNewSheet';\nimport Image from 'next/image';\nimport { Button } from '@/components/ui/button';\nimport { ENTRY_TAGS, type Entry } from '@/lib/types';\nimport { format, startOfMonth, endOfMonth, startOfWeek, endOfWeek, eachDayOfInterval, isSameMonth, isSameDay, addMonths, subMonths, addWeeks, subWeeks, addDays, subDays, startOfDay } from 'date-fns';\nimport { ja } from 'date-fns/locale';\nimport { ChevronLeft, ChevronRight, Plus } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { cn } from '@/lib/utils';\nimport { toast } from 'sonner';\n\ntype ViewMode = 'month' | 'week' | 'day';\n\nexport default function CalendarPage() {\n    const { selectedPet } = usePetContext();\n    const { canEdit } = useMembers(selectedPet?.id || null);\n    const [currentDate, setCurrentDate] = useState(new Date());\n\n    // Calendar view data\n    const { entries, loading } = useCalendarEntries(selectedPet?.id || null, currentDate);\n\n    // Action methods\n    const { addEntry, updateEntry, deleteEntry } = useEntries(selectedPet?.id || null);\n    const { friends } = useFriends(selectedPet?.id || null);\n    const { tasks } = useCustomTasks(selectedPet?.id || null);\n    const { formatTime } = useTimeFormat();\n\n    // Sheet states\n    const [selectedEntry, setSelectedEntry] = useState<Entry | null>(null);\n    const [sheetMode, setSheetMode] = useState<'detail' | 'edit' | null>(null);\n    const [isNewSheetOpen, setIsNewSheetOpen] = useState(false);\n    const [isSubmitting, setIsSubmitting] = useState(false);\n    const [viewMode, setViewMode] = useState<ViewMode>('month');\n    const [selectedDate, setSelectedDate] = useState(new Date());\n\n    // Group entries by date, including multi-day entries on all spanned days\n    const entriesByDate = useMemo(() => {\n        const grouped: Record<string, typeof entries> = {};\n\n        entries.forEach((entry) => {\n            const startDate = startOfDay(entry.date.toDate());\n            const endDate = entry.timeType === 'range' && entry.endDate\n                ? startOfDay(entry.endDate.toDate())\n                : startDate;\n\n            // Add entry to all days it spans\n            const daysToAdd = eachDayOfInterval({ start: startDate, end: endDate });\n            daysToAdd.forEach((day) => {\n                const dateKey = format(day, 'yyyy-MM-dd');\n                if (!grouped[dateKey]) grouped[dateKey] = [];\n                // Avoid duplicates\n                if (!grouped[dateKey].find(e => e.id === entry.id)) {\n                    grouped[dateKey].push(entry);\n                }\n            });\n        });\n\n        return grouped;\n    }, [entries]);\n\n    const calendarDays = useMemo(() => {\n        if (viewMode === 'month') {\n            const start = startOfWeek(startOfMonth(currentDate), { weekStartsOn: 0 });\n            const end = endOfWeek(endOfMonth(currentDate), { weekStartsOn: 0 });\n            return eachDayOfInterval({ start, end });\n        }\n        if (viewMode === 'week') {\n            const start = startOfWeek(currentDate, { weekStartsOn: 0 });\n            const end = endOfWeek(currentDate, { weekStartsOn: 0 });\n            return eachDayOfInterval({ start, end });\n        }\n        return [currentDate];\n    }, [currentDate, viewMode]);\n\n    const navigate = (direction: 'prev' | 'next') => {\n        if (viewMode === 'month') {\n            setCurrentDate((prev) => direction === 'prev' ? subMonths(prev, 1) : addMonths(prev, 1));\n        } else if (viewMode === 'week') {\n            const newDate = direction === 'prev' ? subWeeks(currentDate, 1) : addWeeks(currentDate, 1);\n            setCurrentDate(newDate);\n            setSelectedDate(newDate); // Sync selected date with week navigation\n        } else {\n            const newDate = direction === 'prev' ? subDays(currentDate, 1) : addDays(currentDate, 1);\n            setCurrentDate(newDate);\n            setSelectedDate(newDate); // Sync selected date with day navigation\n        }\n    };\n\n    const selectedDateEntries = useMemo(() => entriesByDate[format(selectedDate, 'yyyy-MM-dd')] || [], [selectedDate, entriesByDate]);\n    const weekDays = ['Êó•', 'Êúà', 'ÁÅ´', 'Ê∞¥', 'Êú®', 'Èáë', 'Âúü'];\n\n    return (\n        <AppLayout>\n\n            <div className=\"relative min-h-screen pb-32\">\n                {/* Global Header Gradient */}\n                <div className=\"absolute inset-0 h-[40vh] bg-gradient-to-b from-primary/20 via-primary/5 to-transparent -z-10 rounded-b-[4rem]\" />\n\n                <div className=\"px-4 pt-6 space-y-6\">\n                    {/* Header Controls */}\n                    <div className=\"flex items-center justify-between z-10 relative\">\n                        <div className=\"glass-capsule p-1 flex items-center space-x-1 shadow-lg bg-white/40 dark:bg-black/40 backdrop-blur-xl border border-white/10\">\n                            {(['month', 'week', 'day'] as const).map(mode => (\n                                <button\n                                    key={mode}\n                                    onClick={() => setViewMode(mode)}\n                                    className={cn(\n                                        \"px-5 py-2.5 min-h-[44px] rounded-full text-sm font-bold transition-all duration-300\",\n                                        viewMode === mode\n                                            ? \"bg-primary text-white shadow-md shadow-primary/30\"\n                                            : \"text-muted-foreground hover:text-foreground hover:bg-white/10\"\n                                    )}\n                                >\n                                    {mode === 'month' ? 'Êúà' : mode === 'week' ? 'ÈÄ±' : 'Êó•'}\n                                </button>\n                            ))}\n                        </div>\n\n                        <div className=\"flex items-center gap-2\">\n                            <Button variant=\"ghost\" size=\"icon\" onClick={() => navigate('prev')} className=\"rounded-full w-10 h-10 hover:bg-white/20 text-foreground/80 hover:text-foreground backdrop-blur-sm transition-all hover:scale-110 active:scale-95\"><ChevronLeft className=\"w-6 h-6\" /></Button>\n                            <h2 className=\"text-2xl font-black tracking-tight min-w-[4rem] text-center pt-1.5 bg-clip-text text-transparent bg-gradient-to-r from-foreground to-foreground/70\">\n                                {viewMode === 'month' && format(currentDate, 'MÊúà', { locale: ja })}\n                                {viewMode !== 'month' && format(currentDate, 'M/d')}\n                            </h2>\n                            <Button variant=\"ghost\" size=\"icon\" onClick={() => navigate('next')} className=\"rounded-full w-10 h-10 hover:bg-white/20 text-foreground/80 hover:text-foreground backdrop-blur-sm transition-all hover:scale-110 active:scale-95\"><ChevronRight className=\"w-6 h-6\" /></Button>\n                        </div>\n                    </div>\n\n                    {/* Calendar Grid Container */}\n                    <motion.div\n                        initial={{ opacity: 0, y: 10 }}\n                        animate={{ opacity: 1, y: 0 }}\n                        className={cn(\n                            \"glass rounded-[2rem] p-4 overflow-hidden shadow-xl ring-1 ring-white/20\",\n                            viewMode === 'day' && \"hidden\"\n                        )}\n                    >\n                        <div className=\"grid grid-cols-7 mb-2 opacity-60\">\n                            {weekDays.map((day, i) => (\n                                <div key={day} className={cn('text-center text-[10px] font-bold py-2', i === 0 && 'text-red-500', i === 6 && 'text-blue-500')}>\n                                    {day}\n                                </div>\n                            ))}\n                        </div>\n\n                        <div className={cn('grid grid-cols-7 gap-1', viewMode === 'month' ? 'auto-rows-[1fr]' : 'h-32')}>\n                            {calendarDays.map((day) => {\n                                const dateKey = format(day, 'yyyy-MM-dd');\n                                const dayEntries = entriesByDate[dateKey] || [];\n                                const isToday = isSameDay(day, new Date());\n                                const isSelected = isSameDay(day, selectedDate);\n                                const isCurrentMonth = isSameMonth(day, currentDate);\n                                const dayOfWeek = day.getDay();\n\n                                return (\n                                    <button\n                                        key={dateKey}\n                                        onClick={() => setSelectedDate(day)}\n                                        className={cn(\n                                            'relative aspect-[4/5] rounded-xl flex flex-col items-center justify-start pt-2 transition-all duration-300 group outline-none',\n                                            isSelected ? 'bg-primary/10 ring-2 ring-primary/30' : 'hover:bg-white/10 dark:hover:bg-white/5',\n                                            !isCurrentMonth && viewMode === 'month' && 'opacity-20'\n                                        )}\n                                    >\n                                        <span className={cn(\n                                            'text-xs font-semibold z-10 w-6 h-6 flex items-center justify-center rounded-full transition-all',\n                                            isToday ? 'bg-gradient-to-tr from-primary to-orange-400 text-white shadow-lg shadow-primary/30 scale-110' : 'text-foreground/80',\n                                            dayOfWeek === 0 && !isToday && 'text-red-400',\n                                            dayOfWeek === 6 && !isToday && 'text-blue-400'\n                                        )}>\n                                            {format(day, 'd')}\n                                        </span>\n\n                                        {/* Indicators */}\n                                        {dayEntries.length > 0 && (\n                                            <div className=\"mt-1.5 flex flex-wrap justify-center content-start gap-0.5 px-1 w-full h-full overflow-hidden opacity-80\">\n                                                {dayEntries.slice(0, 4).map((e) => {\n                                                    const tagInfo = tasks.find((t) => t.name === e.tags[0]) || ENTRY_TAGS.find((t) => t.value === e.tags[0]);\n                                                    return (\n                                                        <span key={e.id} className=\"text-[8px] leading-none\">\n                                                            {tagInfo?.emoji || '‚Ä¢'}\n                                                        </span>\n                                                    )\n                                                })}\n                                                {dayEntries.length > 4 && <span className=\"text-[8px] leading-none text-muted-foreground\">+</span>}\n                                            </div>\n                                        )}\n                                    </button>\n                                );\n                            })}\n                        </div>\n                    </motion.div>\n\n                    {/* Selected Date Details */}\n                    <div className=\"space-y-4\">\n                        <div className=\"flex items-center justify-between px-2\">\n                            <div>\n                                <p className=\"text-xs font-medium text-muted-foreground\">{format(selectedDate, 'yyyyÂπ¥', { locale: ja })}</p>\n                                <h3 className=\"text-xl font-bold flex items-center gap-2\">\n                                    {format(selectedDate, 'MÊúàdÊó• (E)', { locale: ja })}\n                                </h3>\n                            </div>\n                        </div>\n\n                        <AnimatePresence mode=\"wait\">\n                            {loading ? (\n                                <div className=\"space-y-3\">{[...Array(2)].map((_, i) => <div key={i} className=\"h-20 bg-muted/20 animate-pulse rounded-2xl\" />)}</div>\n                            ) : selectedDateEntries.length === 0 ? (\n                                <motion.div\n                                    initial={{ opacity: 0, scale: 0.95 }}\n                                    animate={{ opacity: 1, scale: 1 }}\n                                    exit={{ opacity: 0 }}\n                                    className=\"glass-capsule rounded-3xl p-6 text-center py-10 border-dashed\"\n                                >\n                                    <p className=\"text-muted-foreground\">Ë®òÈå≤„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì</p>\n                                </motion.div>\n                            ) : (\n                                <motion.div\n                                    initial={{ opacity: 0 }}\n                                    animate={{ opacity: 1 }}\n                                    exit={{ opacity: 0 }}\n                                    className=\"space-y-3\"\n                                >\n                                    {selectedDateEntries.sort((a, b) => a.date.toDate().getTime() - b.date.toDate().getTime()).map((entry) => {\n                                        const isSchedule = entry.type === 'schedule';\n                                        return (\n                                            <div key={entry.id} onClick={() => {\n                                                // Convert EntrySummary to Partial Entry for DetailSheet\n                                                const fullEntry: Entry = {\n                                                    ...entry,\n                                                    imageUrls: entry.firstImageUrl ? [entry.firstImageUrl] : [],\n                                                    tags: entry.tags || [],\n                                                } as Entry;\n                                                setSelectedEntry(fullEntry);\n                                                setSheetMode('detail');\n                                            }} className=\"cursor-pointer\">\n                                                <motion.div\n                                                    whileHover={{ scale: 1.02 }}\n                                                    className={cn(\n                                                        \"flex items-center gap-4 p-4 rounded-2xl border transition-all duration-300\",\n                                                        isSchedule\n                                                            ? \"bg-blue-50/50 dark:bg-blue-900/10 border-blue-200 dark:border-blue-800\"\n                                                            : \"glass border-white/40 dark:border-white/10\"\n                                                    )}\n                                                >\n                                                    <div className=\"flex flex-col items-center flex-shrink-0 w-20\">\n                                                        {(() => {\n                                                            const startDate = entry.date.toDate();\n                                                            const startOnSelectedDay = isSameDay(startDate, selectedDate);\n\n                                                            if (entry.timeType === 'range' && entry.endDate) {\n                                                                const endDate = entry.endDate.toDate();\n                                                                const isSameDayRange = isSameDay(startDate, endDate);\n\n                                                                if (isSameDayRange) {\n                                                                    // Same day range: \"10:00 ~ 12:00\"\n                                                                    return (\n                                                                        <span className=\"text-[10px] font-bold text-muted-foreground\">\n                                                                            {format(startDate, 'H:mm')} ~ {format(endDate, 'H:mm')}\n                                                                        </span>\n                                                                    );\n                                                                } else {\n                                                                    // Multi-day range: show both dates\n                                                                    return (\n                                                                        <div className=\"flex flex-col items-center text-[9px] font-bold text-muted-foreground leading-tight\">\n                                                                            <span>{format(startDate, 'M/d H:mm')}</span>\n                                                                            <span className=\"text-primary/50\">~</span>\n                                                                            <span>{format(endDate, 'M/d H:mm')}</span>\n                                                                        </div>\n                                                                    );\n                                                                }\n                                                            } else {\n                                                                // Point time: show date if different, else just time\n                                                                return (\n                                                                    <span className=\"text-xs font-bold text-muted-foreground\">\n                                                                        {!startOnSelectedDay && <span className=\"text-[9px] opacity-60\">{format(startDate, 'M/d')} </span>}\n                                                                        {format(startDate, 'H:mm')}\n                                                                    </span>\n                                                                );\n                                                            }\n                                                        })()}\n                                                    </div>\n\n                                                    <div className=\"flex-1 min-w-0\">\n                                                        <div className=\"flex items-center gap-2 mb-0.5\">\n                                                            <div className=\"flex -space-x-1\">\n                                                                {entry.tags.map(tag => {\n                                                                    const t = tasks.find((x) => x.name === tag) || ENTRY_TAGS.find((x) => x.value === tag);\n                                                                    return <span key={tag} className=\"text-base\">{t?.emoji}</span>;\n                                                                })}\n                                                            </div>\n                                                            {(() => {\n                                                                const firstTag = entry.tags[0];\n                                                                const tagInfo = tasks.find((x) => x.name === firstTag) || ENTRY_TAGS.find((x) => x.value === firstTag);\n                                                                const displayName = entry.title || (tagInfo && ('label' in tagInfo ? tagInfo.label : (tagInfo as any).name)) || firstTag;\n                                                                return <p className=\"font-bold text-sm truncate\">{displayName}</p>;\n                                                            })()}\n                                                        </div>\n                                                        {entry.body && <p className=\"text-xs text-muted-foreground line-clamp-1\">{entry.body}</p>}\n                                                    </div>\n\n                                                    {/* Changed image check to firstImageUrl */}\n                                                    {entry.firstImageUrl && (\n                                                        <div className=\"w-10 h-10 rounded-lg overflow-hidden ring-1 ring-white/50 flex-shrink-0 relative\">\n                                                            <Image src={entry.firstImageUrl} alt=\"\" fill className=\"object-cover\" />\n                                                        </div>\n                                                    )}\n                                                </motion.div>\n                                            </div>\n                                        )\n                                    })}\n                                </motion.div>\n                            )}\n                        </AnimatePresence>\n                    </div>\n                </div>\n\n                {/* Sticky FAB */}\n                {canEdit && (\n                    <div className=\"sticky bottom-24 z-20 flex justify-center px-4 pt-6\">\n                        <motion.button\n                            onClick={() => setIsNewSheetOpen(true)}\n                            whileHover={{ scale: 1.05 }}\n                            whileTap={{ scale: 0.95 }}\n                            className=\"flex items-center gap-2 px-8 h-14 rounded-full bg-gradient-to-r from-primary to-orange-500 shadow-xl shadow-primary/30 text-white font-bold transition-all duration-300 hover:shadow-2xl hover:shadow-orange-500/50 hover:brightness-110\"\n                        >\n                            <Plus className=\"w-5 h-5\" />\n                            <span>Êó•Ë®ò„ÇíË®òÈå≤</span>\n                        </motion.button>\n                    </div>\n                )}\n\n                {/* Entry Detail Sheet */}\n                <EntryDetailSheet\n                    entry={selectedEntry}\n                    open={sheetMode === 'detail'}\n                    onClose={() => { setSelectedEntry(null); setSheetMode(null); }}\n                    onEdit={() => setSheetMode('edit')}\n                    onDelete={async (id) => { await deleteEntry(id); }}\n                    tasks={tasks}\n                    friends={friends}\n                    canEdit={canEdit}\n                />\n\n                {/* Entry Edit Sheet */}\n                <EntryEditSheet\n                    entry={selectedEntry}\n                    open={sheetMode === 'edit'}\n                    onClose={() => { setSelectedEntry(null); setSheetMode(null); }}\n                    onSave={async (id, data) => {\n                        setIsSubmitting(true);\n                        try {\n                            await updateEntry(id, data);\n                            toast.success('‰øùÂ≠ò„Åó„Åæ„Åó„Åü');\n                        } finally {\n                            setIsSubmitting(false);\n                        }\n                    }}\n                    isSubmitting={isSubmitting}\n                />\n\n                {/* Entry New Sheet */}\n                <EntryNewSheet\n                    open={isNewSheetOpen}\n                    onClose={() => setIsNewSheetOpen(false)}\n                    onSave={async (data) => {\n                        setIsSubmitting(true);\n                        try {\n                            await addEntry(data);\n                            toast.success('Ë®òÈå≤„Åó„Åæ„Åó„Åü');\n                        } finally {\n                            setIsSubmitting(false);\n                        }\n                    }}\n                    isSubmitting={isSubmitting}\n                />\n            </div>\n        </AppLayout>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/app/dashboard/page.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 27,
        "column": 37,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 27,
        "endColumn": 40,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [1182, 1185], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [1182, 1185], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useState } from 'react';\nimport { AppLayout } from '@/components/features/AppLayout';\nimport { PendingInvitations } from '@/components/features/PendingInvitations';\nimport { usePetContext } from '@/contexts/PetContext';\nimport { useMembers } from '@/hooks/useMembers';\nimport { Button } from '@/components/ui/button';\nimport { Plus, Calendar as CalendarIcon, Settings } from 'lucide-react';\nimport Link from 'next/link';\nimport { motion } from 'framer-motion';\nimport { TimelineView } from '@/components/dashboard/TimelineView';\nimport { format } from 'date-fns';\nimport { ja } from 'date-fns/locale';\nimport Image from 'next/image';\nimport { EntryNewSheet } from '@/components/features/EntryNewSheet';\nimport { useEntries } from '@/hooks/useEntries';\nimport { toast } from 'sonner';\n\nexport default function DashboardPage() {\n    const { selectedPet } = usePetContext();\n    const { canEdit } = useMembers(selectedPet?.id || null);\n    const { addEntry } = useEntries(selectedPet?.id || null);\n    const [isNewSheetOpen, setIsNewSheetOpen] = useState(false);\n    const [isSubmitting, setIsSubmitting] = useState(false);\n\n    const handleSave = async (data: any) => {\n        setIsSubmitting(true);\n        try {\n            await addEntry(data);\n            toast.success('Ë®òÈå≤„Åó„Åæ„Åó„Åü');\n            setIsNewSheetOpen(false);\n        } catch (e) {\n            console.error(e);\n            toast.error('‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');\n        } finally {\n            setIsSubmitting(false);\n        }\n    };\n\n    if (!selectedPet) {\n        return (\n            <AppLayout>\n                <div className=\"p-4 space-y-6 flex flex-col items-center justify-center min-h-[70vh]\">\n                    <PendingInvitations />\n                    <motion.div\n                        initial={{ opacity: 0, scale: 0.9 }}\n                        animate={{ opacity: 1, scale: 1 }}\n                        className=\"text-center py-12 w-full max-w-sm bg-white/50 dark:bg-black/20 backdrop-blur-xl rounded-3xl border border-white/20 shadow-xl p-8\"\n                    >\n                        <div className=\"w-28 h-28 mx-auto rounded-full overflow-hidden mb-6 ring-4 ring-primary/20 shadow-lg\">\n                            <Image src=\"/ogp.webp\" alt=\"Welcome\" width={112} height={112} className=\"w-full h-full object-cover\" priority />\n                        </div>\n                        <h2 className=\"text-2xl font-bold mb-3 bg-clip-text text-transparent bg-gradient-to-r from-primary to-primary/60\">„Çà„ÅÜ„Åì„ÅùÔºÅ</h2>\n                        <p className=\"text-muted-foreground mb-8 leading-relaxed\">\n                            „Åæ„Åö„ÅØ„Éö„ÉÉ„Éà„ÇíÁôªÈå≤„Åó„Å¶„ÄÅ<br />\n                            Êñ∞„Åó„ÅÑÊÄù„ÅÑÂá∫‰Ωú„Çä„ÇíÂßã„ÇÅ„Åæ„Åó„Çá„ÅÜ„ÄÇ\n                        </p>\n                        <Link href=\"/pets/new\" className=\"block\">\n                            <Button size=\"lg\" className=\"w-full rounded-xl gradient-primary shadow-lg hover:shadow-primary/25 transition-all hover:scale-105\">\n                                <Plus className=\"w-5 h-5 mr-2\" />\n                                „Éö„ÉÉ„Éà„ÇíÁôªÈå≤„Åô„Çã\n                            </Button>\n                        </Link>\n                    </motion.div>\n                </div>\n            </AppLayout>\n        );\n    }\n\n    return (\n        <AppLayout>\n\n            <div className=\"relative min-h-screen pb-24\">\n                {/* Global Header Gradient */}\n                <div className=\"absolute inset-0 h-[40vh] bg-gradient-to-b from-primary/20 via-primary/5 to-transparent -z-10 rounded-b-[4rem]\" />\n\n                <div className=\"fixed bottom-0 right-0 w-[80%] h-[50%] bg-blue-400/5 rounded-full blur-[100px] -z-20 pointer-events-none\" />\n\n                <div className=\"sticky top-14 z-20 px-4 pt-4 pb-4 bg-gradient-to-b from-background via-background/95 to-transparent backdrop-blur-sm\">\n                    <PendingInvitations />\n\n                    {/* Header */}\n                    <div className=\"flex items-end justify-between relative mt-2\">\n                        <div>\n                            <p className=\"text-xs font-bold text-muted-foreground mb-1 pl-1\">\n                                {format(new Date(), 'yyyyÂπ¥MÊúàdÊó• (E)', { locale: ja })}\n                            </p>\n                            <h1 className=\"text-3xl sm:text-4xl font-black tracking-tighter filter drop-shadow-sm\">\n                                <span className=\"bg-clip-text text-transparent bg-gradient-to-r from-foreground to-foreground/80\">\n                                    {selectedPet.name}\n                                </span>\n                            </h1>\n                        </div>\n                        <div className=\"flex gap-2 sm:gap-3\">\n                            <Link href=\"/calendar\">\n                                <Button variant=\"ghost\" size=\"icon\" className=\"rounded-full w-10 h-10 sm:w-12 sm:h-12 bg-white/40 dark:bg-black/20 hover:bg-white/50 backdrop-blur-md shadow-sm border border-white/20 transition-all hover:scale-110 active:scale-95\">\n                                    <CalendarIcon className=\"w-5 h-5 sm:w-6 sm:h-6 text-foreground/80\" />\n                                </Button>\n                            </Link>\n                            <Link href={`/pets/settings?id=${selectedPet.id}`}>\n                                <Button variant=\"ghost\" size=\"icon\" className=\"rounded-full w-10 h-10 sm:w-12 sm:h-12 bg-white/40 dark:bg-black/20 hover:bg-white/50 backdrop-blur-md shadow-sm border border-white/20 transition-all hover:scale-110 active:scale-95\">\n                                    <Settings className=\"w-5 h-5 sm:w-6 sm:h-6 text-foreground/80\" />\n                                </Button>\n                            </Link>\n                        </div>\n                    </div>\n                </div>\n\n                <div className=\"px-2\">\n                    {/* Timeline */}\n                    <TimelineView />\n                </div>\n\n                {/* FAB - sticky above footer */}\n                {canEdit && (\n                    <div className=\"sticky bottom-24 z-20 flex justify-center px-4 pt-6\">\n                        <motion.button\n                            onClick={() => setIsNewSheetOpen(true)}\n                            whileTap={{ scale: 0.95 }}\n                            whileHover={{ scale: 1.05 }}\n                            className=\"flex items-center gap-2 px-8 h-14 rounded-full bg-gradient-to-r from-primary to-orange-500 shadow-xl shadow-primary/30 text-white font-bold transition-all duration-300 hover:shadow-2xl hover:shadow-orange-500/50 hover:brightness-110\"\n                        >\n                            <Plus className=\"w-5 h-5\" />\n                            <span>Êó•Ë®ò„ÇíË®òÈå≤</span>\n                        </motion.button>\n                    </div>\n                )}\n\n                <EntryNewSheet\n                    open={isNewSheetOpen}\n                    onClose={() => setIsNewSheetOpen(false)}\n                    onSave={handleSave}\n                    isSubmitting={isSubmitting}\n                />\n            </div>\n        </AppLayout>\n    );\n}\n\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/app/friends/page.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 47,
        "column": 43,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 47,
        "endColumn": 46,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [2011, 2014], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [2011, 2014], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { AppLayout } from '@/components/features/AppLayout';\nimport { usePetContext } from '@/contexts/PetContext';\nimport { useMembers } from '@/hooks/useMembers';\nimport { useFriends } from '@/hooks/useFriends';\nimport { Plus, MapPin, Calendar, Search } from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { format } from 'date-fns';\nimport { useState } from 'react';\nimport { Input } from '@/components/ui/input';\nimport Image from 'next/image';\nimport { Timestamp } from 'firebase/firestore';\nimport { FriendDetailSheet } from '@/components/features/FriendDetailSheet';\nimport { FriendFormSheet } from '@/components/features/FriendFormSheet';\nimport { toast } from 'sonner';\nimport { Friend } from '@/lib/types';\n\n// „Ç≠„É£„ÉÉ„Ç∑„É•„Åã„ÇâÂæ©ÂÖÉ„Åï„Çå„ÅüTimestamp„ÇíÂÆâÂÖ®„Å´Date„Å´Â§âÊèõ\nfunction toDate(ts: Timestamp | { seconds: number; nanoseconds: number } | undefined): Date | null {\n    if (!ts) return null;\n    if (ts instanceof Timestamp) return ts.toDate();\n    if (typeof ts === 'object' && 'seconds' in ts) {\n        return new Date(ts.seconds * 1000);\n    }\n    return null;\n}\n\nexport default function FriendsPage() {\n    const { selectedPet } = usePetContext();\n    const { canEdit } = useMembers(selectedPet?.id || null);\n    const { friends, loading, addFriend, updateFriend, deleteFriend } = useFriends(selectedPet?.id || null);\n    const [searchTerm, setSearchTerm] = useState('');\n\n    // Sheet States\n    const [selectedFriend, setSelectedFriend] = useState<Friend | null>(null);\n    const [isDetailOpen, setIsDetailOpen] = useState(false);\n    const [isFormOpen, setIsFormOpen] = useState(false);\n    const [isSubmitting, setIsSubmitting] = useState(false);\n\n    const filteredFriends = friends.filter((friend: Friend) =>\n        friend.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        friend.breed?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        friend.ownerName?.toLowerCase().includes(searchTerm.toLowerCase())\n    );\n\n    const handleSaveFriend = async (data: any) => {\n        setIsSubmitting(true);\n        try {\n            if (selectedFriend) {\n                await updateFriend(selectedFriend.id, data);\n                toast.success('Êõ¥Êñ∞„Åó„Åæ„Åó„Åü');\n            } else {\n                await addFriend(data);\n                toast.success('ÁôªÈå≤„Åó„Åæ„Åó„Åü');\n            }\n            setIsFormOpen(false);\n            setSelectedFriend(null);\n        } catch {\n            toast.error('„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü');\n        } finally {\n            setIsSubmitting(false);\n        }\n    };\n\n    return (\n        <AppLayout>\n            <div className=\"relative min-h-screen pb-32\">\n                {/* Global Header Gradient */}\n                <div className=\"absolute inset-0 h-[30vh] bg-gradient-to-b from-primary/20 via-primary/5 to-transparent -z-10 rounded-b-[3rem]\" />\n\n                <div className=\"px-4 pt-6 space-y-6\">\n                    {/* Header */}\n                    <div className=\"flex items-center justify-between\">\n                        <div>\n                            <h1 className=\"text-2xl font-black tracking-tight flex items-center gap-2\">\n                                <span className=\"text-3xl\">üêæ</span>\n                                „ÅäÊï£Ê≠©ÂèãÈÅî\n                            </h1>\n                            <p className=\"text-xs font-bold text-muted-foreground ml-1\">\n                                {selectedPet?.name}„ÅÆÂèãÈÅî„É™„Çπ„Éà\n                            </p>\n                        </div>\n                    </div>\n\n                    {/* Search - ÂèãÈÅî„Åå5‰∫∫‰ª•‰∏ä„ÅÆÂ†¥Âêà„ÅÆ„ÅøË°®Á§∫ */}\n                    {friends.length >= 5 && (\n                        <div className=\"relative\">\n                            <Search className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n                            <Input\n                                placeholder=\"ÂêçÂâç„ÄÅÁä¨Á®Æ„ÄÅÈ£º„ÅÑ‰∏ªÂêç„ÅßÊ§úÁ¥¢...\"\n                                value={searchTerm}\n                                onChange={(e) => setSearchTerm(e.target.value)}\n                                className=\"pl-9 h-10 bg-white/50 backdrop-blur-sm border-white/20 shadow-sm rounded-xl focus:bg-white transition-all\"\n                            />\n                        </div>\n                    )}\n\n                    {/* Friends Grid */}\n                    {loading ? (\n                        <div className=\"grid grid-cols-2 gap-3\">\n                            {[...Array(4)].map((_, i) => (\n                                <div key={i} className=\"aspect-[4/5] bg-muted/20 animate-pulse rounded-2xl\" />\n                            ))}\n                        </div>\n                    ) : (\n                        <div className=\"grid grid-cols-2 gap-3\">\n                            {filteredFriends.map((friend: Friend, index: number) => (\n                                <div key={friend.id} onClick={() => { setSelectedFriend(friend); setIsDetailOpen(true); }} className=\"cursor-pointer\">\n                                    <motion.div\n                                        initial={{ opacity: 0, y: 10 }}\n                                        animate={{ opacity: 1, y: 0 }}\n                                        transition={{ delay: index * 0.05 }}\n                                        className=\"group relative aspect-[4/5] rounded-2xl overflow-hidden glass border-white/20 shadow-sm hover:shadow-xl transition-all duration-300\"\n                                    >\n                                        {/* Image */}\n                                        <div className=\"absolute inset-0 bg-muted\">\n                                            {friend.images?.[0] ? (\n                                                <Image\n                                                    src={friend.images[0]}\n                                                    alt={friend.name}\n                                                    fill\n                                                    className=\"object-cover transition-transform duration-500 group-hover:scale-110\"\n                                                />\n                                            ) : (\n                                                <div className=\"w-full h-full flex items-center justify-center bg-primary/5\">\n                                                    <Image src=\"/ogp.webp\" alt=\"No image\" width={64} height={64} className=\"opacity-20 grayscale\" />\n                                                </div>\n                                            )}\n                                        </div>\n\n                                        {/* Overlay Gradient */}\n                                        <div className=\"absolute inset-x-0 bottom-0 h-2/3 bg-gradient-to-t from-black/80 via-black/40 to-transparent\" />\n\n                                        {/* Content */}\n                                        <div className=\"absolute inset-x-0 bottom-0 p-3 text-white\">\n                                            <p className=\"text-[10px] font-medium text-white/70 mb-0.5 flex items-center gap-1\">\n                                                {friend.breed || 'Áä¨Á®Æ‰∏çÊòé'}\n                                                {friend.gender === 'male' && <span className=\"text-blue-300\">‚ôÇ</span>}\n                                                {friend.gender === 'female' && <span className=\"text-red-300\">‚ôÄ</span>}\n                                            </p>\n                                            <h3 className=\"font-bold text-lg leading-tight mb-1 truncate\">\n                                                {friend.name}\n                                            </h3>\n\n                                            <div className=\"flex items-center gap-2 mt-2 text-[10px] font-medium text-white/60\">\n                                                {toDate(friend.metAt) && (\n                                                    <span className=\"flex items-center gap-0.5 bg-black/20 px-1.5 py-0.5 rounded-full backdrop-blur-sm\">\n                                                        <Calendar className=\"w-3 h-3\" />\n                                                        {format(toDate(friend.metAt)!, 'M/d')}\n                                                    </span>\n                                                )}\n                                                {friend.location && (\n                                                    <span className=\"flex items-center gap-0.5 bg-black/20 px-1.5 py-0.5 rounded-full backdrop-blur-sm truncate max-w-[80px]\">\n                                                        <MapPin className=\"w-3 h-3 flex-shrink-0\" />\n                                                        <span className=\"truncate\">{friend.location}</span>\n                                                    </span>\n                                                )}\n                                            </div>\n                                        </div>\n                                    </motion.div>\n                                </div>\n                            ))}\n                        </div>\n                    )}\n                </div>\n\n                {/* FAB - sticky above footer */}\n                {canEdit && (\n                    <div className=\"sticky bottom-24 z-20 flex justify-center px-4 pt-6\">\n                        <motion.button\n                            onClick={() => { setSelectedFriend(null); setIsFormOpen(true); }}\n                            whileHover={{ scale: 1.05 }}\n                            whileTap={{ scale: 0.95 }}\n                            className=\"flex items-center gap-2 px-8 h-14 rounded-full bg-gradient-to-r from-primary to-orange-500 shadow-xl shadow-primary/30 text-white font-bold transition-all duration-300 hover:shadow-2xl hover:shadow-orange-500/50 hover:brightness-110\"\n                        >\n                            <Plus className=\"w-5 h-5\" />\n                            <span>ÂèãÈÅî„ÇíËøΩÂä†</span>\n                        </motion.button>\n                    </div>\n                )}\n\n                {/* Friend Summary Sheets */}\n                <FriendDetailSheet\n                    friend={selectedFriend}\n                    open={isDetailOpen}\n                    onClose={() => { setIsDetailOpen(false); setSelectedFriend(null); }}\n                    onEdit={() => { setIsDetailOpen(false); setIsFormOpen(true); }}\n                    onDelete={async (id) => { await deleteFriend(id); }}\n                    canEdit={canEdit}\n                />\n\n                <FriendFormSheet\n                    open={isFormOpen}\n                    friend={selectedFriend}\n                    onClose={() => { setIsFormOpen(false); setSelectedFriend(null); }}\n                    onSave={handleSaveFriend}\n                    isSubmitting={isSubmitting}\n                    petId={selectedPet?.id || ''}\n                />\n            </div>\n        </AppLayout>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/app/layout.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/app/not-found.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/app/page.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/app/pets/new/page.tsx",
    "messages": [],
    "suppressedMessages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 92,
        "column": 66,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 92,
        "endColumn": 69,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [3572, 3575], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [3572, 3575], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ],
        "suppressions": [{ "kind": "directive", "justification": "" }]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 92,
        "column": 90,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 92,
        "endColumn": 93,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [3596, 3599], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [3596, 3599], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ],
        "suppressions": [{ "kind": "directive", "justification": "" }]
      }
    ],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/app/pets/settings/page.tsx",
    "messages": [
      {
        "ruleId": "@next/next/no-img-element",
        "severity": 1,
        "message": "Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element",
        "line": 446,
        "column": 65,
        "nodeType": "JSXOpeningElement",
        "endLine": 446,
        "endColumn": 159
      }
    ],
    "suppressedMessages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 111,
        "column": 28,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 111,
        "endColumn": 31,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [4784, 4787], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [4784, 4787], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ],
        "suppressions": [{ "kind": "directive", "justification": "" }]
      }
    ],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 1,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useState, useEffect, Suspense } from 'react';\nimport { useRouter, useSearchParams } from 'next/navigation';\nimport { AppLayout } from '@/components/features/AppLayout';\nimport { useMembers } from '@/hooks/useMembers';\nimport { usePets } from '@/hooks/usePets';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { useImageUpload } from '@/hooks/useImageUpload';\nimport { CustomTaskEditor } from '@/components/features/CustomTaskEditor';\nimport { PetBasicInfoForm, type PetBasicInfoData } from '@/components/features/pet-basic-info-form';\nimport { PetAvatarEditor } from '@/components/features/pet-avatar-editor';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger, DialogDescription, DialogFooter } from '@/components/ui/dialog';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger } from '@/components/ui/alert-dialog';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { ArrowLeft, UserPlus, Crown, Trash2, Mail, Clock, Eye, Edit, Plus, X, PawPrint, Settings, Users, AlertTriangle, ListTodo, Shield } from 'lucide-react';\n\nimport { toast } from 'sonner';\nimport { handleError } from '@/lib/errorHandler';\nimport { MEMBER_ROLES, type MemberRole, type VetInfo } from '@/lib/types';\nimport { format, parse } from 'date-fns';\nimport { cn } from '@/lib/utils';\nimport { deleteField } from 'firebase/firestore';\n\nfunction PetSettingsContent() {\n    const router = useRouter();\n    const searchParams = useSearchParams();\n    const petId = searchParams.get('id');\n\n    const { user } = useAuth();\n    const { pets, updatePet, deletePet } = usePets();\n    const { members, loading, isOwner, canEdit, canManageMembers, inviteMember, updateMemberRole, removeMember, leaveTeam } = useMembers(petId);\n    const { uploadPetAvatar, uploading } = useImageUpload();\n\n    const pet = pets.find((p) => p.id === petId);\n\n    // Âü∫Êú¨ÊÉÖÂ†± (FormData)\n    const [formData, setFormData] = useState<PetBasicInfoData>({\n        name: '',\n        species: '',\n        breed: '',\n        color: '',\n        gender: '',\n        birthday: undefined,\n        adoptionDate: undefined,\n        microchipId: '',\n    });\n\n    // Ë©≥Á¥∞ÊÉÖÂ†± (Âà•ÈÄîÁÆ°ÁêÜ)\n    const [petMedicalNotes, setPetMedicalNotes] = useState('');\n    const [petVetInfo, setPetVetInfo] = useState<VetInfo[]>([]);\n\n    // ÁîªÂÉèÈñ¢ÈÄ£\n    const [pendingAvatarFile, setPendingAvatarFile] = useState<File | null>(null);\n    const [avatarPreview, setAvatarPreview] = useState<string | null>(null);\n    const [removeAvatar, setRemoveAvatar] = useState(false);\n    const [confirmDeleteAvatarOpen, setConfirmDeleteAvatarOpen] = useState(false);\n\n    // ÊãõÂæÖ\n    const [inviteEmail, setInviteEmail] = useState('');\n    const [inviteRole, setInviteRole] = useState<MemberRole>('editor');\n    const [isInviteDialogOpen, setIsInviteDialogOpen] = useState(false);\n    const [isSubmitting, setIsSubmitting] = useState(false);\n\n    useEffect(() => {\n        if (pet) {\n            setFormData({\n                name: pet.name,\n                species: pet.species || '',\n                breed: pet.breed || '',\n                color: pet.color || '',\n                gender: pet.gender || '',\n                birthday: pet.birthday ? parse(pet.birthday, 'yyyy-MM-dd', new Date()) : undefined,\n                adoptionDate: pet.adoptionDate ? parse(pet.adoptionDate, 'yyyy-MM-dd', new Date()) : undefined,\n                microchipId: pet.microchipId || '',\n            });\n            setPetMedicalNotes(pet.medicalNotes || '');\n            setPetVetInfo(pet.vetInfo || []);\n        }\n    }, [pet]);\n\n    const handleImageChange = (file: File) => {\n        setPendingAvatarFile(file);\n        setAvatarPreview(URL.createObjectURL(file));\n        setRemoveAvatar(false);\n    };\n\n    const handleImageRemoveRequest = () => {\n        setConfirmDeleteAvatarOpen(true);\n    };\n\n    const handleRemoveAvatarConfirmed = () => {\n        setPendingAvatarFile(null);\n        setAvatarPreview(null);\n        setRemoveAvatar(true);\n        setConfirmDeleteAvatarOpen(false);\n    };\n\n    const handleUpdatePet = async () => {\n        if (!petId || !formData.name.trim()) {\n            toast.error('ÂêçÂâç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');\n            return;\n        }\n        try {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            let avatarUrl: any = pet?.avatarUrl;\n\n            if (removeAvatar) {\n                avatarUrl = deleteField();\n            } else if (pendingAvatarFile) {\n                avatarUrl = await uploadPetAvatar(pendingAvatarFile, petId);\n            }\n\n            await updatePet(petId, {\n                name: formData.name.trim(),\n                species: formData.species || undefined,\n                breed: formData.breed.trim() || undefined,\n                color: formData.color || undefined,\n                birthday: formData.birthday ? format(formData.birthday, 'yyyy-MM-dd') : undefined,\n                gender: formData.gender || undefined,\n                adoptionDate: formData.adoptionDate ? format(formData.adoptionDate, 'yyyy-MM-dd') : undefined,\n                microchipId: formData.microchipId.trim() || undefined,\n                medicalNotes: petMedicalNotes.trim() || undefined,\n                vetInfo: petVetInfo.length > 0 ? petVetInfo : undefined,\n                avatarUrl,\n            });\n\n            setPendingAvatarFile(null);\n            setAvatarPreview(null);\n            setRemoveAvatar(false);\n\n            toast.success('Êõ¥Êñ∞„Åó„Åæ„Åó„Åü');\n        } catch (error) {\n            handleError(error, { context: 'PetSettings.update', fallbackMessage: '„Éö„ÉÉ„ÉàÊÉÖÂ†±„ÅÆÊõ¥Êñ∞„Å´Â§±Êïó„Åó„Åæ„Åó„Åü' });\n        }\n    };\n\n    const handleInvite = async (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!inviteEmail.trim()) return;\n        setIsSubmitting(true);\n        try {\n            await inviteMember(inviteEmail.trim(), inviteRole, {\n                name: formData.name.trim(),\n                avatarUrl: pet?.avatarUrl,\n            });\n            toast.success('ÊãõÂæÖ„ÇíÈÄÅ‰ø°„Åó„Åæ„Åó„Åü');\n            setInviteEmail('');\n            setInviteRole('editor');\n            setIsInviteDialogOpen(false);\n        } catch (error) {\n            handleError(error, { context: 'PetSettings.invite', fallbackMessage: 'ÊãõÂæÖ„ÅÆÈÄÅ‰ø°„Å´Â§±Êïó„Åó„Åæ„Åó„Åü' });\n        } finally {\n            setIsSubmitting(false);\n        }\n    };\n\n    const handleRoleChange = async (memberId: string, newRole: MemberRole) => {\n        try {\n            await updateMemberRole(memberId, newRole);\n            toast.success('Ê®©Èôê„ÇíÂ§âÊõ¥„Åó„Åæ„Åó„Åü');\n        } catch (error) {\n            handleError(error, { context: 'PetSettings.roleChange', fallbackMessage: 'Ê®©Èôê„ÅÆÂ§âÊõ¥„Å´Â§±Êïó„Åó„Åæ„Åó„Åü' });\n        }\n    };\n\n    const handleRemoveMember = async (memberId: string, memberName: string) => {\n        try {\n            await removeMember(memberId);\n            toast.success(`${memberName}„Åï„Çì„ÇíÂâäÈô§„Åó„Åæ„Åó„Åü`);\n        } catch (error) {\n            handleError(error, { context: 'PetSettings.removeMember', fallbackMessage: '„É°„É≥„Éê„Éº„ÅÆÂâäÈô§„Å´Â§±Êïó„Åó„Åæ„Åó„Åü' });\n        }\n    };\n\n    const handleLeaveTeam = async () => {\n        try {\n            await leaveTeam();\n            toast.success('„ÉÅ„Éº„É†„Åã„ÇâËÑ±ÈÄÄ„Åó„Åæ„Åó„Åü');\n            router.push('/dashboard');\n        } catch (error) {\n            handleError(error, { context: 'PetSettings.leaveTeam', fallbackMessage: '„ÉÅ„Éº„É†„Åã„Çâ„ÅÆËÑ±ÈÄÄ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü' });\n        }\n    };\n\n    const handleDeletePet = async () => {\n        if (!petId) return;\n        try {\n            await deletePet(petId);\n            toast.success('„Éö„ÉÉ„Éà„ÇíÂâäÈô§„Åó„Åæ„Åó„Åü');\n            router.push('/dashboard');\n        } catch (error) {\n            handleError(error, { context: 'PetSettings.deletePet', fallbackMessage: '„Éö„ÉÉ„Éà„ÅÆÂâäÈô§„Å´Â§±Êïó„Åó„Åæ„Åó„Åü' });\n        }\n    };\n\n    const addVetInfo = () => {\n        setPetVetInfo([...petVetInfo, { name: '', phone: '' }]);\n    };\n\n    const updateVetInfo = (index: number, field: 'name' | 'phone', value: string) => {\n        const updated = [...petVetInfo];\n        updated[index] = { ...updated[index], [field]: value };\n        setPetVetInfo(updated);\n    };\n\n    const removeVetInfo = (index: number) => {\n        setPetVetInfo(petVetInfo.filter((_, i) => i !== index));\n    };\n\n    const getRoleIcon = (role: string) => {\n        switch (role) {\n            case 'owner': return <Crown className=\"w-4 h-4 text-amber-500\" />;\n            case 'editor': return <Edit className=\"w-4 h-4 text-blue-500\" />;\n            case 'viewer': return <Eye className=\"w-4 h-4 text-gray-500\" />;\n            default: return null;\n        }\n    };\n\n    const getRoleLabel = (role: string) => {\n        return MEMBER_ROLES.find((r) => r.value === role)?.label || role;\n    };\n\n    if (!petId || !pet) {\n        return (\n            <AppLayout>\n                <div className=\"p-4 text-center py-24 flex flex-col items-center justify-center\">\n                    <PawPrint className=\"w-16 h-16 text-muted-foreground/20 mb-4\" />\n                    <p className=\"text-muted-foreground mb-4\">„Éö„ÉÉ„ÉàÊÉÖÂ†±„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì</p>\n                    <Button onClick={() => router.push('/dashboard')} variant=\"outline\">„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„Å´Êàª„Çã</Button>\n                </div>\n            </AppLayout>\n        );\n    }\n\n    const calculateAge = (birthday: string) => {\n        const birthDate = new Date(birthday);\n        const today = new Date();\n        let years = today.getFullYear() - birthDate.getFullYear();\n        let months = today.getMonth() - birthDate.getMonth();\n        if (months < 0) {\n            years--;\n            months += 12;\n        }\n        return `${years}Ê≠≥${months}„É∂Êúà`;\n    };\n\n    const activeMembers = members.filter((m) => m.status === 'active');\n    const pendingMembers = members.filter((m) => m.status === 'pending');\n\n    // Determine display avatar: if removeAvatar is true, null. Else preview or pet.avatarUrl.\n    const displayAvatar = removeAvatar ? null : (avatarPreview || pet.avatarUrl);\n\n    return (\n        <AppLayout>\n            <div className=\"pb-32 min-h-screen\">\n                {/* Modern Header Section */}\n                <div className=\"relative\">\n                    <div className=\"absolute inset-0 h-[40vh] bg-gradient-to-b from-primary/10 via-orange-400/5 to-transparent -z-10 rounded-b-[4rem]\" />\n\n                    <div className=\"md:container max-w-2xl mx-auto px-4 pt-6\">\n                        {/* Navigation */}\n                        <div className=\"flex items-center gap-3 mb-6\">\n                            <Button variant=\"ghost\" size=\"icon\" className=\"rounded-full hover:bg-white/20 text-muted-foreground hover:text-foreground transition-colors\" onClick={() => router.back()}>\n                                <ArrowLeft className=\"w-5 h-5\" />\n                            </Button>\n                        </div>\n\n                        {/* Pet Identity */}\n                        <div className=\"flex flex-col items-center mb-10\">\n                            <div className=\"relative mb-6\">\n                                <PetAvatarEditor\n                                    imageUrl={displayAvatar}\n                                    onImageChange={handleImageChange}\n                                    onImageRemove={handleImageRemoveRequest}\n                                    disabled={!canEdit || uploading}\n                                />\n                            </div>\n\n                            <div className=\"text-center space-y-4\">\n                                <h1 className=\"text-4xl font-black tracking-tight text-foreground/90 flex items-center justify-center gap-3\">\n                                    {pet.name}\n                                    {pet.gender && (\n                                        <span className={cn(\n                                            \"inline-flex items-center justify-center w-8 h-8 rounded-full text-base shadow-inner\",\n                                            pet.gender === 'male' ? \"bg-blue-100/50 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400\" :\n                                                pet.gender === 'female' ? \"bg-pink-100/50 text-pink-600 dark:bg-pink-900/30 dark:text-pink-400\" :\n                                                    \"bg-gray-100/50 text-gray-600\"\n                                        )}>\n                                            {pet.gender === 'male' ? '‚ôÇ' : pet.gender === 'female' ? '‚ôÄ' : '?'}\n                                        </span>\n                                    )}\n                                </h1>\n                                <div className=\"glass-capsule inline-flex items-center gap-3 px-6 py-2 shadow-sm\">\n                                    <span className=\"font-bold text-sm text-foreground/80\">{pet.breed || 'Áä¨Á®ÆÊú™Ë®≠ÂÆö'}</span>\n                                    {pet.birthday && (\n                                        <>\n                                            <span className=\"w-1 h-1 bg-foreground/20 rounded-full\" />\n                                            <span className=\"text-sm font-medium text-muted-foreground\">{calculateAge(pet.birthday)}</span>\n                                        </>\n                                    )}\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Main Content Tabs */}\n                        <Tabs defaultValue=\"general\" className=\"w-full\">\n                            <TabsList className=\"glass-capsule w-full p-1.5 rounded-full mb-8 shadow-lg flex bg-muted/20 dark:bg-black/40\">\n                                <TabsTrigger value=\"general\" className=\"flex-1 rounded-full text-xs md:text-sm font-bold data-[state=active]:bg-white data-[state=active]:text-primary data-[state=active]:shadow-lg dark:data-[state=active]:bg-white/10 dark:data-[state=active]:text-white dark:data-[state=active]:border-white/10 dark:data-[state=active]:border h-10 md:h-12 transition-all\"><Settings className=\"w-4 h-4 md:mr-2\" /><span className=\"hidden md:inline\">Âü∫Êú¨</span></TabsTrigger>\n                                <TabsTrigger value=\"custom\" className=\"flex-1 rounded-full text-xs md:text-sm font-bold data-[state=active]:bg-white data-[state=active]:text-primary data-[state=active]:shadow-lg dark:data-[state=active]:bg-white/10 dark:data-[state=active]:text-white dark:data-[state=active]:border-white/10 dark:data-[state=active]:border h-10 md:h-12 transition-all\"><ListTodo className=\"w-4 h-4 md:mr-2\" /><span className=\"hidden md:inline\">„Çø„Çπ„ÇØ</span></TabsTrigger>\n                                <TabsTrigger value=\"members\" className=\"flex-1 rounded-full text-xs md:text-sm font-bold data-[state=active]:bg-white data-[state=active]:text-primary data-[state=active]:shadow-lg dark:data-[state=active]:bg-white/10 dark:data-[state=active]:text-white dark:data-[state=active]:border-white/10 dark:data-[state=active]:border h-10 md:h-12 transition-all\"><Users className=\"w-4 h-4 md:mr-2\" /><span className=\"hidden md:inline\">ÂÖ±Êúâ</span></TabsTrigger>\n                                <TabsTrigger value=\"danger\" className=\"flex-1 rounded-full text-xs md:text-sm font-bold data-[state=active]:bg-rose-500 data-[state=active]:text-white data-[state=active]:shadow-lg dark:data-[state=active]:bg-rose-500/20 dark:data-[state=active]:text-rose-200 dark:data-[state=active]:border-rose-500/30 dark:data-[state=active]:border h-10 md:h-12 transition-all\"><Shield className=\"w-4 h-4 md:mr-2\" /><span className=\"hidden md:inline\">È´òÂ∫¶</span></TabsTrigger>\n                            </TabsList>\n\n                            <TabsContent value=\"general\" className=\"space-y-6 animate-in fade-in-50 slide-in-from-bottom-2 duration-300\">\n                                <PetBasicInfoForm\n                                    data={formData}\n                                    onChange={setFormData}\n                                    disabled={!canEdit}\n                                />\n\n                                <div className=\"glass rounded-[2.5rem] p-8 shadow-xl space-y-8\">\n                                    <div className=\"flex items-center gap-2 mb-4\">\n                                        <div className=\"w-1 h-4 bg-primary rounded-full\" />\n                                        <h3 className=\"font-bold text-lg text-foreground/80\">ÂåªÁôÇ„Éª„Åù„ÅÆ‰ªñ</h3>\n                                    </div>\n\n                                    {/* Microchip moved to BasicInfoForm, so removed here */}\n\n                                    <div className=\"space-y-2\">\n                                        <Label htmlFor=\"medicalNotes\" className=\"text-xs font-bold text-muted-foreground ml-1\">ÂåªÁôÇ„É°„É¢</Label>\n                                        <textarea\n                                            id=\"medicalNotes\"\n                                            value={petMedicalNotes}\n                                            onChange={(e) => setPetMedicalNotes(e.target.value)}\n                                            placeholder=\"„Ç¢„É¨„É´„ÇÆ„Éº„ÄÅÊåÅÁóÖ„ÄÅÊúçËñ¨ÊÉÖÂ†±„Å™„Å©...\"\n                                            rows={3}\n                                            disabled={!canEdit}\n                                            className=\"w-full rounded-xl border border-white/20 bg-white/50 dark:bg-black/20 px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-primary/50 resize-none transition-colors\"\n                                        />\n                                    </div>\n\n                                    <div className=\"space-y-4\">\n                                        <div className=\"flex items-center justify-between\">\n                                            <Label className=\"text-xs font-bold text-muted-foreground ml-1\">„Åã„Åã„Çä„Å§„ÅëÂãïÁâ©ÁóÖÈô¢</Label>\n                                            {canEdit && <Button type=\"button\" variant=\"ghost\" size=\"sm\" onClick={addVetInfo} className=\"h-8 text-xs text-primary rounded-full hover:bg-primary/10\"><Plus className=\"w-3 h-3 mr-1\" />ËøΩÂä†</Button>}\n                                        </div>\n\n                                        {petVetInfo.length === 0 ? (\n                                            <div className=\"text-xs text-muted-foreground text-center py-6 border-2 border-dashed border-white/20 rounded-xl bg-muted/10\">\n                                                ÁôªÈå≤„Åï„Çå„ÅüÁóÖÈô¢„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì\n                                            </div>\n                                        ) : (\n                                            <div className=\"space-y-3\">\n                                                {petVetInfo.map((vet, index) => (\n                                                    <div key={index} className=\"flex gap-3 items-start p-3 rounded-2xl bg-white/40 dark:bg-black/20 border border-white/10\">\n                                                        <div className=\"grid gap-2 flex-1\">\n                                                            <Input value={vet.name} onChange={(e) => updateVetInfo(index, 'name', e.target.value)} placeholder=\"ÁóÖÈô¢Âêç\" className=\"h-10 rounded-lg bg-transparent border-white/20\" disabled={!canEdit} />\n                                                            <Input value={vet.phone || ''} onChange={(e) => updateVetInfo(index, 'phone', e.target.value)} placeholder=\"ÈõªË©±Áï™Âè∑\" className=\"h-10 rounded-lg bg-transparent border-white/20\" disabled={!canEdit} />\n                                                        </div>\n                                                        {canEdit && (\n                                                            <Button type=\"button\" variant=\"ghost\" size=\"icon\" onClick={() => removeVetInfo(index)} className=\"h-10 w-10 text-muted-foreground hover:text-destructive rounded-full shrink-0\">\n                                                                <X className=\"w-4 h-4\" />\n                                                            </Button>\n                                                        )}\n                                                    </div>\n                                                ))}\n                                            </div>\n                                        )}\n                                    </div>\n                                </div>\n\n                                {canEdit && (\n                                    <div className=\"sticky bottom-24 z-20 mx-auto max-w-sm px-4 pt-6\">\n                                        <Button onClick={handleUpdatePet} className=\"w-full shadow-2xl gradient-primary h-14 text-base font-bold rounded-full hover:scale-105 transition-transform\">\n                                            Â§âÊõ¥„Çí‰øùÂ≠ò\n                                        </Button>\n                                    </div>\n                                )}\n                            </TabsContent>\n\n                            <TabsContent value=\"custom\" className=\"animate-in fade-in-50 slide-in-from-bottom-2 duration-300\">\n                                <CustomTaskEditor petId={petId} canEdit={canEdit} />\n                            </TabsContent>\n\n                            <TabsContent value=\"members\" className=\"space-y-6 animate-in fade-in-50 slide-in-from-bottom-2 duration-300\">\n                                <div className=\"glass rounded-[2.5rem] p-8 shadow-xl\">\n                                    <div className=\"flex items-center justify-between mb-6\">\n                                        <div>\n                                            <div className=\"flex items-center gap-2 mb-1\">\n                                                <div className=\"w-1 h-4 bg-primary rounded-full\" />\n                                                <h3 className=\"font-bold text-lg text-foreground/80\">ÂÖ±Êúâ„É°„É≥„Éê„Éº</h3>\n                                            </div>\n                                            <p className=\"text-xs text-muted-foreground ml-3\">ÂÆ∂Êóè„ÇÑ„Éë„Éº„Éà„Éä„Éº„Å®ÊÉÖÂ†±„ÇíÂÖ±Êúâ</p>\n                                        </div>\n                                        {canManageMembers && (\n                                            <Dialog open={isInviteDialogOpen} onOpenChange={setIsInviteDialogOpen}>\n                                                <DialogTrigger asChild>\n                                                    <Button size=\"sm\" className=\"gap-1 gradient-primary shadow-lg rounded-full px-4\"><UserPlus className=\"w-4 h-4\" /> ÊãõÂæÖ</Button>\n                                                </DialogTrigger>\n                                                <DialogContent className=\"glass border-white/20 rounded-[2rem]\">\n                                                    <DialogHeader>\n                                                        <DialogTitle>„É°„É≥„Éê„Éº„ÇíÊãõÂæÖ</DialogTitle>\n                                                        <DialogDescription>ÊãõÂæÖ„Åó„Åü„ÅÑ‰∫∫„ÅÆ„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</DialogDescription>\n                                                    </DialogHeader>\n                                                    <form onSubmit={handleInvite} className=\"space-y-4 pt-4\">\n                                                        <div>\n                                                            <Label htmlFor=\"invite-email\" className=\"ml-1 text-xs\">„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ</Label>\n                                                            <Input id=\"invite-email\" type=\"email\" value={inviteEmail} onChange={(e) => setInviteEmail(e.target.value)} placeholder=\"example@gmail.com\" className=\"mt-1 h-12 rounded-xl bg-white/50 border-white/20\" autoComplete=\"email\" />\n                                                        </div>\n                                                        <div>\n                                                            <Label className=\"ml-1 text-xs\">Ê®©ÈôêË®≠ÂÆö</Label>\n                                                            <Select value={inviteRole} onValueChange={(v) => setInviteRole(v as MemberRole)}>\n                                                                <SelectTrigger className=\"mt-1 h-12 rounded-xl bg-white/50 border-white/20\"><SelectValue /></SelectTrigger>\n                                                                <SelectContent>\n                                                                    {MEMBER_ROLES.filter((r) => r.value !== 'owner').map((role) => (\n                                                                        <SelectItem key={role.value} value={role.value}>\n                                                                            <div className=\"flex items-center gap-2\">{getRoleIcon(role.value)}<span>{role.label}</span></div>\n                                                                        </SelectItem>\n                                                                    ))}\n                                                                </SelectContent>\n                                                            </Select>\n                                                        </div>\n                                                        <Button type=\"submit\" disabled={isSubmitting || !inviteEmail.trim()} className=\"w-full gradient-primary h-12 rounded-xl font-bold\">{isSubmitting ? 'ÈÄÅ‰ø°‰∏≠...' : 'ÊãõÂæÖÁä∂„ÇíÈÄÅ„Çã'}</Button>\n                                                    </form>\n                                                </DialogContent>\n                                            </Dialog>\n                                        )}\n                                    </div>\n\n                                    <div className=\"space-y-4\">\n                                        {loading ? (\n                                            <div className=\"space-y-3\">{[...Array(2)].map((_, i) => <div key={i} className=\"h-20 bg-muted/20 animate-pulse rounded-2xl\" />)}</div>\n                                        ) : (\n                                            <>\n                                                {activeMembers.map((member) => (\n                                                    <div key={member.id} className=\"flex items-center p-4 rounded-2xl glass hover:bg-white/40 border-white/10 transition-colors gap-4\">\n                                                        <Avatar className=\"w-12 h-12 flex-shrink-0 border-2 border-white/20 shadow-sm\">\n                                                            <AvatarImage src={member.userProfile?.avatarUrl} alt={member.userProfile?.displayName} />\n                                                            <AvatarFallback className=\"bg-primary/10 flex items-center justify-center overflow-hidden\">\n                                                                <img src=\"/ogp.webp\" alt=\"Role\" className=\"w-full h-full object-cover opacity-50 grayscale\" />\n                                                            </AvatarFallback>\n                                                        </Avatar>\n                                                        <div className=\"flex-1 min-w-0 flex flex-col gap-1\">\n                                                            <div className=\"flex flex-wrap items-center gap-2\">\n                                                                <span className=\"font-bold text-sm truncate max-w-[120px]\">\n                                                                    {\n                                                                        member.userId === user?.uid\n                                                                            ? `„ÅÇ„Å™„Åü`\n                                                                            : (member.userProfile?.nickname || member.userProfile?.displayName || 'Êú™ÁôªÈå≤„É¶„Éº„Ç∂„Éº')\n                                                                    }\n                                                                </span>\n                                                                <span className={cn('text-[10px] px-2 py-0.5 rounded-full font-bold border',\n                                                                    member.role === 'owner' ? 'bg-amber-500/10 text-amber-600 border-amber-500/20' :\n                                                                        member.role === 'editor' ? 'bg-blue-500/10 text-blue-600 border-blue-500/20' :\n                                                                            'bg-gray-500/10 text-gray-600 border-gray-500/20')}>\n                                                                    {getRoleLabel(member.role)}\n                                                                </span>\n                                                            </div>\n                                                            <p className=\"text-xs text-muted-foreground truncate opacity-70\">{member.inviteEmail}</p>\n\n                                                            {canManageMembers && member.userId !== user?.uid && (\n                                                                <div className=\"flex items-center gap-2 mt-2\">\n                                                                    <Select value={member.role} onValueChange={(v) => handleRoleChange(member.id, v as MemberRole)}>\n                                                                        <SelectTrigger className=\"h-8 text-xs bg-white/20 border-white/20 rounded-lg w-auto min-w-[100px]\"><SelectValue /></SelectTrigger>\n                                                                        <SelectContent>\n                                                                            {MEMBER_ROLES.map((role) => (\n                                                                                <SelectItem key={role.value} value={role.value}>\n                                                                                    <div className=\"flex items-center gap-2\">{getRoleIcon(role.value)}<span className=\"text-xs\">{role.label}</span></div>\n                                                                                </SelectItem>\n                                                                            ))}\n                                                                        </SelectContent>\n                                                                    </Select>\n                                                                    {member.role !== 'owner' && (\n                                                                        <AlertDialog>\n                                                                            <AlertDialogTrigger asChild><Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8 text-muted-foreground hover:text-destructive hover:bg-destructive/10 rounded-full\"><Trash2 className=\"w-4 h-4\" /></Button></AlertDialogTrigger>\n                                                                            <AlertDialogContent className=\"glass border-white/20 rounded-[2rem]\">\n                                                                                <AlertDialogHeader><AlertDialogTitle>„É°„É≥„Éê„Éº„ÇíÂâäÈô§</AlertDialogTitle><AlertDialogDescription>„Åì„ÅÆÊìç‰Ωú„ÇíË°å„ÅÜ„Å®„ÄÅ„Åì„ÅÆ„É°„É≥„Éê„Éº„ÅØÊÉÖÂ†±„Å´„Ç¢„ÇØ„Çª„Çπ„Åß„Åç„Å™„Åè„Å™„Çä„Åæ„Åô„ÄÇ</AlertDialogDescription></AlertDialogHeader>\n                                                                                <AlertDialogFooter><AlertDialogCancel className=\"rounded-full\">„Ç≠„É£„É≥„Çª„É´</AlertDialogCancel><AlertDialogAction onClick={() => handleRemoveMember(member.id, member.inviteEmail || '„É°„É≥„Éê„Éº')} className=\"bg-destructive text-destructive-foreground rounded-full\">ÂâäÈô§„Åô„Çã</AlertDialogAction></AlertDialogFooter>\n                                                                            </AlertDialogContent>\n                                                                        </AlertDialog>\n                                                                    )}\n                                                                </div>\n                                                            )}\n                                                        </div>\n                                                    </div>\n                                                ))}\n\n                                                {pendingMembers.length > 0 && (\n                                                    <div className=\"mt-8\">\n                                                        <p className=\"text-xs font-bold text-muted-foreground mb-4 flex items-center gap-2 opacity-70 ml-2\"><Clock className=\"w-3 h-3\" /> ÊãõÂæÖ‰∏≠</p>\n                                                        <div className=\"space-y-3\">\n                                                            {pendingMembers.map((member) => (\n                                                                <div key={member.id} className=\"flex items-center p-3 rounded-2xl bg-muted/10 border border-white/10 gap-4 opacity-70\">\n                                                                    <div className=\"w-10 h-10 rounded-full bg-white/20 flex items-center justify-center flex-shrink-0\"><Mail className=\"w-4 h-4 text-muted-foreground\" /></div>\n                                                                    <div className=\"flex-1 min-w-0 flex flex-col gap-1\">\n                                                                        <div className=\"flex items-center gap-2\">\n                                                                            <span className=\"font-medium text-sm truncate\">{member.inviteEmail}</span>\n                                                                            <span className=\"text-[10px] px-2 py-0.5 bg-white/20 rounded-full\">{getRoleLabel(member.role)}</span>\n                                                                        </div>\n                                                                        {canManageMembers && (\n                                                                            <Button variant=\"ghost\" size=\"sm\" onClick={() => handleRemoveMember(member.id, member.inviteEmail || '')} className=\"text-xs h-7 justify-start px-0 text-muted-foreground hover:text-destructive w-fit\"><Trash2 className=\"w-3 h-3 mr-1\" />ÊãõÂæÖ„ÇíÂèñ„ÇäÊ∂à„Åô</Button>\n                                                                        )}\n                                                                    </div>\n                                                                </div>\n                                                            ))}\n                                                        </div>\n                                                    </div>\n                                                )}\n                                            </>\n                                        )}\n                                    </div>\n                                </div>\n                            </TabsContent >\n\n                            <TabsContent value=\"danger\" className=\"space-y-4 animate-in fade-in-50 slide-in-from-bottom-2 duration-300\">\n                                <div className=\"glass rounded-[2.5rem] p-8 shadow-xl border-destructive/20 overflow-hidden\">\n                                    <div className=\"flex items-center gap-2 mb-6 text-destructive\">\n                                        <AlertTriangle className=\"w-5 h-5\" />\n                                        <h3 className=\"font-bold text-lg\">Âç±Èô∫„Å™Êìç‰Ωú</h3>\n                                    </div>\n                                    <p className=\"text-sm text-muted-foreground bg-destructive/5 p-4 rounded-xl border border-destructive/10 mb-6\">\n                                        „Åì„Çå„Çâ„ÅÆÊìç‰Ωú„ÅØÂèñ„ÇäÊ∂à„Åô„Åì„Å®„Åå„Åß„Åç„Åæ„Åõ„Çì„ÄÇÊÖéÈáç„Å´Êìç‰Ωú„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ\n                                    </p>\n\n                                    <div className=\"space-y-4\">\n                                        {/* Danger actions with consistent styling */}\n                                        {(!isOwner || activeMembers.some(m => m.userId !== user?.uid && m.role === 'owner')) && (\n                                            <div className=\"flex items-center justify-between p-4 rounded-2xl border border-dotted border-destructive/30 hover:bg-destructive/5 transition-colors\">\n                                                <div>\n                                                    <h4 className=\"font-bold text-sm text-destructive\">„ÉÅ„Éº„É†„Åã„ÇâËÑ±ÈÄÄ</h4>\n                                                    <p className=\"text-xs text-muted-foreground mt-1\">„Åì„ÅÆ„Éö„ÉÉ„Éà„ÅÆÂÖ±Êúâ„É°„É≥„Éê„Éº„Åã„ÇâÊäú„Åë„Åæ„Åô„ÄÇ</p>\n                                                </div>\n                                                <AlertDialog>\n                                                    <AlertDialogTrigger asChild><Button variant=\"destructive\" size=\"sm\" className=\"rounded-full\">ËÑ±ÈÄÄ„Åô„Çã</Button></AlertDialogTrigger>\n                                                    <AlertDialogContent className=\"glass border-white/20 rounded-[2rem]\">\n                                                        <AlertDialogHeader><AlertDialogTitle>„ÉÅ„Éº„É†„Åã„ÇâËÑ±ÈÄÄ</AlertDialogTitle><AlertDialogDescription>Êú¨ÂΩì„Å´„Åì„ÅÆ„Éö„ÉÉ„Éà„ÅÆ„ÉÅ„Éº„É†„Åã„ÇâËÑ±ÈÄÄ„Åó„Åæ„Åô„ÅãÔºü</AlertDialogDescription></AlertDialogHeader>\n                                                        <AlertDialogFooter><AlertDialogCancel className=\"rounded-full\">„Ç≠„É£„É≥„Çª„É´</AlertDialogCancel><AlertDialogAction onClick={handleLeaveTeam} className=\"bg-destructive text-destructive-foreground rounded-full\">ËÑ±ÈÄÄ„Åô„Çã</AlertDialogAction></AlertDialogFooter>\n                                                    </AlertDialogContent>\n                                                </AlertDialog>\n                                            </div>\n                                        )}\n                                        {isOwner && (\n                                            <div className=\"flex items-center justify-between p-4 rounded-2xl bg-destructive/5 border border-destructive/20\">\n                                                <div>\n                                                    <h4 className=\"font-bold text-sm text-destructive\">„Éö„ÉÉ„Éà„ÇíÂâäÈô§</h4>\n                                                    <p className=\"text-xs text-destructive/70 mt-1\">„Åô„Åπ„Å¶„ÅÆ„Éá„Éº„Çø„ÅåÊ∞∏‰πÖ„Å´ÂâäÈô§„Åï„Çå„Åæ„Åô„ÄÇ</p>\n                                                </div>\n                                                <AlertDialog>\n                                                    <AlertDialogTrigger asChild><Button variant=\"destructive\" size=\"sm\" className=\"rounded-full\">ÂâäÈô§„Åô„Çã</Button></AlertDialogTrigger>\n                                                    <AlertDialogContent className=\"glass border-white/20 rounded-[2rem]\">\n                                                        <AlertDialogHeader><AlertDialogTitle>„Éö„ÉÉ„Éà„ÇíÂâäÈô§</AlertDialogTitle><AlertDialogDescription>Êú¨ÂΩì„Å´ {pet.name} „ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü„Åì„ÅÆÊìç‰Ωú„ÅØÂèñ„ÇäÊ∂à„Åõ„Åæ„Åõ„Çì„ÄÇ</AlertDialogDescription></AlertDialogHeader>\n                                                        <AlertDialogFooter><AlertDialogCancel className=\"rounded-full\">„Ç≠„É£„É≥„Çª„É´</AlertDialogCancel><AlertDialogAction onClick={handleDeletePet} className=\"bg-destructive text-destructive-foreground rounded-full\">ÂâäÈô§„Åô„Çã</AlertDialogAction></AlertDialogFooter>\n                                                    </AlertDialogContent>\n                                                </AlertDialog>\n                                            </div>\n                                        )}\n                                    </div>\n                                </div>\n                            </TabsContent>\n                        </Tabs >\n                    </div >\n                </div >\n\n                <Dialog open={confirmDeleteAvatarOpen} onOpenChange={setConfirmDeleteAvatarOpen}>\n                    <DialogContent className=\"glass border-white/20 rounded-[2rem]\">\n                        <DialogHeader>\n                            <DialogTitle>ÁîªÂÉè„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü</DialogTitle>\n                            <DialogDescription>„Éö„ÉÉ„Éà„ÅÆ„Éó„É≠„Éï„Ç£„Éº„É´ÁîªÂÉè„ÅåÂàùÊúüÁä∂ÊÖã„Å´Êàª„Çä„Åæ„Åô„ÄÇ</DialogDescription>\n                        </DialogHeader>\n                        <DialogFooter>\n                            <Button variant=\"outline\" onClick={() => setConfirmDeleteAvatarOpen(false)} className=\"rounded-full\">„Ç≠„É£„É≥„Çª„É´</Button>\n                            <Button variant=\"destructive\" onClick={handleRemoveAvatarConfirmed} className=\"rounded-full\">ÂâäÈô§„Åô„Çã</Button>\n                        </DialogFooter>\n                    </DialogContent>\n                </Dialog>\n            </div >\n        </AppLayout >\n    );\n}\n\nexport default function PetSettingsPage() {\n    return (\n        <Suspense fallback={<AppLayout><div className=\"flex justify-center items-center min-h-[50vh]\"><div className=\"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary\"></div></div></AppLayout>}>\n            <PetSettingsContent />\n        </Suspense>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/app/profile/page.tsx",
    "messages": [
      {
        "ruleId": "@next/next/no-img-element",
        "severity": 1,
        "message": "Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element",
        "line": 331,
        "column": 57,
        "nodeType": "JSXOpeningElement",
        "endLine": 331,
        "endColumn": 150
      }
    ],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 1,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useState, useEffect } from 'react';\nimport { AppLayout } from '@/components/features/AppLayout';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { useImageUpload } from '@/hooks/useImageUpload';\n\nimport { Button } from '@/components/ui/button';\n\nimport { Label } from '@/components/ui/label';\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\nimport { Switch } from '@/components/ui/switch';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { DatePickerDropdown } from '@/components/ui/date-picker-dropdown';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from '@/components/ui/dialog';\nimport { useTheme } from 'next-themes';\nimport { LogOut, Moon, Sun, PawPrint, ExternalLink, Save, MessageSquare, Clock, Mail, ChevronRight, Settings, Edit3, Sparkles } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport Link from 'next/link';\nimport { usePets } from '@/hooks/usePets';\nimport { StyledInput, GenderSelect } from '@/components/ui/styled-form-fields';\nimport { format, parse } from 'date-fns';\n\nimport { cn } from '@/lib/utils';\nimport { toast } from 'sonner';\nimport { doc, updateDoc, serverTimestamp, deleteField } from 'firebase/firestore';\nimport { db } from '@/lib/firebase';\nimport { PetAvatarEditor } from '@/components/features/pet-avatar-editor';\n\nexport default function ProfilePage() {\n    const { user, userProfile, signOut } = useAuth();\n    const { theme, setTheme } = useTheme();\n    const { pets } = usePets();\n    const { uploadUserAvatar, uploading } = useImageUpload();\n\n\n    // „Éó„É≠„Éï„Ç£„Éº„É´ÊÉÖÂ†±\n    const [displayName, setDisplayName] = useState('');\n    const [nickname, setNickname] = useState('');\n    const [birthday, setBirthday] = useState<Date | undefined>(undefined);\n    const [gender, setGender] = useState<'male' | 'female' | 'other' | ''>('');\n    const [introduction, setIntroduction] = useState('');\n\n    // Ë®≠ÂÆö\n    const [timeFormat, setTimeFormat] = useState('HH:mm');\n    const [toastPosition, setToastPosition] = useState('bottom-right');\n\n    // UIÁä∂ÊÖã\n    const [isEditing, setIsEditing] = useState(false);\n    const [isSaving, setIsSaving] = useState(false);\n\n    // ÁîªÂÉèÁ∑®ÈõÜÁä∂ÊÖã\n\n    const [pendingAvatarFile, setPendingAvatarFile] = useState<File | null>(null);\n    const [avatarPreview, setAvatarPreview] = useState<string | null>(null);\n    const [removeAvatar, setRemoveAvatar] = useState(false);\n    const [confirmDeleteAvatarOpen, setConfirmDeleteAvatarOpen] = useState(false);\n    const [confirmCancelOpen, setConfirmCancelOpen] = useState(false);\n\n    useEffect(() => {\n        if (userProfile) {\n            setDisplayName(userProfile.displayName || '');\n            setNickname(userProfile.nickname || '');\n            setBirthday(userProfile.birthday ? parse(userProfile.birthday, 'yyyy-MM-dd', new Date()) : undefined);\n            setGender(userProfile.gender || '');\n            setIntroduction(userProfile.introduction || '');\n            if (userProfile.settings) {\n                setTimeFormat(userProfile.settings.timeFormat || 'HH:mm');\n                setToastPosition(userProfile.settings.toastPosition || 'bottom-right');\n            }\n        }\n    }, [userProfile]);\n\n    const handleUpdateSettings = async (key: string, value: string) => {\n        if (!user) return;\n\n        // Optimistic update\n        if (key === 'timeFormat') setTimeFormat(value);\n        if (key === 'toastPosition') setToastPosition(value);\n\n        try {\n            await updateDoc(doc(db, 'users', user.uid), {\n                [`settings.${key}`]: value,\n                updatedAt: serverTimestamp()\n            });\n            toast.success('Ë®≠ÂÆö„Çí‰øùÂ≠ò„Åó„Åæ„Åó„Åü');\n        } catch (error) {\n            console.error(error);\n            toast.error('Ë®≠ÂÆö„ÅÆ‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');\n        }\n    };\n\n\n\n    const handleCropComplete = (file: File) => {\n        setPendingAvatarFile(file);\n        setAvatarPreview(URL.createObjectURL(file));\n        setRemoveAvatar(false);\n    };\n\n\n\n    const handleRemoveAvatar = () => {\n        setPendingAvatarFile(null);\n        setAvatarPreview(null);\n        setRemoveAvatar(true);\n        setConfirmDeleteAvatarOpen(false);\n    };\n\n    const handleSaveProfile = async () => {\n        if (!user) return;\n        setIsSaving(true);\n        try {\n            let avatarUrl: string | ReturnType<typeof deleteField> | undefined = userProfile?.avatarUrl;\n            if (removeAvatar) {\n                avatarUrl = deleteField();\n            } else if (pendingAvatarFile) {\n                avatarUrl = await uploadUserAvatar(pendingAvatarFile);\n            }\n\n            await updateDoc(doc(db, 'users', user.uid), {\n                displayName: displayName.trim() || userProfile?.displayName,\n                nickname: nickname.trim() || null,\n                birthday: birthday ? format(birthday, 'yyyy-MM-dd') : null,\n                gender: gender || null,\n                introduction: introduction.trim() || null,\n                avatarUrl: avatarUrl,\n                updatedAt: serverTimestamp(),\n            });\n\n            setPendingAvatarFile(null);\n            setAvatarPreview(null);\n            setRemoveAvatar(false);\n            toast.success('„Éó„É≠„Éï„Ç£„Éº„É´„ÇíÊõ¥Êñ∞„Åó„Åæ„Åó„Åü');\n            setIsEditing(false);\n        } catch {\n            toast.error('„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü');\n        } finally {\n            setIsSaving(false);\n        }\n    };\n\n    // Â§âÊõ¥„Åå„ÅÇ„Çã„Åã„Å©„ÅÜ„Åã„ÇíÂà§ÂÆö\n    const hasChanges = () => {\n        if (pendingAvatarFile || removeAvatar) return true;\n        if (displayName !== (userProfile?.displayName || '')) return true;\n        if (nickname !== (userProfile?.nickname || '')) return true;\n        if (gender !== (userProfile?.gender || '')) return true;\n        if (introduction !== (userProfile?.introduction || '')) return true;\n        const currentBirthday = birthday ? format(birthday, 'yyyy-MM-dd') : null;\n        const profileBirthday = userProfile?.birthday || null;\n        if (currentBirthday !== profileBirthday) return true;\n        return false;\n    };\n\n    const handleCancelEdit = () => {\n        if (hasChanges()) {\n            setConfirmCancelOpen(true);\n            return;\n        }\n        resetForm();\n    };\n\n    const resetForm = () => {\n        setIsEditing(false);\n        if (userProfile) {\n            setDisplayName(userProfile.displayName || '');\n            setNickname(userProfile.nickname || '');\n            setBirthday(userProfile.birthday ? parse(userProfile.birthday, 'yyyy-MM-dd', new Date()) : undefined);\n            setGender(userProfile.gender || '');\n            setIntroduction(userProfile.introduction || '');\n        }\n        setPendingAvatarFile(null);\n        setAvatarPreview(null);\n        setRemoveAvatar(false);\n        setConfirmCancelOpen(false);\n    };\n\n    const displayAvatar = avatarPreview || (removeAvatar ? undefined : userProfile?.avatarUrl);\n\n    // Common List Item Component (Glass Style)\n    const ListItem = ({ icon: Icon, label, subLabel, action, className }: { icon: React.ComponentType<{ className?: string }>; label: string; subLabel?: string; action?: React.ReactNode; className?: string }) => (\n        <div className={cn(\"flex items-center justify-between p-4 rounded-2xl glass border-white/20 hover:bg-white/40 transition-all duration-300 group\", className)}>\n            <div className=\"flex items-center gap-4\">\n                <div className=\"p-2.5 rounded-full bg-white/10 text-primary group-hover:bg-primary group-hover:text-white transition-colors duration-300 shadow-sm\">\n                    <Icon className=\"w-5 h-5\" />\n                </div>\n                <div className=\"space-y-0.5\">\n                    <h3 className=\"font-bold text-sm leading-none text-foreground/90\">{label}</h3>\n                    {subLabel && <p className=\"text-xs font-medium text-muted-foreground\">{subLabel}</p>}\n                </div>\n            </div>\n            <div>{action}</div>\n        </div>\n    );\n\n    return (\n        <AppLayout>\n            <div className=\"pb-32\">\n                {/* Modern Hero Section */}\n                <div className=\"relative\">\n                    {/* Global Header Gradient */}\n                    <div className=\"absolute inset-0 h-[40vh] bg-gradient-to-b from-primary/20 via-primary/5 to-transparent -z-10 rounded-b-[4rem]\" />\n\n                    <div className=\"md:container max-w-2xl mx-auto px-4 pt-8\">\n                        {/* Header Navigation */}\n                        <div className=\"flex items-center justify-end mb-8 relative z-10\">\n                            <Button variant=\"ghost\" size=\"icon\" className=\"rounded-full text-destructive hover:bg-destructive/10 hover:text-destructive backdrop-blur-md\" onClick={signOut}>\n                                <LogOut className=\"w-5 h-5\" />\n                            </Button>\n                        </div>\n\n                        {/* Profile Header Card */}\n                        <div className=\"flex flex-col items-center mb-10\">\n                            <PetAvatarEditor\n                                imageUrl={displayAvatar}\n                                onImageChange={handleCropComplete}\n                                onImageRemove={handleRemoveAvatar}\n                                disabled={!isEditing || uploading}\n                                className=\"mb-6\"\n                            />\n\n\n                            <AnimatePresence mode=\"wait\">\n                                {!isEditing ? (\n                                    <motion.div\n                                        key=\"view\"\n                                        initial={{ opacity: 0, scale: 0.95 }}\n                                        animate={{ opacity: 1, scale: 1 }}\n                                        exit={{ opacity: 0, scale: 1.05 }}\n                                        className=\"flex flex-col items-center relative z-10\"\n                                    >\n                                        {/* Name & Bio */}\n                                        <div className=\"text-center space-y-2 mb-6\">\n                                            <h1 className=\"text-3xl font-black tracking-tight bg-clip-text text-transparent bg-gradient-to-b from-foreground to-foreground/60 filter drop-shadow-sm\">\n                                                {nickname || displayName}\n                                            </h1>\n                                            {nickname && <p className=\"text-sm font-bold text-muted-foreground tracking-wide\">{displayName}</p>}\n\n                                            {/* Email Badge */}\n                                            <div className=\"inline-flex items-center px-4 py-1.5 rounded-full glass-capsule border border-white/20 text-xs font-bold text-muted-foreground/80 mt-3 shadow-sm\">\n                                                <Mail className=\"w-3.5 h-3.5 mr-2 opacity-70\" />\n                                                {userProfile?.email}\n                                            </div>\n\n                                            <div className=\"mt-6\">\n                                                <Button\n                                                    variant=\"outline\"\n                                                    className=\"rounded-full px-6 border-primary/20 text-primary hover:bg-primary/5 hover:text-primary transition-all duration-300\"\n                                                    onClick={() => setIsEditing(true)}\n                                                >\n                                                    <Edit3 className=\"w-4 h-4 mr-2\" />\n                                                    „Éó„É≠„Éï„Ç£„Éº„É´„ÇíÁ∑®ÈõÜ\n                                                </Button>\n                                            </div>\n                                        </div>\n                                    </motion.div>\n                                ) : (\n                                    <motion.div key=\"edit\" className=\"w-full max-w-md mt-4 relative z-20\" initial={{ opacity: 0, height: 0 }} animate={{ opacity: 1, height: 'auto' }}>\n\n                                        <div className=\"glass rounded-[2rem] p-4 sm:p-6 shadow-xl border-white/20\">\n                                            <div className=\"space-y-4\">\n                                                <div className=\"grid gap-3 sm:gap-4\">\n                                                    <div>\n                                                        <Label className=\"text-xs font-bold text-muted-foreground ml-1\">Ë°®Á§∫Âêç</Label>\n                                                        <StyledInput value={displayName} onChange={(e) => setDisplayName(e.target.value)} placeholder=\"„ÅäÂêçÂâç\" />\n                                                    </div>\n                                                    <div>\n                                                        <Label className=\"text-xs font-bold text-muted-foreground ml-1\">„Éã„ÉÉ„ÇØ„Éç„Éº„É†</Label>\n                                                        <StyledInput value={nickname} onChange={(e) => setNickname(e.target.value)} placeholder=\"„Éã„ÉÉ„ÇØ„Éç„Éº„É†\" />\n                                                    </div>\n                                                </div>\n\n                                                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4\">\n                                                    <div>\n                                                        <Label className=\"text-xs font-bold text-muted-foreground ml-1\">ÊÄßÂà•</Label>\n                                                        <GenderSelect\n                                                            value={gender}\n                                                            onChange={(v) => setGender(v as 'male' | 'female' | 'other' | '')}\n                                                            type=\"human\"\n                                                        />\n                                                    </div>\n                                                    <DatePickerDropdown\n                                                        date={birthday}\n                                                        setDate={setBirthday}\n                                                        label=\"Ë™ïÁîüÊó•\"\n                                                    />\n                                                </div>\n                                                <div>\n                                                    <Label className=\"text-xs font-bold text-muted-foreground ml-1\">Ëá™Â∑±Á¥π‰ªã</Label>\n                                                    <textarea\n                                                        value={introduction}\n                                                        onChange={(e) => setIntroduction(e.target.value)}\n                                                        rows={2}\n                                                        className=\"w-full rounded-xl border border-white/20 bg-white/50 dark:bg-black/20 dark:border-white/20 px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus:bg-background transition-colors resize-none\"\n                                                        placeholder=\"„Å≤„Å®„Åì„Å®...\"\n                                                    />\n                                                </div>\n                                            </div>\n                                        </div>\n\n                                        {/* Sticky buttons */}\n                                        <div className=\"sticky bottom-24 z-20 pt-4\">\n                                            <div className=\"flex gap-3\">\n                                                <Button variant=\"ghost\" className=\"flex-1 rounded-full h-12 bg-white/50 dark:bg-white/10 dark:hover:bg-white/20 backdrop-blur-md shadow-lg\" onClick={handleCancelEdit}>„Ç≠„É£„É≥„Çª„É´</Button>\n                                                <Button className=\"flex-1 gradient-primary shadow-2xl rounded-full h-12\" onClick={handleSaveProfile} disabled={isSaving || !displayName.trim()}>\n                                                    <Save className=\"w-4 h-4 mr-2\" />{isSaving ? '‰øùÂ≠ò‰∏≠...' : '‰øùÂ≠ò'}\n                                                </Button>\n                                            </div>\n                                        </div>\n                                    </motion.div>\n                                )}\n                            </AnimatePresence>\n                        </div>\n\n                        {/* Settings Sections - Magazine Style Grid */}\n                        <div className=\"space-y-8\">\n                            {/* Pets Section */}\n                            <section className=\"space-y-4\">\n                                <h2 className=\"text-lg font-black px-1 flex items-center gap-2 text-foreground/80\">\n                                    <Sparkles className=\"w-5 h-5 text-primary\" />\n                                    „Éû„Ç§„Éï„Ç°„Éü„É™„Éº\n                                </h2>\n                                <div className=\"grid gap-4 sm:grid-cols-2\">\n                                    {pets.map((pet) => (\n                                        <Link key={pet.id} href={`/pets/settings?id=${pet.id}`}>\n                                            <div className=\"flex items-center gap-4 p-4 rounded-2xl glass border-white/20 hover:bg-white/40 hover:scale-[1.02] transition-all duration-300 group shadow-sm\">\n                                                <Avatar className=\"w-14 h-14 border-2 border-white/50 shadow-md group-hover:scale-105 transition-transform duration-300\">\n                                                    <AvatarImage src={pet.avatarUrl} alt={pet.name} className=\"object-cover\" />\n                                                    <AvatarFallback className=\"bg-orange-100 flex items-center justify-center overflow-hidden\">\n                                                        <img src=\"/ogp.webp\" alt=\"Pet\" className=\"w-full h-full object-cover opacity-50 grayscale\" />\n                                                    </AvatarFallback>\n                                                </Avatar>\n                                                <div className=\"flex-1 min-w-0\">\n                                                    <p className=\"font-bold text-base truncate group-hover:text-primary transition-colors\">{pet.name}</p>\n                                                    <p className=\"text-xs font-bold text-muted-foreground truncate\">{pet.breed || 'Áä¨Á®ÆÊú™Ë®≠ÂÆö'}</p>\n                                                </div>\n                                                <div className=\"w-8 h-8 rounded-full bg-white/20 flex items-center justify-center\">\n                                                    <ChevronRight className=\"w-4 h-4 text-muted-foreground/60 group-hover:text-primary group-hover:translate-x-0.5 transition-all\" />\n                                                </div>\n                                            </div>\n                                        </Link>\n                                    ))}\n                                    <Link href=\"/pets/new\">\n                                        <div className=\"flex flex-col items-center justify-center gap-2 p-4 rounded-2xl border-2 border-dashed border-white/20 hover:bg-white/20 hover:border-primary/30 transition-all duration-300 cursor-pointer h-full group bg-white/5\">\n                                            <div className=\"w-10 h-10 rounded-full bg-white/10 group-hover:bg-primary/10 flex items-center justify-center transition-colors\">\n                                                <PawPrint className=\"w-5 h-5 text-muted-foreground group-hover:text-primary transition-colors\" />\n                                            </div>\n                                            <span className=\"text-xs font-bold text-muted-foreground group-hover:text-primary transition-colors\">Êñ∞„Åó„ÅÑÂÆ∂Êóè„ÇíËøé„Åà„Çã</span>\n                                        </div>\n                                    </Link>\n                                </div>\n                            </section>\n\n                            {/* App Settings */}\n                            <section className=\"space-y-4\">\n                                <h2 className=\"text-lg font-black px-1 flex items-center gap-2 text-foreground/80\">\n                                    <Settings className=\"w-5 h-5 text-primary\" />\n                                    „Ç¢„Éó„É™Ë®≠ÂÆö\n                                </h2>\n                                <div className=\"space-y-3\">\n                                    <ListItem\n                                        icon={theme === 'dark' ? Moon : Sun}\n                                        label=\"„ÉÄ„Éº„ÇØ„É¢„Éº„Éâ\"\n                                        subLabel=\"ÁîªÈù¢„ÅÆÊòéÂ∫¶„ÇíË™øÊï¥„Åó„Åæ„Åô\"\n                                        action={<Switch checked={theme === 'dark'} onCheckedChange={(c) => setTheme(c ? 'dark' : 'light')} />}\n                                    />\n                                    <ListItem\n                                        icon={Clock}\n                                        label=\"ÊôÇÂàªË°®Ë®ò\"\n                                        subLabel={timeFormat}\n                                        action={\n                                            <Select value={timeFormat} onValueChange={(v) => handleUpdateSettings('timeFormat', v)}>\n                                                <SelectTrigger className=\"w-[100px] h-9 text-xs bg-transparent border-white/20 rounded-lg\"><SelectValue /></SelectTrigger>\n                                                <SelectContent>\n                                                    <SelectItem value=\"HH:mm\">24ÊôÇÈñì</SelectItem>\n                                                    <SelectItem value=\"h:mm aa\">12ÊôÇÈñì</SelectItem>\n                                                </SelectContent>\n                                            </Select>\n                                        }\n                                    />\n                                    <ListItem\n                                        icon={MessageSquare}\n                                        label=\"ÈÄöÁü•‰ΩçÁΩÆ\"\n                                        subLabel=\"„Éà„Éº„Çπ„ÉàÈÄöÁü•„ÅÆË°®Á§∫Â†¥ÊâÄ\"\n                                        action={\n                                            <Select value={toastPosition} onValueChange={(v) => handleUpdateSettings('toastPosition', v)}>\n                                                <SelectTrigger className=\"w-[100px] h-9 text-xs bg-transparent border-white/20 rounded-lg\"><SelectValue /></SelectTrigger>\n                                                <SelectContent>\n                                                    <SelectItem value=\"top-right\">Âè≥‰∏ä</SelectItem>\n                                                    <SelectItem value=\"top-center\">‰∏äÈÉ®‰∏≠Â§Æ</SelectItem>\n                                                    <SelectItem value=\"bottom-right\">Âè≥‰∏ã</SelectItem>\n                                                    <SelectItem value=\"bottom-center\">‰∏ãÈÉ®‰∏≠Â§Æ</SelectItem>\n                                                </SelectContent>\n                                            </Select>\n                                        }\n                                    />\n                                </div>\n                            </section>\n\n                            {/* Other Links */}\n                            <section className=\"space-y-4\">\n                                <h2 className=\"text-lg font-black px-1 flex items-center gap-2 text-foreground/80\">\n                                    <span className=\"w-5 h-5\" />\n                                    „Åù„ÅÆ‰ªñ\n                                </h2>\n                                <a href=\"https://aina-life-dev.web.app\" target=\"_blank\" rel=\"noopener noreferrer\">\n                                    <ListItem\n                                        icon={ExternalLink}\n                                        label=\"Êóß„Ç¢„Éó„É™„ÇíÈñã„Åè\"\n                                        subLabel=\"aina-life-dev.web.app\"\n                                        action={<ChevronRight className=\"w-4 h-4 text-muted-foreground\" />}\n                                    />\n                                </a>\n                            </section>\n                        </div>\n                    </div>\n                </div>\n\n\n\n                <Dialog open={confirmDeleteAvatarOpen} onOpenChange={setConfirmDeleteAvatarOpen}>\n                    <DialogContent>\n                        <DialogHeader>\n                            <DialogTitle>ÁîªÂÉè„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü</DialogTitle>\n                            <DialogDescription>„Éó„É≠„Éï„Ç£„Éº„É´ÁîªÂÉè„ÅåÂàùÊúüÁä∂ÊÖã„Å´Êàª„Çä„Åæ„Åô„ÄÇ„Åì„ÅÆÊìç‰Ωú„ÅØÂèñ„ÇäÊ∂à„Åõ„Åæ„Åõ„Çì„ÄÇ</DialogDescription>\n                        </DialogHeader>\n                        <DialogFooter>\n                            <Button variant=\"outline\" onClick={() => setConfirmDeleteAvatarOpen(false)}>„Ç≠„É£„É≥„Çª„É´</Button>\n                            <Button variant=\"destructive\" onClick={handleRemoveAvatar}>ÂâäÈô§„Åô„Çã</Button>\n                        </DialogFooter>\n                    </DialogContent>\n                </Dialog>\n\n                {/* Á∑®ÈõÜ„Ç≠„É£„É≥„Çª„É´Á¢∫Ë™ç„ÉÄ„Ç§„Ç¢„É≠„Ç∞ */}\n                <Dialog open={confirmCancelOpen} onOpenChange={setConfirmCancelOpen}>\n                    <DialogContent>\n                        <DialogHeader>\n                            <DialogTitle>Á∑®ÈõÜ„Çí‰∏≠Ê≠¢„Åó„Åæ„Åô„ÅãÔºü</DialogTitle>\n                            <DialogDescription>ÂÖ•Âäõ„Åó„ÅüÂÜÖÂÆπ„ÅØ‰øùÂ≠ò„Åï„Çå„Åæ„Åõ„Çì„ÄÇ</DialogDescription>\n                        </DialogHeader>\n                        <DialogFooter>\n                            <Button variant=\"outline\" onClick={() => setConfirmCancelOpen(false)}>Á∑®ÈõÜ„ÇíÁ∂ö„Åë„Çã</Button>\n                            <Button variant=\"destructive\" onClick={resetForm}>‰∏≠Ê≠¢„Åô„Çã</Button>\n                        </DialogFooter>\n                    </DialogContent>\n                </Dialog>\n            </div>\n        </AppLayout>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/app/weight/page.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'useEffect' is defined but never used.",
        "line": 3,
        "column": 29,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 3,
        "endColumn": 38
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'useRef' is defined but never used.",
        "line": 3,
        "column": 40,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 3,
        "endColumn": 46
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'DatePickerDropdown' is defined but never used.",
        "line": 10,
        "column": 10,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 10,
        "endColumn": 28
      }
    ],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 3,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useState, useMemo, useEffect, useRef } from 'react';\nimport { AppLayout } from '@/components/features/AppLayout';\nimport { usePetContext } from '@/contexts/PetContext';\nimport { useMembers } from '@/hooks/useMembers';\nimport { useWeights } from '@/hooks/useWeights';\nimport { Button } from '@/components/ui/button';\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from '@/components/ui/alert-dialog';\nimport { DatePickerDropdown } from '@/components/ui/date-picker-dropdown';\nimport { format, subMonths, isAfter, startOfDay } from 'date-fns';\nimport { ja } from 'date-fns/locale';\nimport { Plus, TrendingUp, TrendingDown, Minus, Trash2, Activity, Calendar as CalendarIcon, Edit2 } from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport { motion } from 'framer-motion';\nimport { toast } from 'sonner';\nimport { AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts';\nimport { WeightFormSheet } from '@/components/features/WeightFormSheet';\nimport { WeightItem } from '@/lib/types';\n\nexport default function WeightPage() {\n    const { selectedPet } = usePetContext();\n    const { canEdit } = useMembers(selectedPet?.id || null);\n    const { weights, loading, addWeight, updateWeight, deleteWeight } = useWeights(selectedPet?.id || null);\n    const [isSubmitting, setIsSubmitting] = useState(false);\n    const [range, setRange] = useState<'1m' | '3m' | 'all'>('3m');\n    const [deletingWeightId, setDeletingWeightId] = useState<string | null>(null);\n    const [editingWeight, setEditingWeight] = useState<WeightItem | null>(null);\n    const [isSheetOpen, setIsSheetOpen] = useState(false);\n\n    const chartData = useMemo(() => {\n        let filtered = [...weights];\n\n        if (range !== 'all') {\n            const now = new Date();\n            const months = range === '1m' ? 1 : 3;\n            const threshold = startOfDay(subMonths(now, months));\n            filtered = filtered.filter(w => isAfter(w.date.toDate(), threshold));\n        }\n\n        return filtered\n            .sort((a, b) => {\n                const dateDiff = a.date.toMillis() - b.date.toMillis();\n                if (dateDiff !== 0) return dateDiff;\n                return (a.createdAt?.toMillis() || 0) - (b.createdAt?.toMillis() || 0);\n            })\n            .map((w) => ({\n                date: format(w.date.toDate(), 'M/d'),\n                fullDate: format(w.date.toDate(), 'yyyy/MM/dd'),\n                weight: w.unit === 'g' ? w.value / 1000 : w.value,\n                unit: 'kg'\n            }));\n    }, [weights, range]);\n\n    const latestWeight = weights[0];\n    const previousWeight = weights[1];\n    const weightChange = latestWeight && previousWeight ? (latestWeight.unit === 'g' ? latestWeight.value / 1000 : latestWeight.value) - (previousWeight.unit === 'g' ? previousWeight.value / 1000 : previousWeight.value) : null;\n\n    // ÂâçÂõû„ÅÆ‰ΩìÈáçÂçò‰Ωç„Çí„Éá„Éï„Ç©„É´„Éà„Å´Ë®≠ÂÆöÔºà„É¶„Éº„Ç∂„Éº„ÅåÊâãÂãï„ÅßÂ§âÊõ¥„Åó„Å¶„ÅÑ„Å™„ÅÑÂ†¥ÂêàÔºâ\n    // useEffect(() => {\n    //     if (latestWeight && !unitUserOverridden.current) {\n    //         setNewUnit(latestWeight.unit);\n    //     }\n    // }, [latestWeight]);\n\n    const handleSave = async (data: { value: number; unit: 'kg' | 'g'; date: Date }) => {\n        if (!canEdit) return;\n        setIsSubmitting(true);\n        try {\n            if (editingWeight) {\n                await updateWeight(editingWeight.id, data);\n            } else {\n                await addWeight(data);\n            }\n            toast.success(editingWeight ? 'Êõ¥Êñ∞„Åó„Åæ„Åó„Åü' : '‰ΩìÈáç„ÇíË®òÈå≤„Åó„Åæ„Åó„Åü');\n            setIsSheetOpen(false);\n            setEditingWeight(null);\n        } catch {\n            toast.error('„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü');\n        } finally {\n            setIsSubmitting(false);\n        }\n    };\n\n    const handleDelete = async () => {\n        if (!canEdit || !deletingWeightId) return;\n        try {\n            await deleteWeight(deletingWeightId);\n            toast.success('ÂâäÈô§„Åó„Åæ„Åó„Åü');\n        } catch {\n            toast.error('„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü');\n        } finally {\n            setDeletingWeightId(null);\n        }\n    };\n\n    if (!selectedPet) return <AppLayout><div className=\"p-4 text-center py-12\"><p className=\"text-muted-foreground\">„Éö„ÉÉ„Éà„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</p></div></AppLayout>;\n\n    return (\n        <AppLayout>\n\n            <div className=\"relative min-h-screen pb-32\">\n                {/* Global Header Gradient */}\n                <div className=\"absolute inset-0 h-[40vh] bg-gradient-to-b from-primary/20 via-primary/5 to-transparent -z-10 rounded-b-[4rem]\" />\n\n                <div className=\"px-4 pt-6 space-y-8\">\n                    {/* Header */}\n                    <div className=\"flex items-center justify-between z-10 relative\">\n                        <div>\n                            <h1 className=\"text-3xl font-black bg-clip-text text-transparent bg-gradient-to-r from-foreground to-foreground/70 tracking-tight\">\n                                ‰ΩìÈáçË®òÈå≤\n                            </h1>\n                            <p className=\"text-xs font-bold text-muted-foreground ml-1\">{selectedPet.name}„ÅÆÊàêÈï∑Ë®òÈå≤</p>\n                        </div>\n                    </div>\n\n                    {/* Hero Stat Card */}\n                    {latestWeight && (\n                        <motion.div\n                            initial={{ opacity: 0, scale: 0.95 }}\n                            animate={{ opacity: 1, scale: 1 }}\n                            className=\"glass rounded-[2rem] p-5 relative overflow-hidden shadow-xl ring-1 ring-white/20 flex items-center justify-between\"\n                        >\n                            {/* Decorative background glow */}\n                            <div className=\"absolute top-0 left-0 w-full h-1 bg-gradient-primary opacity-50\" />\n                            <div className=\"absolute -right-10 -top-10 w-32 h-32 bg-primary/5 rounded-full blur-2xl\" />\n\n                            <div>\n                                <p className=\"text-xs font-bold text-muted-foreground mb-1\">ÁèæÂú®„ÅÆ‰ΩìÈáç</p>\n                                <div className=\"flex items-baseline gap-2\">\n                                    <span className=\"text-4xl font-black tracking-tighter text-foreground filter drop-shadow-sm\">\n                                        {latestWeight.value}\n                                    </span>\n                                    <span className=\"text-sm text-muted-foreground font-bold\">{latestWeight.unit}</span>\n                                </div>\n                                <p className=\"text-[10px] text-muted-foreground/50 mt-1 font-mono\">\n                                    ÊúÄÁµÇÊõ¥Êñ∞: {format(latestWeight.date.toDate(), 'yyyy/MM/dd')}\n                                </p>\n                            </div>\n\n                            {weightChange !== null && (\n                                <div className={cn(\n                                    'flex flex-col items-end px-3 py-2 rounded-xl text-xs font-bold border border-white/10 backdrop-blur-sm shadow-sm ml-auto',\n                                    weightChange > 0 ? 'bg-red-500/5 text-red-500' :\n                                        weightChange < 0 ? 'bg-green-500/5 text-green-500' : 'bg-muted/50 text-muted-foreground'\n                                )}>\n                                    <span className=\"text-[10px] opacity-70 mb-0.5\">ÂâçÂõûÊØî</span>\n                                    <div className=\"flex items-center gap-1 text-base\">\n                                        {weightChange > 0 ? <TrendingUp className=\"w-4 h-4\" /> :\n                                            weightChange < 0 ? <TrendingDown className=\"w-4 h-4\" /> :\n                                                <Minus className=\"w-4 h-4\" />}\n                                        <span>{weightChange > 0 ? '+' : ''}{weightChange.toFixed(2)}</span>\n                                    </div>\n                                </div>\n                            )}\n                        </motion.div>\n                    )}\n\n                    {/* Chart Section */}\n                    {weights.length > 0 && (\n                        <motion.div\n                            initial={{ opacity: 0, y: 20 }}\n                            animate={{ opacity: 1, y: 0 }}\n                            transition={{ delay: 0.1 }}\n                            className=\"glass rounded-[2.5rem] p-6 w-full shadow-2xl ring-1 ring-white/10 relative\"\n                        >\n                            <div className=\"flex items-center justify-between mb-8\">\n                                <div className=\"flex items-center gap-3\">\n                                    <div className=\"p-2.5 rounded-full bg-orange-500/10 text-orange-500 shadow-inner\">\n                                        <Activity className=\"w-5 h-5\" />\n                                    </div>\n                                    <h3 className=\"text-lg font-black text-foreground/80 tracking-tight\">Êé®Áßª</h3>\n                                </div>\n\n                                {/* Range Selector */}\n                                <div className=\"flex p-1 bg-muted/50 rounded-full text-xs font-medium\">\n                                    {(['1m', '3m', 'all'] as const).map((r) => (\n                                        <button\n                                            key={r}\n                                            onClick={() => setRange(r)}\n                                            className={cn(\n                                                \"px-3 py-1.5 rounded-full transition-all\",\n                                                range === r\n                                                    ? \"bg-white dark:bg-zinc-800 shadow-sm text-foreground font-bold\"\n                                                    : \"text-muted-foreground hover:text-foreground\"\n                                            )}\n                                        >\n                                            {r === '1m' ? '1„É∂Êúà' : r === '3m' ? '3„É∂Êúà' : 'ÂÖ®ÊúüÈñì'}\n                                        </button>\n                                    ))}\n                                </div>\n                            </div>\n\n                            <div className=\"h-[320px] w-full -ml-3\">\n                                {chartData.length > 0 ? (\n                                    <ResponsiveContainer width=\"100%\" height=\"100%\">\n                                        <AreaChart data={chartData} margin={{ top: 10, right: 10, left: 0, bottom: 0 }}>\n                                            <defs>\n                                                <linearGradient id=\"weightGradient\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                                                    <stop offset=\"5%\" stopColor=\"#f97316\" stopOpacity={0.5} />\n                                                    <stop offset=\"95%\" stopColor=\"#f97316\" stopOpacity={0} />\n                                                </linearGradient>\n                                            </defs>\n                                            <CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke=\"var(--border)\" opacity={0.5} />\n                                            <XAxis\n                                                dataKey=\"date\"\n                                                tick={{ fontSize: 10, fill: 'var(--foreground)', opacity: 0.7 }}\n                                                tickLine={false}\n                                                axisLine={false}\n                                                dy={10}\n                                                minTickGap={30}\n                                            />\n                                            <YAxis\n                                                tick={{ fontSize: 10, fill: 'var(--foreground)', opacity: 0.7 }}\n                                                tickLine={false}\n                                                axisLine={false}\n                                                tickCount={5}\n                                                domain={['dataMin - 0.5', 'auto']}\n                                                dx={-5}\n                                            />\n                                            <Tooltip\n                                                content={({ active, payload }) => {\n                                                    if (active && payload && payload.length) {\n                                                        const data = payload[0].payload;\n                                                        return (\n                                                            <div className=\"glass-capsule px-4 py-2 border border-white/20 shadow-xl !bg-white/80 dark:!bg-black/80 backdrop-blur-xl\">\n                                                                <p className=\"text-[10px] text-muted-foreground font-medium mb-0.5\">{data.fullDate}</p>\n                                                                <p className=\"text-lg font-black text-orange-500 leading-none\">\n                                                                    {Number(data.weight).toFixed(2)}\n                                                                    <span className=\"text-xs text-muted-foreground ml-1 font-medium\">kg</span>\n                                                                </p>\n                                                            </div>\n                                                        );\n                                                    }\n                                                    return null;\n                                                }}\n                                            />\n                                            <Area\n                                                type=\"monotone\"\n                                                dataKey=\"weight\"\n                                                stroke=\"#f97316\"\n                                                strokeWidth={3}\n                                                fill=\"url(#weightGradient)\"\n                                                animationDuration={1000}\n                                                dot={{\n                                                    r: 4,\n                                                    fill: \"#f97316\",\n                                                    stroke: \"var(--background)\",\n                                                    strokeWidth: 2\n                                                }}\n                                                activeDot={{\n                                                    r: 7,\n                                                    fill: \"#f97316\",\n                                                    stroke: \"var(--background)\",\n                                                    strokeWidth: 4,\n                                                    className: \"filter drop-shadow-lg\"\n                                                }}\n                                            />\n                                        </AreaChart>\n                                    </ResponsiveContainer>\n                                ) : (\n                                    <div className=\"h-full flex items-center justify-center text-muted-foreground text-sm\">\n                                        „Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì\n                                    </div>\n                                )}\n                            </div>\n                        </motion.div>\n                    )}\n\n                    {/* History List */}\n                    <motion.div\n                        initial={{ opacity: 0, y: 20 }}\n                        animate={{ opacity: 1, y: 0 }}\n                        transition={{ delay: 0.2 }}\n                        className=\"space-y-4\"\n                    >\n                        <h3 className=\"font-bold px-2 text-foreground/70 flex items-center gap-2\">\n                            <CalendarIcon className=\"w-4 h-4\" />\n                            Ë®òÈå≤Â±•Ê≠¥\n                        </h3>\n\n                        {loading ? (\n                            <div className=\"space-y-3\">{[...Array(3)].map((_, i) => <div key={i} className=\"h-16 bg-muted/20 animate-pulse rounded-2xl\" />)}</div>\n                        ) : weights.length === 0 ? (\n                            <p className=\"text-center text-muted-foreground py-6\">„Åæ„Å†Ë®òÈå≤„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>\n                        ) : (\n                            <div className=\"space-y-3\">\n                                {weights.map((w, index) => (\n                                    <motion.div\n                                        key={w.id}\n                                        initial={{ opacity: 0, x: -10 }}\n                                        animate={{ opacity: 1, x: 0 }}\n                                        transition={{ delay: index * 0.05 }}\n                                        className=\"flex items-center justify-between p-4 rounded-2xl glass hover:bg-white/40 transition-colors border-white/20\"\n                                    >\n                                        <div className=\"flex items-center gap-4\">\n                                            <div className=\"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center text-primary font-bold text-xs ring-4 ring-white/10\">\n                                                {format(w.date.toDate(), 'd')}\n                                            </div>\n                                            <div>\n                                                <p className=\"font-bold text-lg leading-none\">{w.value} <span className=\"text-xs font-normal text-muted-foreground\">{w.unit}</span></p>\n                                                <p className=\"text-[10px] text-muted-foreground mt-1\">{format(w.date.toDate(), 'yyyyÂπ¥MÊúà', { locale: ja })}</p>\n                                            </div>\n                                        </div>\n                                        {canEdit && (\n                                            <div className=\"flex gap-1\">\n                                                <Button\n                                                    variant=\"ghost\"\n                                                    size=\"icon\"\n                                                    onClick={() => { setEditingWeight(w); setIsSheetOpen(true); }}\n                                                    className=\"text-muted-foreground/30 hover:text-primary hover:bg-primary/10 rounded-full w-8 h-8\"\n                                                >\n                                                    <Edit2 className=\"w-4 h-4\" />\n                                                </Button>\n                                                <Button\n                                                    variant=\"ghost\"\n                                                    size=\"icon\"\n                                                    onClick={() => setDeletingWeightId(w.id)}\n                                                    className=\"text-muted-foreground/30 hover:text-destructive hover:bg-destructive/10 rounded-full w-8 h-8\"\n                                                >\n                                                    <Trash2 className=\"w-4 h-4\" />\n                                                </Button>\n                                            </div>\n                                        )}\n                                    </motion.div>\n                                ))}\n                            </div>\n                        )}\n                    </motion.div>\n                </div>\n\n                {/* Sticky FAB */}\n                {canEdit && (\n                    <div className=\"sticky bottom-24 z-20 flex justify-center px-4 pt-6\">\n                        <motion.button\n                            onClick={() => { setEditingWeight(null); setIsSheetOpen(true); }}\n                            whileHover={{ scale: 1.05 }}\n                            whileTap={{ scale: 0.95 }}\n                            className=\"flex items-center gap-2 px-8 h-14 rounded-full bg-gradient-to-r from-primary to-orange-500 shadow-xl shadow-primary/30 text-white font-bold transition-all duration-300 hover:shadow-2xl hover:shadow-orange-500/50 hover:brightness-110\"\n                        >\n                            <Plus className=\"w-5 h-5\" />\n                            <span>‰ΩìÈáç„ÇíË®òÈå≤</span>\n                        </motion.button>\n                    </div>\n                )}\n\n                <WeightFormSheet\n                    open={isSheetOpen}\n                    weightItem={editingWeight}\n                    onClose={() => { setIsSheetOpen(false); setEditingWeight(null); }}\n                    onSave={handleSave}\n                    isSubmitting={isSubmitting}\n                />\n            </div>\n            {/* ÂâäÈô§Á¢∫Ë™ç„ÉÄ„Ç§„Ç¢„É≠„Ç∞ */}\n            <AlertDialog open={!!deletingWeightId} onOpenChange={(open) => !open && setDeletingWeightId(null)}>\n                <AlertDialogContent className=\"glass border-white/20\">\n                    <AlertDialogHeader>\n                        <AlertDialogTitle>‰ΩìÈáçË®òÈå≤„ÇíÂâäÈô§</AlertDialogTitle>\n                        <AlertDialogDescription>\n                            „Åì„ÅÆË®òÈå≤„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü„Åì„ÅÆÊìç‰Ωú„ÅØÂèñ„ÇäÊ∂à„Åõ„Åæ„Åõ„Çì„ÄÇ\n                        </AlertDialogDescription>\n                    </AlertDialogHeader>\n                    <AlertDialogFooter>\n                        <AlertDialogCancel className=\"rounded-full\">„Ç≠„É£„É≥„Çª„É´</AlertDialogCancel>\n                        <AlertDialogAction onClick={handleDelete} className=\"bg-destructive text-destructive-foreground rounded-full hover:bg-destructive/90\">\n                            ÂâäÈô§\n                        </AlertDialogAction>\n                    </AlertDialogFooter>\n                </AlertDialogContent>\n            </AlertDialog>\n        </AppLayout>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/dashboard/HeroSection.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'PawPrint' is defined but never used.",
        "line": 7,
        "column": 10,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 7,
        "endColumn": 18
      },
      {
        "ruleId": "@next/next/no-img-element",
        "severity": 1,
        "message": "Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element",
        "line": 72,
        "column": 29,
        "nodeType": "JSXOpeningElement",
        "endLine": 72,
        "endColumn": 122
      }
    ],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 2,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { motion } from 'framer-motion';\nimport { format } from 'date-fns';\nimport { ja } from 'date-fns/locale';\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\nimport { PawPrint, Settings } from 'lucide-react';\nimport Link from 'next/link';\nimport { Button } from '@/components/ui/button';\nimport { usePetContext } from '@/contexts/PetContext';\n\nexport function HeroSection() {\n    const { selectedPet } = usePetContext();\n    const now = new Date();\n    const hour = now.getHours();\n\n    let greeting = '„Åì„Çì„Å´„Å°„ÅØ';\n    if (hour < 5) greeting = '„Åì„Çì„Å∞„Çì„ÅØ';\n    else if (hour < 11) greeting = '„Åä„ÅØ„Çà„ÅÜ';\n    else if (hour < 18) greeting = '„Åì„Çì„Å´„Å°„ÅØ';\n    else greeting = '„Åì„Çì„Å∞„Çì„ÅØ';\n\n    if (!selectedPet) return null;\n\n    return (\n        <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5 }}\n            className=\"relative overflow-hidden rounded-3xl bg-gradient-to-br from-primary/90 to-primary/70 text-primary-foreground p-6 shadow-xl\"\n        >\n            {/* Background Decorations */}\n            <div className=\"absolute top-0 right-0 -mr-16 -mt-16 w-64 h-64 bg-white/10 rounded-full blur-3xl opacity-50 pointer-events-none\" />\n            <div className=\"absolute bottom-0 left-0 -ml-16 -mb-16 w-48 h-48 bg-black/5 rounded-full blur-2xl opacity-30 pointer-events-none\" />\n\n            <div className=\"relative z-10 flex items-start justify-between\">\n                <div>\n                    <motion.div\n                        initial={{ opacity: 0, x: -20 }}\n                        animate={{ opacity: 1, x: 0 }}\n                        transition={{ delay: 0.2 }}\n                        className=\"flex flex-col\"\n                    >\n                        <span className=\"text-sm font-medium opacity-90 mb-1\">\n                            {format(now, 'MÊúàdÊó• EEEE', { locale: ja })}\n                        </span>\n                        <h1 className=\"text-3xl font-bold tracking-tight mb-2\">\n                            {greeting},<br />\n                            <span className=\"text-4xl\">{selectedPet.name}</span>\n                        </h1>\n                    </motion.div>\n                </div>\n\n                <Link href={`/pets/settings?id=${selectedPet.id}`}>\n                    <Button variant=\"ghost\" size=\"icon\" className=\"text-primary-foreground/80 hover:text-white hover:bg-white/20 rounded-full\">\n                        <Settings className=\"w-5 h-5\" />\n                    </Button>\n                </Link>\n            </div>\n\n            <motion.div\n                initial={{ scale: 0.8, opacity: 0 }}\n                animate={{ scale: 1, opacity: 1 }}\n                transition={{ delay: 0.3, type: \"spring\" }}\n                className=\"mt-6 flex justify-center\"\n            >\n                <div className=\"relative\">\n                    <div className=\"absolute inset-0 bg-white/30 blur-xl rounded-full scale-110\" />\n                    <Avatar className=\"w-24 h-24 border-4 border-white/20 shadow-2xl relative z-10\">\n                        <AvatarImage src={selectedPet.avatarUrl} alt={selectedPet.name} className=\"object-cover\" />\n                        <AvatarFallback className=\"bg-white/20 flex items-center justify-center overflow-hidden\">\n                            <img src=\"/ogp.webp\" alt=\"Pet\" className=\"w-full h-full object-cover opacity-50 grayscale\" />\n                        </AvatarFallback>\n                    </Avatar>\n                    {/* Status Indicator (Mockup for now) */}\n                    <div className=\"absolute bottom-1 right-1 w-6 h-6 bg-green-400 border-4 border-primary rounded-full z-20 shadow-lg\" />\n                </div>\n            </motion.div>\n        </motion.div>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/dashboard/QuickActions.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'cn' is defined but never used.",
        "line": 10,
        "column": 10,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 10,
        "endColumn": 12
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'taskName' is defined but never used.",
        "line": 23,
        "column": 32,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 23,
        "endColumn": 40
      }
    ],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 2,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { motion } from 'framer-motion';\nimport { Button } from '@/components/ui/button';\nimport { Plus } from 'lucide-react';\nimport Link from 'next/link';\nimport { useCustomTasks } from '@/hooks/useCustomTasks';\nimport { usePetContext } from '@/contexts/PetContext';\nimport { ENTRY_TAGS } from '@/lib/types';\nimport { cn } from '@/lib/utils';\nimport { useRouter } from 'next/navigation';\n\nexport function QuickActions() {\n    const { selectedPet } = usePetContext();\n    const { tasks } = useCustomTasks(selectedPet?.id || null);\n    const router = useRouter();\n\n    // Use top 4 tasks or specific defaults if no tasks\n    const displayTasks = tasks.length > 0\n        ? tasks.slice(0, 4)\n        : ENTRY_TAGS.slice(0, 4).map(t => ({ name: t.label, emoji: t.emoji }));\n\n    const handleQuickAction = (taskName: string) => {\n        // Navigate to entry creation with pre-selected tag\n        // Note: EntryForm needs to handle `tag` search param if we implement that.\n        // For now, just go to new entry. \n        // Ideally: router.push(`/entry/new?tag=${encodeURIComponent(taskName)}`);\n        // But let's check if EntryForm supports it. It might not yet.\n        // So for now, just open new entry.\n        router.push('/entry/new');\n    };\n\n    return (\n        <div className=\"grid grid-cols-4 gap-3\">\n            {displayTasks.map((task, index) => (\n                <motion.button\n                    key={task.name}\n                    initial={{ opacity: 0, y: 10 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    transition={{ delay: 0.1 * index + 0.3 }}\n                    whileHover={{ scale: 1.05, backgroundColor: 'rgba(255, 255, 255, 0.4)' }}\n                    whileTap={{ scale: 0.95 }}\n                    onClick={() => handleQuickAction(task.name)}\n                    className=\"flex flex-col items-center justify-center p-3 rounded-2xl bg-white/20 dark:bg-black/20 backdrop-blur-md border border-white/10 shadow-sm hover:shadow-md transition-all gap-1.5\"\n                >\n                    <span className=\"text-2xl drop-shadow-sm\">{task.emoji}</span>\n                    <span className=\"text-[10px] font-medium text-foreground/80 truncate w-full text-center\">{task.name}</span>\n                </motion.button>\n            ))}\n\n            <motion.div\n                initial={{ opacity: 0, y: 10 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 0.7 }}\n            >\n                <Link href=\"/entry/new\" className=\"h-full\">\n                    <Button\n                        variant=\"outline\"\n                        className=\"w-full h-full flex flex-col items-center justify-center p-3 rounded-2xl border-dashed border-primary/30 bg-primary/5 hover:bg-primary/10 gap-1\"\n                    >\n                        <Plus className=\"w-5 h-5 text-primary\" />\n                        <span className=\"text-[10px] font-medium text-primary\">„Åù„ÅÆ‰ªñ</span>\n                    </Button>\n                </Link>\n            </motion.div>\n        </div>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/dashboard/TimelineView.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'isCollapsible' is assigned a value but never used.",
        "line": 28,
        "column": 5,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 28,
        "endColumn": 18
      },
      {
        "ruleId": "react-hooks/exhaustive-deps",
        "severity": 1,
        "message": "The 'now' object construction makes the dependencies of useMemo Hook (at line 350) change on every render. Move it inside the useMemo callback. Alternatively, wrap the initialization of 'now' in its own useMemo() Hook.",
        "line": 272,
        "column": 11,
        "nodeType": "VariableDeclarator",
        "endLine": 272,
        "endColumn": 27
      }
    ],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 2,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useState, useMemo, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport Image from 'next/image';\nimport { format } from 'date-fns';\nimport { usePetContext } from '@/contexts/PetContext';\nimport { useEntries } from '@/hooks/useEntries';\nimport { useFriends } from '@/hooks/useFriends';\nimport { useCustomTasks } from '@/hooks/useCustomTasks';\nimport { useMembers } from '@/hooks/useMembers';\nimport { ENTRY_TAGS, Entry } from '@/lib/types';\nimport { CheckCircle2, Circle, Clock, ChevronDown, Sparkles, CalendarCheck, AlertTriangle } from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport { toast } from 'sonner';\nimport { useTimeFormat } from '@/hooks/useTimeFormat';\nimport { collection, query, where, orderBy, onSnapshot, Timestamp } from 'firebase/firestore';\nimport { db } from '@/lib/firebase';\nimport { EntryDetailSheet } from '@/components/features/EntryDetailSheet';\nimport { EntryEditSheet } from '@/components/features/EntryEditSheet';\n\n// Section Header Component\nfunction SectionHeader({\n    icon,\n    title,\n    count,\n    color = 'primary',\n    isCollapsible = false,\n    isOpen = true,\n    onToggle\n}: {\n    icon: React.ReactNode;\n    title: string;\n    count: number;\n    color?: 'primary' | 'blue' | 'green' | 'amber';\n    isCollapsible?: boolean;\n    isOpen?: boolean;\n    onToggle?: () => void;\n}) {\n    const colorClasses = {\n        primary: 'from-primary/20 to-primary/5 text-primary',\n        blue: 'from-blue-500/20 to-blue-500/5 text-blue-500',\n        green: 'from-green-500/20 to-green-500/5 text-green-500',\n        amber: 'from-amber-500/20 to-amber-500/5 text-amber-600',\n    };\n\n    return (\n        <button\n            onClick={onToggle}\n            className={cn(\n                \"w-full flex items-center gap-3 px-4 py-3 rounded-2xl transition-all\",\n                `bg-gradient-to-r ${colorClasses[color]}`,\n                \"cursor-pointer hover:opacity-90 active:scale-[0.99]\"\n            )}\n        >\n            <div className={cn(\n                \"w-8 h-8 rounded-xl flex items-center justify-center\",\n                \"bg-white/50 dark:bg-black/20 shadow-sm\"\n            )}>\n                {icon}\n            </div>\n            <span className=\"font-bold text-sm flex-1 text-left\">{title}</span>\n            <span className=\"text-xs font-bold opacity-60 bg-white/30 dark:bg-black/20 px-2.5 py-1 rounded-full\">\n                {count}\n            </span>\n            <ChevronDown className={cn(\n                \"w-4 h-4 transition-transform duration-300\",\n                !isOpen && \"-rotate-90\"\n            )} />\n        </button>\n    );\n}\n\n// Entry Card Component\nfunction EntryCard({\n    entry,\n    tasks,\n    friends,\n    formatTime,\n    onToggleComplete,\n    onClick,\n    isCompact = false,\n    isOverdue = false\n}: {\n    entry: Entry;\n    tasks: { name: string; emoji: string }[];\n    friends: { id: string; name: string; images?: string[] }[];\n    formatTime: (date: Date) => string;\n    onToggleComplete: (e: React.MouseEvent, entryId: string, isCompleted: boolean) => void;\n    onClick: () => void;\n    isCompact?: boolean;\n    isOverdue?: boolean;\n}) {\n    const isSchedule = entry.type === 'schedule';\n    const firstTag = entry.tags[0];\n    const tagInfo = tasks.find((t) => t.name === firstTag) || ENTRY_TAGS.find((t) => t.value === firstTag);\n    const mainEmoji = tagInfo?.emoji || 'üìù';\n    const displayName = entry.title || (tagInfo && ('label' in tagInfo ? tagInfo.label : tagInfo.name)) || firstTag;\n\n    // Time display logic\n    const renderTime = () => {\n        const startDate = entry.date.toDate();\n\n        if (entry.timeType === 'range' && entry.endDate) {\n            const endDateTime = entry.endDate.toDate();\n            const isSameDayRange = startDate.toDateString() === endDateTime.toDateString();\n\n            if (isSameDayRange) {\n                return (\n                    <span className=\"text-[10px] font-bold font-mono text-muted-foreground\">\n                        {formatTime(startDate)} ~ {formatTime(endDateTime)}\n                    </span>\n                );\n            } else {\n                return (\n                    <div className=\"flex flex-col items-end text-[9px] font-bold font-mono text-muted-foreground leading-tight\">\n                        <span>{format(startDate, 'M/d')} {formatTime(startDate)}</span>\n                        <span className=\"text-primary/50\">~</span>\n                        <span>{format(endDateTime, 'M/d')} {formatTime(endDateTime)}</span>\n                    </div>\n                );\n            }\n        }\n\n        return (\n            <span className=\"text-xs font-bold font-mono text-muted-foreground\">\n                {formatTime(startDate)}\n            </span>\n        );\n    };\n\n    return (\n        <motion.div\n            initial={{ opacity: 0, y: 10 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: -10 }}\n            className=\"group\"\n        >\n            <div onClick={onClick} className=\"cursor-pointer\">\n                <div className={cn(\n                    \"flex items-center gap-3 p-3 rounded-2xl border transition-all duration-300\",\n                    \"hover:scale-[1.02] active:scale-[0.98]\",\n                    isOverdue\n                        ? \"bg-amber-50/80 dark:bg-amber-950/40 border-amber-300/50 dark:border-amber-800/30\"\n                        : isSchedule && !entry.isCompleted\n                            ? \"bg-blue-50/80 dark:bg-blue-950/40 border-blue-200/50 dark:border-blue-800/30\"\n                            : entry.isCompleted\n                                ? \"bg-muted/30 border-muted/20 opacity-60\"\n                                : \"bg-white/60 dark:bg-zinc-900/60 border-white/30 dark:border-white/5 backdrop-blur-xl\"\n                )}>\n                    {/* Time */}\n                    <div className=\"w-14 sm:w-16 flex-shrink-0 text-right\">\n                        {renderTime()}\n                    </div>\n\n                    {/* Emoji */}\n                    <div className={cn(\n                        \"w-9 h-9 sm:w-10 sm:h-10 rounded-xl flex items-center justify-center flex-shrink-0\",\n                        \"bg-gradient-to-br from-white/80 to-white/40 dark:from-white/10 dark:to-white/5\",\n                        \"shadow-sm border border-white/50 dark:border-white/10\"\n                    )}>\n                        <span className=\"text-lg sm:text-xl\">{mainEmoji}</span>\n                    </div>\n\n                    {/* Content */}\n                    <div className=\"flex-1 min-w-0 overflow-hidden\">\n                        <div className=\"flex items-center gap-1.5\">\n                            {entry.tags.length > 1 && (\n                                <div className=\"flex -space-x-1 opacity-70 flex-shrink-0\">\n                                    {entry.tags.slice(1, 3).map(tag => {\n                                        const t = tasks.find(x => x.name === tag) || ENTRY_TAGS.find(x => x.value === tag);\n                                        return <span key={tag} className=\"text-xs\">{t?.emoji}</span>;\n                                    })}\n                                </div>\n                            )}\n                            <h3 className={cn(\n                                \"font-bold text-sm truncate\",\n                                entry.isCompleted && \"line-through\"\n                            )}>\n                                {displayName}\n                            </h3>\n                        </div>\n                        {!isCompact && entry.body && (\n                            <p className={cn(\n                                \"text-xs text-muted-foreground truncate mt-0.5\",\n                                entry.isCompleted && \"line-through\"\n                            )}>\n                                {entry.body}\n                            </p>\n                        )}\n                    </div>\n\n                    {/* Images - scrollable on mobile */}\n                    {entry.imageUrls.length > 0 && (\n                        <div className=\"flex items-center gap-1 flex-shrink-0\">\n                            <div className=\"flex -space-x-2 overflow-hidden\">\n                                {entry.imageUrls.slice(0, 2).map((url, i) => (\n                                    <div key={i} className=\"w-8 h-8 sm:w-10 sm:h-10 rounded-lg overflow-hidden ring-2 ring-background flex-shrink-0 relative\">\n                                        <Image src={url} alt=\"\" fill className=\"object-cover\" />\n                                    </div>\n                                ))}\n                            </div>\n                            {entry.imageUrls.length > 2 && (\n                                <div className=\"w-6 h-6 rounded-full bg-muted/50 flex items-center justify-center\">\n                                    <span className=\"text-[10px] font-bold text-muted-foreground\">+{entry.imageUrls.length - 2}</span>\n                                </div>\n                            )}\n                        </div>\n                    )}\n\n                    {/* Friends */}\n                    {entry.friendIds && entry.friendIds.length > 0 && (\n                        <div className=\"flex -space-x-1.5 flex-shrink-0 ml-1\">\n                            {entry.friendIds.slice(0, 3).map((fid) => {\n                                const friend = friends.find(f => f.id === fid);\n                                if (!friend) return null;\n                                return (\n                                    <div key={fid} className=\"w-6 h-6 rounded-full ring-1 ring-background overflow-hidden relative\" title={friend.name}>\n                                        {friend.images?.[0] ? (\n                                            <Image src={friend.images[0]} alt={friend.name} fill className=\"object-cover\" />\n                                        ) : (\n                                            <div className=\"w-full h-full bg-muted flex items-center justify-center relative\">\n                                                <Image src=\"/ogp.webp\" alt=\"No image\" fill className=\"object-cover opacity-50 grayscale\" />\n                                            </div>\n                                        )}\n                                    </div>\n                                );\n                            })}\n                        </div>\n                    )}\n\n                    {/* Complete toggle */}\n                    {isSchedule && (\n                        <button\n                            onClick={(e) => onToggleComplete(e, entry.id, entry.isCompleted || false)}\n                            className=\"flex-shrink-0 text-muted-foreground hover:text-green-500 transition-colors z-20\"\n                        >\n                            {entry.isCompleted\n                                ? <CheckCircle2 className=\"w-5 h-5 sm:w-6 sm:h-6 text-green-500\" />\n                                : <Circle className=\"w-5 h-5 sm:w-6 sm:h-6\" />\n                            }\n                        </button>\n                    )}\n                </div>\n            </div>\n        </motion.div>\n    );\n}\n\nexport function TimelineView() {\n    const { selectedPet } = usePetContext();\n    const { entries, loading, updateEntry, deleteEntry } = useEntries(selectedPet?.id || null);\n    const { friends } = useFriends(selectedPet?.id || null);\n    const { tasks } = useCustomTasks(selectedPet?.id || null);\n    const { formatTime } = useTimeFormat();\n    const { canEdit } = useMembers(selectedPet?.id || null);\n\n    // Collapsible section states\n    const [showOverdue, setShowOverdue] = useState(true);\n    const [showSchedules, setShowSchedules] = useState(true);\n    const [showRecords, setShowRecords] = useState(true);\n    const [showCompleted, setShowCompleted] = useState(false);\n\n    // Sheet states\n    const [selectedEntry, setSelectedEntry] = useState<Entry | null>(null);\n    const [sheetMode, setSheetMode] = useState<'detail' | 'edit' | null>(null);\n    const [isSubmitting, setIsSubmitting] = useState(false);\n\n    // Overdue schedules (past incomplete)\n    const [overdueSchedules, setOverdueSchedules] = useState<Entry[]>([]);\n\n    const now = new Date();\n    const today = useMemo(() => {\n        const d = new Date();\n        d.setHours(0, 0, 0, 0);\n        return d;\n    }, []);\n    const tomorrow = useMemo(() => {\n        const d = new Date(today);\n        d.setDate(d.getDate() + 1);\n        return d;\n    }, [today]);\n\n    // Fetch overdue schedules (past incomplete)\n    useEffect(() => {\n        if (!selectedPet?.id) {\n            setOverdueSchedules([]);\n            return;\n        }\n\n        // Index-free query: Filter by date only, then filter type in memory\n        const overdueQuery = query(\n            collection(db, 'pets', selectedPet.id, 'entries'),\n            where('date', '<', Timestamp.fromDate(today)),\n            orderBy('date', 'desc')\n            // limit(50) // Optional: restrict fetch size\n        );\n\n        const unsubscribe = onSnapshot(overdueQuery, (snapshot) => {\n            const overdue = snapshot.docs\n                .map((doc) => ({ id: doc.id, ...doc.data() } as Entry))\n                .filter(entry => entry.type === 'schedule' && !entry.isCompleted);\n            setOverdueSchedules(overdue);\n        });\n\n        return () => unsubscribe();\n    }, [selectedPet?.id, today]);\n\n    // Filter today's entries\n    const todayEntries = useMemo(() => entries.filter((entry) => {\n        const entryStart = entry.date.toDate();\n        const entryEnd = entry.timeType === 'range' && entry.endDate\n            ? entry.endDate.toDate()\n            : entryStart;\n\n        const startsToday = entryStart >= today && entryStart < tomorrow;\n        const todayInRange = entryStart < tomorrow && entryEnd >= today;\n\n        return startsToday || todayInRange;\n    }), [entries, today, tomorrow]);\n\n    // Categorize entries\n    const { upcomingSchedules, pastRecords, completedItems } = useMemo(() => {\n        const upcoming: Entry[] = [];\n        const past: Entry[] = [];\n        const completed: Entry[] = [];\n\n        todayEntries.forEach(entry => {\n            const entryTime = entry.date.toDate();\n            const isSchedule = entry.type === 'schedule';\n\n            if (isSchedule && entry.isCompleted) {\n                completed.push(entry);\n            } else if (isSchedule && entryTime > now) {\n                upcoming.push(entry);\n            } else if (isSchedule && !entry.isCompleted) {\n                // Overdue incomplete schedule\n                upcoming.push(entry);\n            } else {\n                past.push(entry);\n            }\n        });\n\n        // Sort\n        upcoming.sort((a, b) => a.date.toDate().getTime() - b.date.toDate().getTime());\n        past.sort((a, b) => b.date.toDate().getTime() - a.date.toDate().getTime()); // Recent first\n        completed.sort((a, b) => b.date.toDate().getTime() - a.date.toDate().getTime());\n\n        return { upcomingSchedules: upcoming, pastRecords: past, completedItems: completed };\n    }, [todayEntries, now]);\n\n    const handleToggleComplete = async (e: React.MouseEvent, entryId: string, isCompleted: boolean) => {\n        e.preventDefault();\n        e.stopPropagation();\n        try {\n            await updateEntry(entryId, { isCompleted: !isCompleted });\n            toast.success(isCompleted ? 'Êú™ÂÆå‰∫Ü„Å´„Åó„Åæ„Åó„Åü' : 'ÂÆå‰∫Ü„Åó„Åæ„Åó„Åü');\n        } catch {\n            toast.error('„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü');\n        }\n    };\n\n    if (loading) {\n        return (\n            <div className=\"space-y-4 px-4 mt-8\">\n                {[...Array(3)].map((_, i) => (\n                    <div key={i} className=\"h-16 bg-muted/20 animate-pulse rounded-2xl\" />\n                ))}\n            </div>\n        );\n    }\n\n    if (todayEntries.length === 0 && overdueSchedules.length === 0) {\n        return (\n            <motion.div\n                initial={{ opacity: 0 }}\n                animate={{ opacity: 1 }}\n                className=\"flex flex-col items-center justify-center py-20 text-center\"\n            >\n                <div className=\"w-24 h-24 mb-6 rounded-full bg-gradient-to-tr from-primary/10 to-primary/5 flex items-center justify-center\">\n                    <span className=\"text-4xl filter drop-shadow-sm\">‚ú®</span>\n                </div>\n                <p className=\"text-lg font-medium text-foreground/80\">‰ªäÊó•„ÅØ„Åæ„Å†Ë®òÈå≤„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>\n                <p className=\"text-sm text-muted-foreground mt-2\">„Åô„Å¶„Åç„Å™‰∏ÄÊó•„ÇíÂßã„ÇÅ„Åæ„Åó„Çá„ÅÜÔºÅ</p>\n            </motion.div>\n        );\n    }\n\n    return (\n        <>\n            <div className=\"px-4 py-6 space-y-6\">\n                {/* Overdue Schedules */}\n                {overdueSchedules.length > 0 && (\n                    <motion.div\n                        initial={{ opacity: 0, y: 20 }}\n                        animate={{ opacity: 1, y: 0 }}\n                        className=\"space-y-3\"\n                    >\n                        <SectionHeader\n                            icon={<AlertTriangle className=\"w-4 h-4\" />}\n                            title=\"ÊúüÈôêÂàá„Çå„ÅÆ‰∫àÂÆö\"\n                            count={overdueSchedules.length}\n                            color=\"amber\"\n                            isOpen={showOverdue}\n                            onToggle={() => setShowOverdue(!showOverdue)}\n                        />\n                        <AnimatePresence>\n                            {showOverdue && (\n                                <motion.div\n                                    initial={{ opacity: 0, height: 0 }}\n                                    animate={{ opacity: 1, height: 'auto' }}\n                                    exit={{ opacity: 0, height: 0 }}\n                                    className=\"space-y-2 pl-2 overflow-hidden\"\n                                >\n                                    {overdueSchedules.map(entry => (\n                                        <EntryCard\n                                            key={entry.id}\n                                            entry={entry}\n                                            tasks={tasks}\n                                            friends={friends}\n                                            formatTime={formatTime}\n                                            onToggleComplete={handleToggleComplete}\n                                            onClick={() => { setSelectedEntry(entry); setSheetMode('detail'); }}\n                                            isOverdue\n                                        />\n                                    ))}\n                                </motion.div>\n                            )}\n                        </AnimatePresence>\n                    </motion.div>\n                )}\n\n                {/* Upcoming Schedules */}\n                {upcomingSchedules.length > 0 && (\n                    <motion.div\n                        initial={{ opacity: 0, y: 20 }}\n                        animate={{ opacity: 1, y: 0 }}\n                        className=\"space-y-3\"\n                    >\n                        <SectionHeader\n                            icon={<Clock className=\"w-4 h-4\" />}\n                            title=\"‰ªäÊó•„ÅÆ‰∫àÂÆö\"\n                            count={upcomingSchedules.length}\n                            color=\"blue\"\n                            isOpen={showSchedules}\n                            onToggle={() => setShowSchedules(!showSchedules)}\n                        />\n                        <AnimatePresence>\n                            {showSchedules && (\n                                <motion.div\n                                    initial={{ opacity: 0, height: 0 }}\n                                    animate={{ opacity: 1, height: 'auto' }}\n                                    exit={{ opacity: 0, height: 0 }}\n                                    className=\"space-y-2 pl-2 overflow-hidden\"\n                                >\n                                    {upcomingSchedules.map(entry => (\n                                        <EntryCard\n                                            key={entry.id}\n                                            entry={entry}\n                                            tasks={tasks}\n                                            friends={friends}\n                                            formatTime={formatTime}\n                                            onToggleComplete={handleToggleComplete}\n                                            onClick={() => { setSelectedEntry(entry); setSheetMode('detail'); }}\n                                        />\n                                    ))}\n                                </motion.div>\n                            )}\n                        </AnimatePresence>\n                    </motion.div>\n                )}\n\n                {/* Today's Records */}\n                {pastRecords.length > 0 && (\n                    <motion.div\n                        initial={{ opacity: 0, y: 20 }}\n                        animate={{ opacity: 1, y: 0 }}\n                        transition={{ delay: 0.1 }}\n                        className=\"space-y-3\"\n                    >\n                        <SectionHeader\n                            icon={<Sparkles className=\"w-4 h-4\" />}\n                            title=\"‰ªäÊó•„ÅÆË®òÈå≤\"\n                            count={pastRecords.length}\n                            color=\"primary\"\n                            isOpen={showRecords}\n                            onToggle={() => setShowRecords(!showRecords)}\n                        />\n                        <AnimatePresence>\n                            {showRecords && (\n                                <motion.div\n                                    initial={{ opacity: 0, height: 0 }}\n                                    animate={{ opacity: 1, height: 'auto' }}\n                                    exit={{ opacity: 0, height: 0 }}\n                                    className=\"space-y-2 pl-2 overflow-hidden\"\n                                >\n                                    {pastRecords.map(entry => (\n                                        <EntryCard\n                                            key={entry.id}\n                                            entry={entry}\n                                            tasks={tasks}\n                                            friends={friends}\n                                            formatTime={formatTime}\n                                            onToggleComplete={handleToggleComplete}\n                                            onClick={() => { setSelectedEntry(entry); setSheetMode('detail'); }}\n                                        />\n                                    ))}\n                                </motion.div>\n                            )}\n                        </AnimatePresence>\n                    </motion.div>\n                )}\n\n                {/* Completed */}\n                {completedItems.length > 0 && (\n                    <motion.div\n                        initial={{ opacity: 0, y: 20 }}\n                        animate={{ opacity: 1, y: 0 }}\n                        transition={{ delay: 0.2 }}\n                        className=\"space-y-3\"\n                    >\n                        <SectionHeader\n                            icon={<CalendarCheck className=\"w-4 h-4\" />}\n                            title=\"ÂÆå‰∫ÜÊ∏à„Åø\"\n                            count={completedItems.length}\n                            color=\"green\"\n                            isCollapsible\n                            isOpen={showCompleted}\n                            onToggle={() => setShowCompleted(!showCompleted)}\n                        />\n                        <AnimatePresence>\n                            {showCompleted && (\n                                <motion.div\n                                    initial={{ opacity: 0, height: 0 }}\n                                    animate={{ opacity: 1, height: 'auto' }}\n                                    exit={{ opacity: 0, height: 0 }}\n                                    className=\"space-y-2 pl-2 overflow-hidden\"\n                                >\n                                    {completedItems.map(entry => (\n                                        <EntryCard\n                                            key={entry.id}\n                                            entry={entry}\n                                            tasks={tasks}\n                                            friends={friends}\n                                            formatTime={formatTime}\n                                            onToggleComplete={handleToggleComplete}\n                                            onClick={() => { setSelectedEntry(entry); setSheetMode('detail'); }}\n                                            isCompact\n                                        />\n                                    ))}\n                                </motion.div>\n                            )}\n                        </AnimatePresence>\n                    </motion.div>\n                )}\n            </div>\n\n            {/* Detail Sheet */}\n            <EntryDetailSheet\n                entry={selectedEntry}\n                open={sheetMode === 'detail'}\n                onClose={() => { setSelectedEntry(null); setSheetMode(null); }}\n                onEdit={() => setSheetMode('edit')}\n                onDelete={async (id) => { await deleteEntry(id); }}\n                tasks={tasks}\n                friends={friends}\n                canEdit={canEdit}\n            />\n\n            {/* Edit Sheet */}\n            <EntryEditSheet\n                entry={selectedEntry}\n                open={sheetMode === 'edit'}\n                onClose={() => { setSelectedEntry(null); setSheetMode(null); }}\n                onSave={async (id, data) => {\n                    setIsSubmitting(true);\n                    try {\n                        await updateEntry(id, data);\n                        toast.success('‰øùÂ≠ò„Åó„Åæ„Åó„Åü');\n                    } finally {\n                        setIsSubmitting(false);\n                    }\n                }}\n                isSubmitting={isSubmitting}\n            />\n        </>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/features/AppLayout.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/features/BottomNav.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/features/ClientToaster.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 8,
        "column": 63,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 8,
        "endColumn": 66,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [235, 238], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [235, 238], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useAuth } from '@/contexts/AuthContext';\nimport { Toaster } from 'sonner';\n\nexport function ClientToaster() {\n    const { userProfile } = useAuth();\n    const position = (userProfile?.settings?.toastPosition as any) || 'top-center';\n\n    return <Toaster position={position} richColors closeButton />;\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/features/CustomTaskEditor.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/features/EntryDetailSheet.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 22,
        "column": 12,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 22,
        "endColumn": 15,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [954, 957], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [954, 957], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@next/next/no-img-element",
        "severity": 1,
        "message": "Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element",
        "line": 134,
        "column": 57,
        "nodeType": "JSXOpeningElement",
        "endLine": 134,
        "endColumn": 144
      },
      {
        "ruleId": "@next/next/no-img-element",
        "severity": 1,
        "message": "Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element",
        "line": 137,
        "column": 61,
        "nodeType": "JSXOpeningElement",
        "endLine": 137,
        "endColumn": 159
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 155,
        "column": 68,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 155,
        "endColumn": 71,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [9063, 9066], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [9063, 9066], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 159,
        "column": 64,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 159,
        "endColumn": 67,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [9572, 9575], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [9572, 9575], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 159,
        "column": 90,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 159,
        "endColumn": 93,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [9598, 9601], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [9598, 9601], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@next/next/no-img-element",
        "severity": 1,
        "message": "Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element",
        "line": 182,
        "column": 45,
        "nodeType": "JSXOpeningElement",
        "endLine": 182,
        "endColumn": 108
      }
    ],
    "suppressedMessages": [],
    "errorCount": 4,
    "fatalErrorCount": 0,
    "warningCount": 3,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useState } from 'react';\nimport { Sheet, SheetContent, SheetHeader, SheetTitle } from '@/components/ui/sheet';\nimport { Button } from '@/components/ui/button';\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger } from '@/components/ui/alert-dialog';\nimport { ENTRY_TAGS, Entry } from '@/lib/types';\nimport { format, isSameDay } from 'date-fns';\nimport { ja } from 'date-fns/locale';\nimport { Trash2, Edit, Calendar, Clock, X } from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { toast } from 'sonner';\nimport { useTimeFormat } from '@/hooks/useTimeFormat';\nimport { Friend } from '@/lib/types';\n\ninterface EntryDetailSheetProps {\n    entry: Entry | null;\n    open: boolean;\n    onClose: () => void;\n    onEdit: () => void;\n    onDelete: (entryId: string) => Promise<void>;\n    tasks: any[];\n    friends: Friend[];\n    canEdit: boolean;\n}\n\nexport function EntryDetailSheet({\n    entry,\n    open,\n    onClose,\n    onEdit,\n    onDelete,\n    tasks,\n    friends,\n    canEdit,\n}: EntryDetailSheetProps) {\n    const { formatTime } = useTimeFormat();\n    const [isDeleting, setIsDeleting] = useState(false);\n\n    if (!entry) return null;\n\n    const entryDate = entry.date.toDate();\n\n    const handleDelete = async () => {\n        setIsDeleting(true);\n        try {\n            await onDelete(entry.id);\n            toast.success('ÂâäÈô§„Åó„Åæ„Åó„Åü');\n            onClose();\n        } catch {\n            toast.error('„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü');\n        } finally {\n            setIsDeleting(false);\n        }\n    };\n\n    return (\n        <Sheet open={open} onOpenChange={(isOpen) => !isOpen && onClose()}>\n            <SheetContent side=\"bottom\" className=\"h-[85vh] rounded-t-3xl bg-background/95 backdrop-blur-xl border-t border-white/20 p-0 overflow-hidden\">\n                {/* Header */}\n                <SheetHeader className=\"sticky top-0 z-10 bg-background/80 backdrop-blur-md border-b border-white/10 px-4 py-3\">\n                    <div className=\"flex items-center justify-between\">\n                        <Button variant=\"ghost\" size=\"icon\" onClick={onClose} className=\"rounded-full w-9 h-9\">\n                            <X className=\"w-5 h-5\" />\n                        </Button>\n                        <SheetTitle className=\"text-sm font-bold\">Ë©≥Á¥∞</SheetTitle>\n                        <div className=\"flex gap-1\">\n                            {canEdit && (\n                                <>\n                                    <Button variant=\"ghost\" size=\"icon\" onClick={onEdit} className=\"rounded-full w-9 h-9 text-muted-foreground hover:text-foreground\">\n                                        <Edit className=\"w-4 h-4\" />\n                                    </Button>\n                                    <AlertDialog>\n                                        <AlertDialogTrigger asChild>\n                                            <Button variant=\"ghost\" size=\"icon\" className=\"rounded-full w-9 h-9 text-muted-foreground hover:text-destructive\">\n                                                <Trash2 className=\"w-4 h-4\" />\n                                            </Button>\n                                        </AlertDialogTrigger>\n                                        <AlertDialogContent className=\"glass border-white/20\">\n                                            <AlertDialogHeader>\n                                                <AlertDialogTitle>„Ç®„É≥„Éà„É™„Éº„ÇíÂâäÈô§</AlertDialogTitle>\n                                                <AlertDialogDescription>\n                                                    Êú¨ÂΩì„Å´„Åì„ÅÆ„Ç®„É≥„Éà„É™„Éº„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü„Åì„ÅÆÊìç‰Ωú„ÅØÂèñ„ÇäÊ∂à„Åõ„Åæ„Åõ„Çì„ÄÇ\n                                                </AlertDialogDescription>\n                                            </AlertDialogHeader>\n                                            <AlertDialogFooter>\n                                                <AlertDialogCancel className=\"rounded-full\">„Ç≠„É£„É≥„Çª„É´</AlertDialogCancel>\n                                                <AlertDialogAction onClick={handleDelete} disabled={isDeleting} className=\"bg-destructive text-destructive-foreground rounded-full hover:bg-destructive/90\">\n                                                    ÂâäÈô§\n                                                </AlertDialogAction>\n                                            </AlertDialogFooter>\n                                        </AlertDialogContent>\n                                    </AlertDialog>\n                                </>\n                            )}\n                        </div>\n                    </div>\n                </SheetHeader>\n\n                {/* Content */}\n                <div className=\"overflow-y-auto h-full pb-20 px-4 py-6 space-y-6\">\n                    <motion.div initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }}>\n                        {/* Date & Time Badge */}\n                        <div className=\"flex justify-center mb-6\">\n                            <div className=\"glass-capsule px-4 py-2 flex flex-wrap items-center justify-center gap-2 text-xs font-bold text-foreground/80 shadow-lg backdrop-blur-xl bg-white/40 dark:bg-black/40 border border-white/20\">\n                                <span className=\"flex items-center gap-1.5\"><Calendar className=\"w-3.5 h-3.5 text-primary\" /> {format(entryDate, 'M/d (E)', { locale: ja })}</span>\n                                <span className=\"w-px h-3 bg-foreground/20\" />\n                                <span className=\"flex items-center gap-1.5\"><Clock className=\"w-3.5 h-3.5 text-primary\" /> {formatTime(entryDate)}</span>\n\n                                {entry.timeType === 'range' && entry.endDate && (\n                                    <>\n                                        <span className=\"text-primary/50\">‚Üí</span>\n                                        {!isSameDay(entryDate, entry.endDate.toDate()) && (\n                                            <span className=\"flex items-center gap-1.5\"><Calendar className=\"w-3.5 h-3.5 text-primary/70\" /> {format(entry.endDate.toDate(), 'M/d (E)', { locale: ja })}</span>\n                                        )}\n                                        <span className=\"flex items-center gap-1.5\"><Clock className=\"w-3.5 h-3.5 text-primary/70\" /> {formatTime(entry.endDate.toDate())}</span>\n                                    </>\n                                )}\n                            </div>\n                        </div>\n\n                        {/* Friends */}\n                        {entry.friendIds && entry.friendIds.length > 0 && (\n                            <div className=\"flex justify-center mb-4\">\n                                <div className=\"glass-capsule px-3 py-1.5 flex items-center gap-3 bg-white/30 dark:bg-black/30 backdrop-blur-md border border-white/10\">\n                                    <span className=\"text-[10px] font-bold text-muted-foreground uppercase tracking-wider\">With</span>\n                                    <div className=\"flex items-center -space-x-2\">\n                                        {entry.friendIds.map(fid => {\n                                            const friend = friends.find(f => f.id === fid);\n                                            if (!friend) return null;\n                                            return (\n                                                <div key={fid} className=\"relative w-7 h-7 rounded-full border-2 border-background overflow-hidden\" title={friend.name}>\n                                                    {friend.images?.[0] ? (\n                                                        <img src={friend.images[0]} alt={friend.name} className=\"w-full h-full object-cover\" />\n                                                    ) : (\n                                                        <div className=\"w-full h-full bg-muted flex items-center justify-center\">\n                                                            <img src=\"/ogp.webp\" alt=\"No image\" className=\"w-full h-full object-cover opacity-50 grayscale\" />\n                                                        </div>\n                                                    )}\n                                                </div>\n                                            );\n                                        })}\n                                    </div>\n                                </div>\n                            </div>\n                        )}\n\n                        {/* Main Content Glass Panel */}\n                        <div className=\"glass rounded-3xl p-6 shadow-xl relative overflow-hidden\">\n                            <div className=\"absolute top-0 left-0 w-full h-1 bg-gradient-primary opacity-50\" />\n\n                            {/* Tags */}\n                            <div className=\"flex flex-wrap gap-2 mb-6 justify-center\">\n                                {entry.tags.map((tag) => {\n                                    const tagInfo = tasks.find((t: any) => t.name === tag) || ENTRY_TAGS.find((t) => t.value === tag);\n                                    return (\n                                        <span key={tag} className=\"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-xl bg-white/40 dark:bg-white/5 border border-white/20 text-foreground text-sm font-bold shadow-sm backdrop-blur-md\">\n                                            <span className=\"text-base\">{tagInfo?.emoji}</span>\n                                            <span>{(tagInfo as any)?.name || (tagInfo as any)?.label}</span>\n                                        </span>\n                                    );\n                                })}\n                            </div>\n\n                            {/* Title */}\n                            {entry.title && (\n                                <h1 className=\"text-xl font-bold text-center mb-4\">{entry.title}</h1>\n                            )}\n\n                            {/* Body */}\n                            {entry.body && (\n                                <div className=\"text-foreground/90 leading-relaxed whitespace-pre-wrap text-sm\">\n                                    {entry.body}\n                                </div>\n                            )}\n\n                            {/* Images Grid */}\n                            {entry.imageUrls.length > 0 && (\n                                <div className=\"mt-6 grid grid-cols-2 gap-2\">\n                                    {entry.imageUrls.map((url, i) => (\n                                        <div key={i} className=\"aspect-square rounded-xl overflow-hidden shadow-md ring-1 ring-white/10\">\n                                            <img src={url} alt=\"\" className=\"w-full h-full object-cover\" />\n                                        </div>\n                                    ))}\n                                </div>\n                            )}\n                        </div>\n                    </motion.div>\n                </div>\n            </SheetContent>\n        </Sheet>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/features/EntryEditSheet.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 13,
        "column": 37,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 13,
        "endColumn": 40,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [420, 423], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [420, 423], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 26,
        "column": 39,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 26,
        "endColumn": 42,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [664, 667], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [664, 667], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 2,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { Sheet, SheetContent, SheetHeader, SheetTitle } from '@/components/ui/sheet';\nimport { Button } from '@/components/ui/button';\nimport { X } from 'lucide-react';\nimport { EntryForm } from '@/components/features/EntryForm';\nimport { Entry } from '@/lib/types';\n\ninterface EntryEditSheetProps {\n    entry: Entry | null;\n    open: boolean;\n    onClose: () => void;\n    onSave: (entryId: string, data: any) => Promise<void>;\n    isSubmitting: boolean;\n}\n\nexport function EntryEditSheet({\n    entry,\n    open,\n    onClose,\n    onSave,\n    isSubmitting,\n}: EntryEditSheetProps) {\n    if (!entry) return null;\n\n    const handleSubmit = async (data: any) => {\n        await onSave(entry.id, data);\n        onClose();\n    };\n\n    return (\n        <Sheet open={open} onOpenChange={(isOpen) => !isOpen && onClose()}>\n            <SheetContent side=\"bottom\" className=\"h-[95vh] rounded-t-3xl bg-background/95 backdrop-blur-xl border-t border-white/20 p-0 overflow-hidden\">\n                {/* Header */}\n                <SheetHeader className=\"sticky top-0 z-10 bg-background/80 backdrop-blur-md border-b border-white/10 px-4 py-3\">\n                    <div className=\"flex items-center justify-between\">\n                        <Button variant=\"ghost\" size=\"icon\" onClick={onClose} className=\"rounded-full w-9 h-9\">\n                            <X className=\"w-5 h-5\" />\n                        </Button>\n                        <SheetTitle className=\"text-sm font-bold opacity-0\">Á∑®ÈõÜ</SheetTitle>\n                        <div className=\"w-9\" />\n                    </div>\n                </SheetHeader>\n\n                {/* Content - EntryForm */}\n                <div className=\"overflow-y-auto h-full\">\n                    <EntryForm\n                        initialData={entry}\n                        onSubmit={handleSubmit}\n                        isSubmitting={isSubmitting}\n                        title=\"Á∑®ÈõÜ\"\n                        hideHeader={true}\n                    />\n                </div>\n            </SheetContent>\n        </Sheet>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/features/EntryForm.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'Input' is defined but never used.",
        "line": 10,
        "column": 10,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 10,
        "endColumn": 15
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'ENTRY_TAGS' is defined but never used.",
        "line": 15,
        "column": 10,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 15,
        "endColumn": 20
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'ja' is defined but never used.",
        "line": 17,
        "column": 10,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 17,
        "endColumn": 12
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 27,
        "column": 22,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 27,
        "endColumn": 25,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [1194, 1197], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [1194, 1197], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 279,
        "column": 79,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 279,
        "endColumn": 82,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [12106, 12109], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [12106, 12109], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 284,
        "column": 79,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 284,
        "endColumn": 82,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [12385, 12388], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [12385, 12388], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@next/next/no-img-element",
        "severity": 1,
        "message": "Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element",
        "line": 324,
        "column": 53,
        "nodeType": "JSXOpeningElement",
        "endLine": 324,
        "endColumn": 140
      },
      {
        "ruleId": "@next/next/no-img-element",
        "severity": 1,
        "message": "Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element",
        "line": 327,
        "column": 57,
        "nodeType": "JSXOpeningElement",
        "endLine": 327,
        "endColumn": 155
      },
      {
        "ruleId": "@next/next/no-img-element",
        "severity": 1,
        "message": "Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element",
        "line": 371,
        "column": 41,
        "nodeType": "JSXOpeningElement",
        "endLine": 371,
        "endColumn": 147
      }
    ],
    "suppressedMessages": [],
    "errorCount": 3,
    "fatalErrorCount": 0,
    "warningCount": 6,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useState, useRef, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { usePetContext } from '@/contexts/PetContext';\nimport { useImageUpload } from '@/hooks/useImageUpload';\nimport { useCustomTasks } from '@/hooks/useCustomTasks';\nimport { useFriends } from '@/hooks/useFriends';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Switch } from '@/components/ui/switch';\nimport { DatePickerDropdown } from '@/components/ui/date-picker-dropdown';\nimport { TimePickerInput } from '@/components/ui/time-picker-input';\nimport { ENTRY_TAGS, type EntryTag, type TimeType, type Entry } from '@/lib/types';\nimport { format } from 'date-fns';\nimport { ja } from 'date-fns/locale';\nimport { Clock, ImagePlus, X, ArrowLeft, Save, Loader2 } from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport { motion } from 'framer-motion';\nimport { toast } from 'sonner';\nimport { handleError } from '@/lib/errorHandler';\nimport { ImageCropper } from '@/components/ui/image-cropper';\n\ninterface EntryFormProps {\n    initialData?: Entry;\n    onSubmit: (data: any) => Promise<void>;\n    isSubmitting: boolean;\n    title: string;\n    hideHeader?: boolean;\n}\n\nexport function EntryForm({ initialData, onSubmit, isSubmitting, title: pageTitle, hideHeader }: EntryFormProps) {\n    const router = useRouter();\n    const { selectedPet } = usePetContext();\n    const { uploadEntryImage, uploading } = useImageUpload();\n    const { tasks } = useCustomTasks(selectedPet?.id || null);\n    const fileInputRef = useRef<HTMLInputElement>(null);\n\n    const [type, setType] = useState<'diary' | 'schedule'>('diary');\n    const [title, setTitle] = useState('');\n    const [body, setBody] = useState('');\n    const [tags, setTags] = useState<EntryTag[]>([]);\n    const [date, setDate] = useState<Date>(new Date());\n    const [time, setTime] = useState(format(new Date(), 'HH:mm'));\n    const [imageUrls, setImageUrls] = useState<string[]>([]);\n    const [friendIds, setFriendIds] = useState<string[]>([]);\n\n    const { friends } = useFriends(selectedPet?.id || null);\n\n    // ÁØÑÂõ≤Êó•ÊôÇÂØæÂøú\n    const [timeType, setTimeType] = useState<TimeType>('point');\n    const [endDate, setEndDate] = useState<Date>(new Date());\n    const [endTime, setEndTime] = useState(format(new Date(), 'HH:mm'));\n\n    // ÁîªÂÉè„ÇØ„É≠„ÉÉ„Éë„ÉºÁî®\n    const [cropperOpen, setCropperOpen] = useState(false);\n    const [originalImageSrc, setOriginalImageSrc] = useState<string | null>(null);\n\n    useEffect(() => {\n        if (initialData) {\n            setType(initialData.type);\n            setTitle(initialData.title || '');\n            setBody(initialData.body || '');\n            setTags(initialData.tags as EntryTag[]);\n\n            const entryDate = initialData.date.toDate();\n            setDate(entryDate);\n            setTime(format(entryDate, 'HH:mm'));\n\n            if (initialData.endDate) {\n                const end = initialData.endDate.toDate();\n                setEndDate(end);\n                setEndTime(format(end, 'HH:mm'));\n            }\n\n            setTimeType(initialData.timeType || 'point');\n            setImageUrls(initialData.imageUrls || []);\n            setFriendIds(initialData.friendIds || []);\n        }\n    }, [initialData]);\n\n    const toggleFriend = (friendId: string) => {\n        setFriendIds(prev => prev.includes(friendId)\n            ? prev.filter(id => id !== friendId)\n            : [...prev, friendId]\n        );\n    };\n\n    const toggleTag = (tag: EntryTag) => setTags((prev) => prev.includes(tag) ? prev.filter((t) => t !== tag) : [...prev, tag]);\n\n    const handleImageSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\n        if (!e.target.files?.[0]) return;\n\n        if (imageUrls.length >= 5) {\n            toast.error('ÁîªÂÉè„ÅØÊúÄÂ§ß5Êûö„Åæ„Åß„Åß„Åô');\n            return;\n        }\n\n        const file = e.target.files[0];\n        if (file.size > 10 * 1024 * 1024) {\n            toast.error('10MB‰ª•‰∏ã„ÅÆÁîªÂÉè„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ');\n            return;\n        }\n\n        const url = URL.createObjectURL(file);\n        setOriginalImageSrc(url);\n        setCropperOpen(true);\n        e.target.value = ''; // Reset\n    };\n\n    const handleCropComplete = async (croppedBlob: Blob) => {\n        setCropperOpen(false);\n        if (!selectedPet?.id) return;\n\n        try {\n            const file = new File([croppedBlob], \"entry-image.jpg\", { type: \"image/jpeg\" });\n            const url = await uploadEntryImage(file, selectedPet.id);\n            setImageUrls((prev) => [...prev, url]);\n            toast.success('ÁîªÂÉè„ÇíËøΩÂä†„Åó„Åæ„Åó„Åü');\n        } catch (error) {\n            handleError(error, { context: 'EntryForm.imageUpload', fallbackMessage: 'ÁîªÂÉè„ÅÆ„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü' });\n        } finally {\n            setOriginalImageSrc(null);\n        }\n    };\n\n    const handleCropCancel = () => {\n        setCropperOpen(false);\n        setOriginalImageSrc(null);\n    };\n\n    const handleRemoveImage = (index: number) => {\n        setImageUrls((prev) => prev.filter((_, i) => i !== index));\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n\n        const [hours, minutes] = time.split(':').map(Number);\n        const entryDate = new Date(date);\n        entryDate.setHours(hours, minutes, 0, 0);\n\n        let entryEndDate: Date | undefined;\n        if (timeType === 'range') {\n            const [endHours, endMinutes] = endTime.split(':').map(Number);\n            entryEndDate = new Date(endDate);\n            entryEndDate.setHours(endHours, endMinutes, 0, 0);\n        }\n\n        await onSubmit({\n            type,\n            timeType,\n            title: title.trim() || undefined,\n            body: body.trim() || undefined,\n            tags,\n            imageUrls,\n            friendIds,\n            date: entryDate,\n            endDate: entryEndDate,\n            isCompleted: initialData?.isCompleted, // Êó¢Â≠ò„ÅÆÂÆå‰∫ÜÁä∂ÊÖã„ÇíÁ∂≠ÊåÅ\n        });\n    };\n\n    // „Çø„Ç∞„É™„Çπ„Éà („Ç´„Çπ„Çø„É†„Çø„Çπ„ÇØ„Çí‰ΩøÁî®)\n    const uniqueTags = tasks.map(t => ({ value: t.name, label: t.name, emoji: t.emoji }));\n\n    return (\n\n\n        <div className=\"relative min-h-screen pt-4 pb-40 px-4\">\n            {/* Global Header Gradient */}\n            <div className=\"absolute top-0 left-0 right-0 h-[40vh] bg-gradient-to-b from-primary/20 via-primary/5 to-transparent -z-10 rounded-b-[4rem]\" />\n\n            {!hideHeader && (\n                <motion.div initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }}>\n                    {/* Header */}\n                    <div className=\"flex items-center justify-between mb-8\">\n                        <Button variant=\"ghost\" size=\"icon\" onClick={() => router.back()} className=\"rounded-full w-10 h-10 hover:bg-white/10 backdrop-blur-md\">\n                            <ArrowLeft className=\"w-6 h-6\" />\n                        </Button>\n                        <h1 className=\"text-lg font-bold tracking-wider uppercase text-muted-foreground/50\">{pageTitle}</h1>\n                        <div className=\"w-10\" />\n                    </div>\n                </motion.div>\n            )}\n\n            <motion.div initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }}>\n\n                <form onSubmit={handleSubmit} className=\"space-y-6 max-w-lg mx-auto\">\n                    {/* Type Switcher */}\n                    <div className=\"glass-capsule p-1.5 flex shadow-lg bg-white/30 dark:bg-black/30 backdrop-blur-xl border border-white/10\">\n                        <button\n                            type=\"button\"\n                            onClick={() => setType('diary')}\n                            className={cn(\n                                \"flex-1 py-3 rounded-full text-sm font-bold transition-all duration-300\",\n                                type === 'diary' ? \"bg-primary text-white shadow-lg shadow-primary/30\" : \"text-muted-foreground hover:text-foreground hover:bg-white/10\"\n                            )}\n                        >\n                            Êó•Ë®ò\n                        </button>\n                        <button\n                            type=\"button\"\n                            onClick={() => setType('schedule')}\n                            className={cn(\n                                \"flex-1 py-3 rounded-full text-sm font-bold transition-all duration-300\",\n                                type === 'schedule' ? \"bg-primary text-white shadow-lg shadow-primary/30\" : \"text-muted-foreground hover:text-foreground hover:bg-white/10\"\n                            )}\n                        >\n                            ‰∫àÂÆö\n                        </button>\n                    </div>\n                    <p className=\"text-xs text-muted-foreground text-center -mt-2 mb-2\">\n                        {type === 'diary' ? 'ÈÅéÂéª„ÅÆÂá∫Êù•‰∫ã„ÇíË®òÈå≤' : '„Åì„Çå„Åã„Çâ„ÅÆ‰∫àÂÆö„ÇíÁôªÈå≤'}\n                    </p>\n\n                    {/* Date & Time */}\n                    <div className=\"glass rounded-[2rem] p-4 sm:p-6 space-y-4 shadow-sm\">\n                        <div className=\"flex items-center justify-between text-muted-foreground mb-1\">\n                            <div className=\"flex items-center gap-2\">\n                                <Clock className=\"w-4 h-4\" />\n                                <span className=\"text-xs font-bold tracking-wider\">Êó•ÊôÇ</span>\n                            </div>\n                            <div className=\"flex items-center gap-2\">\n                                <Label htmlFor=\"time-type\" className=\"text-[10px] font-medium\">ÁØÑÂõ≤</Label>\n                                <Switch\n                                    id=\"time-type\"\n                                    checked={timeType === 'range'}\n                                    onCheckedChange={(checked) => setTimeType(checked ? 'range' : 'point')}\n                                    className=\"scale-75\"\n                                />\n                            </div>\n                        </div>\n\n                        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\n                            <DatePickerDropdown\n                                date={date}\n                                setDate={(d) => d && setDate(d)}\n                                label=\"ÈñãÂßãÊó•\"\n                                toDate={undefined}\n                            />\n                            <TimePickerInput\n                                time={time}\n                                setTime={setTime}\n                                label=\"ÊôÇÈñì\"\n                            />\n                        </div>\n\n                        {/* End Time for Range */}\n                        {timeType === 'range' && (\n                            <motion.div\n                                initial={{ height: 0, opacity: 0 }}\n                                animate={{ height: 'auto', opacity: 1 }}\n                                className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 pt-4 border-t border-white/10\"\n                            >\n                                <DatePickerDropdown\n                                    date={endDate}\n                                    setDate={(d) => d && setEndDate(d)}\n                                    label=\"ÁµÇ‰∫ÜÊó•\"\n                                    toDate={undefined}\n                                />\n                                <TimePickerInput\n                                    time={endTime}\n                                    setTime={setEndTime}\n                                    label=\"ÁµÇ‰∫ÜÊôÇÈñì\"\n                                />\n                            </motion.div>\n                        )}\n                    </div>\n\n                    {/* Tags */}\n                    <div className=\"glass rounded-[2rem] p-6 shadow-sm\">\n                        <div className=\"flex items-center gap-2 text-muted-foreground mb-4\">\n                            <span className=\"text-xs font-bold tracking-wider\">CATEGORY</span>\n                        </div>\n                        <div className=\"flex flex-wrap gap-2\">\n                            {uniqueTags.map((tag) => {\n                                const isSelected = tags.includes(tag.label as any);\n                                return (\n                                    <button\n                                        key={tag.value}\n                                        type=\"button\"\n                                        onClick={() => toggleTag(tag.label as any)}\n                                        className={cn(\n                                            \"flex items-center gap-1.5 px-4 py-2.5 rounded-2xl text-sm font-bold transition-all duration-300 border\",\n                                            isSelected\n                                                ? \"bg-primary text-white border-primary shadow-lg shadow-primary/25 scale-105\"\n                                                : \"bg-white/5 border-white/10 text-muted-foreground hover:bg-white/10 hover:border-white/20\"\n                                        )}\n                                    >\n                                        <span>{tag.emoji}</span>\n                                        <span>{tag.label}</span>\n                                    </button>\n                                );\n                            })}\n                        </div>\n                    </div>\n\n                    {/* Friends (Only for Diary) */}\n                    {type === 'diary' && friends.length > 0 && (\n                        <div className=\"glass rounded-[2rem] p-6 shadow-sm\">\n                            <div className=\"flex items-center gap-2 text-muted-foreground mb-4\">\n                                <span className=\"text-xs font-bold tracking-wider\">WALKING FRIENDS</span>\n                            </div>\n                            <div className=\"flex overflow-x-auto pb-2 gap-3 no-scrollbar\">\n                                {friends.map((friend) => {\n                                    const isSelected = friendIds.includes(friend.id);\n                                    return (\n                                        <button\n                                            key={friend.id}\n                                            type=\"button\"\n                                            onClick={() => toggleFriend(friend.id)}\n                                            className={cn(\n                                                \"flex flex-col items-center gap-2 min-w-[4rem] transition-all duration-300\",\n                                                isSelected ? \"scale-105\" : \"opacity-60 grayscale hover:opacity-100 hover:grayscale-0\"\n                                            )}\n                                        >\n                                            <div className={cn(\n                                                \"w-14 h-14 rounded-full overflow-hidden border-2 transition-colors\",\n                                                isSelected ? \"border-primary shadow-lg shadow-primary/25\" : \"border-transparent\"\n                                            )}>\n                                                {friend.images?.[0] ? (\n                                                    <img src={friend.images[0]} alt={friend.name} className=\"w-full h-full object-cover\" />\n                                                ) : (\n                                                    <div className=\"w-full h-full bg-muted flex items-center justify-center\">\n                                                        <img src=\"/ogp.webp\" alt=\"No image\" className=\"w-full h-full object-cover opacity-50 grayscale\" />\n                                                    </div>\n                                                )}\n                                            </div>\n                                            <span className={cn(\n                                                \"text-xs font-bold truncate w-full text-center\",\n                                                isSelected ? \"text-primary\" : \"text-muted-foreground\"\n                                            )}>\n                                                {friend.name}\n                                            </span>\n                                        </button>\n                                    );\n                                })}\n                            </div>\n                        </div>\n                    )}\n\n                    {/* Content */}\n                    <div className=\"glass rounded-[2rem] p-6 space-y-6 shadow-sm\">\n                        <div className=\"space-y-4\">\n                            <input\n                                placeholder=\"„Çø„Ç§„Éà„É´„ÇíÂÖ•Âäõ\"\n                                value={title}\n                                onChange={(e) => setTitle(e.target.value)}\n                                className=\"w-full bg-transparent border-0 border-b border-white/10 rounded-none text-xl font-bold px-0 focus:ring-0 focus:border-primary placeholder:text-muted-foreground/30 py-2 transition-colors\"\n                            />\n                            <textarea\n                                placeholder=\"Ë©≥Á¥∞„ÇíÂÖ•Âäõ...\"\n                                value={body}\n                                onChange={(e) => setBody(e.target.value)}\n                                rows={5}\n                                className=\"w-full bg-transparent border-none text-base resize-none outline-none placeholder:text-muted-foreground/30 leading-relaxed\"\n                            />\n                        </div>\n\n                        {/* Images Grid */}\n                        <div>\n                            <div className=\"flex items-center justify-between mb-3\">\n                                <span className=\"text-xs font-bold text-muted-foreground tracking-wider\">PHOTOS</span>\n                                <span className=\"text-[10px] text-muted-foreground/50\">{imageUrls.length}/5</span>\n                            </div>\n                            <div className=\"grid grid-cols-4 gap-2\">\n                                {imageUrls.map((url, i) => (\n                                    <div key={i} className=\"relative aspect-square rounded-xl overflow-hidden group\">\n                                        <img src={url} alt=\"\" className=\"w-full h-full object-cover transition-transform group-hover:scale-110\" />\n                                        <button\n                                            type=\"button\"\n                                            onClick={() => handleRemoveImage(i)}\n                                            className=\"absolute top-1 right-1 w-6 h-6 rounded-full bg-black/50 flex items-center justify-center hover:bg-destructive transition-colors backdrop-blur-sm\"\n                                        >\n                                            <X className=\"w-3 h-3 text-white\" />\n                                        </button>\n                                    </div>\n                                ))}\n                                {imageUrls.length < 5 && (\n                                    <button\n                                        type=\"button\"\n                                        className=\"aspect-square rounded-xl border-2 border-dashed border-white/20 flex flex-col items-center justify-center hover:border-primary/50 hover:bg-primary/5 transition-all gap-1 group disabled:opacity-50\"\n                                        onClick={() => fileInputRef.current?.click()}\n                                        disabled={uploading}\n                                    >\n                                        {uploading ? (\n                                            <Loader2 className=\"w-6 h-6 text-primary animate-spin\" />\n                                        ) : (\n                                            <ImagePlus className=\"w-6 h-6 text-muted-foreground group-hover:text-primary transition-colors\" />\n                                        )}\n                                    </button>\n                                )}\n                            </div>\n                            <input ref={fileInputRef} type=\"file\" accept=\"image/*\" className=\"hidden\" onChange={handleImageSelect} />\n                        </div>\n                    </div>\n\n                    {/* Sticky Save Button */}\n                    <div className=\"sticky bottom-24 z-20 pt-4 mx-auto max-w-sm\">\n                        {tags.length === 0 && (\n                            <p className=\"text-xs text-destructive text-center mb-2\">\n                                „Ç´„ÉÜ„Ç¥„É™„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ\n                            </p>\n                        )}\n                        <Button\n                            type=\"submit\"\n                            disabled={isSubmitting || tags.length === 0 || uploading}\n                            className=\"rounded-full gradient-primary shadow-2xl w-full h-14 text-lg font-bold hover:scale-105 active:scale-95 transition-all\"\n                        >\n                            {isSubmitting ? <Loader2 className=\"w-6 h-6 animate-spin\" /> : <Save className=\"w-6 h-6 mr-2\" />}\n                            ‰øùÂ≠ò„Åô„Çã\n                        </Button>\n                    </div>\n                </form>\n            </motion.div>\n\n\n            <ImageCropper\n                open={cropperOpen}\n                imageSrc={originalImageSrc}\n                onCropComplete={handleCropComplete}\n                onCancel={handleCropCancel}\n            />\n        </div>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/features/EntryNewSheet.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 11,
        "column": 20,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 11,
        "endColumn": 23,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [340, 343], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [340, 343], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 23,
        "column": 39,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 23,
        "endColumn": 42,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [608, 611], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [608, 611], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 2,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { Sheet, SheetContent, SheetHeader, SheetTitle } from '@/components/ui/sheet';\nimport { Button } from '@/components/ui/button';\nimport { X } from 'lucide-react';\nimport { EntryForm } from '@/components/features/EntryForm';\n\ninterface EntryNewSheetProps {\n    open: boolean;\n    onClose: () => void;\n    onSave: (data: any) => Promise<void>;\n    isSubmitting: boolean;\n    initialType?: 'diary' | 'schedule';\n}\n\nexport function EntryNewSheet({\n    open,\n    onClose,\n    onSave,\n    isSubmitting,\n    initialType = 'diary',\n}: EntryNewSheetProps) {\n    const handleSubmit = async (data: any) => {\n        await onSave(data);\n        onClose();\n    };\n\n    return (\n        <Sheet open={open} onOpenChange={(isOpen) => !isOpen && onClose()}>\n            <SheetContent side=\"bottom\" className=\"h-[95vh] rounded-t-3xl bg-background/95 backdrop-blur-xl border-t border-white/20 p-0 overflow-hidden\">\n                {/* Header */}\n                <SheetHeader className=\"sticky top-0 z-10 bg-background/80 backdrop-blur-md border-b border-white/10 px-4 py-3\">\n                    <div className=\"flex items-center justify-between\">\n                        <Button variant=\"ghost\" size=\"icon\" onClick={onClose} className=\"rounded-full w-9 h-9\">\n                            <X className=\"w-5 h-5\" />\n                        </Button>\n                        <SheetTitle className=\"text-sm font-bold\">\n                            {initialType === 'diary' ? 'Êó•Ë®ò„ÇíË®òÈå≤' : '‰∫àÂÆö„ÇíËøΩÂä†'}\n                        </SheetTitle>\n                        <div className=\"w-9\" /> {/* Spacer */}\n                    </div>\n                </SheetHeader>\n\n                {/* Content - EntryForm */}\n                <div className=\"overflow-y-auto h-full\">\n                    <EntryForm\n                        onSubmit={handleSubmit}\n                        isSubmitting={isSubmitting}\n                        hideHeader={true}\n                        title={initialType === 'diary' ? 'Êó•Ë®ò„ÇíË®òÈå≤' : '‰∫àÂÆö„ÇíËøΩÂä†'}\n                    />\n                </div>\n            </SheetContent>\n        </Sheet>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/features/FriendDetailSheet.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'motion' is defined but never used.",
        "line": 10,
        "column": 10,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 10,
        "endColumn": 16
      }
    ],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 1,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useState } from 'react';\nimport { Sheet, SheetContent, SheetHeader, SheetTitle } from '@/components/ui/sheet';\nimport { Button } from '@/components/ui/button';\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger } from '@/components/ui/alert-dialog';\nimport { format, differenceInYears } from 'date-fns';\nimport { ja } from 'date-fns/locale';\nimport { Trash2, Edit, MapPin, Calendar, Scale, Cake, User, Phone, Home, X } from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { toast } from 'sonner';\nimport { Friend } from '@/lib/types';\nimport Image from 'next/image';\n\ninterface FriendDetailSheetProps {\n    friend: Friend | null;\n    open: boolean;\n    onClose: () => void;\n    onEdit: () => void;\n    onDelete: (id: string) => Promise<void>;\n    canEdit: boolean;\n}\n\nexport function FriendDetailSheet({\n    friend,\n    open,\n    onClose,\n    onEdit,\n    onDelete,\n    canEdit,\n}: FriendDetailSheetProps) {\n    const [isDeleting, setIsDeleting] = useState(false);\n\n    if (!friend) return null;\n\n    const age = friend.birthday ? differenceInYears(new Date(), friend.birthday.toDate()) : null;\n\n    const handleDelete = async () => {\n        setIsDeleting(true);\n        try {\n            await onDelete(friend.id);\n            toast.success('ÂâäÈô§„Åó„Åæ„Åó„Åü');\n            onClose();\n        } catch {\n            toast.error('„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü');\n        } finally {\n            setIsDeleting(false);\n        }\n    };\n\n    return (\n        <Sheet open={open} onOpenChange={(isOpen) => !isOpen && onClose()}>\n            <SheetContent side=\"bottom\" className=\"h-[90vh] rounded-t-3xl bg-background/95 backdrop-blur-xl border-t border-white/20 p-0 overflow-hidden\">\n                {/* Header */}\n                <SheetHeader className=\"sticky top-0 z-10 bg-background/80 backdrop-blur-md border-b border-white/10 px-4 py-3\">\n                    <div className=\"flex items-center justify-between\">\n                        <Button variant=\"ghost\" size=\"icon\" onClick={onClose} className=\"rounded-full w-9 h-9\">\n                            <X className=\"w-5 h-5\" />\n                        </Button>\n                        <SheetTitle className=\"text-sm font-bold\">„ÅäÂèãÈÅî„ÅÆË©≥Á¥∞</SheetTitle>\n                        <div className=\"flex gap-1\">\n                            {canEdit && (\n                                <>\n                                    <Button variant=\"ghost\" size=\"icon\" onClick={onEdit} className=\"rounded-full w-9 h-9 text-muted-foreground hover:text-foreground\">\n                                        <Edit className=\"w-4 h-4\" />\n                                    </Button>\n                                    <AlertDialog>\n                                        <AlertDialogTrigger asChild>\n                                            <Button variant=\"ghost\" size=\"icon\" className=\"rounded-full w-9 h-9 text-muted-foreground hover:text-destructive\">\n                                                <Trash2 className=\"w-4 h-4\" />\n                                            </Button>\n                                        </AlertDialogTrigger>\n                                        <AlertDialogContent className=\"glass border-white/20\">\n                                            <AlertDialogHeader>\n                                                <AlertDialogTitle>„ÅäÂèãÈÅî„ÇíÂâäÈô§</AlertDialogTitle>\n                                                <AlertDialogDescription>\n                                                    Êú¨ÂΩì„Å´„Åì„ÅÆ„ÅäÂèãÈÅî„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü„Åì„ÅÆÊìç‰Ωú„ÅØÂèñ„ÇäÊ∂à„Åõ„Åæ„Åõ„Çì„ÄÇ\n                                                </AlertDialogDescription>\n                                            </AlertDialogHeader>\n                                            <AlertDialogFooter>\n                                                <AlertDialogCancel className=\"rounded-full\">„Ç≠„É£„É≥„Çª„É´</AlertDialogCancel>\n                                                <AlertDialogAction onClick={handleDelete} disabled={isDeleting} className=\"bg-destructive text-destructive-foreground rounded-full hover:bg-destructive/90\">\n                                                    ÂâäÈô§\n                                                </AlertDialogAction>\n                                            </AlertDialogFooter>\n                                        </AlertDialogContent>\n                                    </AlertDialog>\n                                </>\n                            )}\n                        </div>\n                    </div>\n                </SheetHeader>\n\n                <div className=\"overflow-y-auto h-full pb-20 px-4 py-6 space-y-6\">\n                    {/* Hero Section */}\n                    <div className=\"relative aspect-square w-full bg-muted overflow-hidden rounded-3xl shadow-lg ring-1 ring-white/20\">\n                        {friend.images?.[0] ? (\n                            <Image src={friend.images[0]} alt={friend.name} fill className=\"object-cover\" />\n                        ) : (\n                            <div className=\"w-full h-full flex items-center justify-center bg-primary/10\">\n                                <Image src=\"/ogp.webp\" alt=\"No image\" width={128} height={128} className=\"object-contain opacity-20 grayscale\" />\n                            </div>\n                        )}\n                        <div className=\"absolute inset-x-0 bottom-0 p-6 bg-gradient-to-t from-black/80 via-black/20 to-transparent text-white\">\n                            <div className=\"flex items-center gap-2 mb-2\">\n                                <span className=\"px-3 py-1 rounded-full bg-white/20 backdrop-blur-md text-[10px] font-bold border border-white/10 uppercase tracking-wider\">\n                                    {friend.breed || 'Áä¨Á®Æ‰∏çÊòé'}\n                                </span>\n                                {friend.gender !== 'unknown' && (\n                                    <span className={`w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-bold ${friend.gender === 'male' ? 'bg-blue-500/80' : 'bg-red-500/80'}`}>\n                                        {friend.gender === 'male' ? '‚ôÇ' : '‚ôÄ'}\n                                    </span>\n                                )}\n                            </div>\n                            <h1 className=\"text-3xl font-black tracking-tight\">{friend.name}</h1>\n                        </div>\n                    </div>\n\n                    {/* Basic Info Stats */}\n                    <div className=\"grid grid-cols-2 gap-3\">\n                        {friend.weight && (\n                            <div className=\"glass p-4 rounded-2xl flex items-center gap-3\">\n                                <div className=\"w-10 h-10 rounded-full bg-blue-500/10 flex items-center justify-center text-blue-600\">\n                                    <Scale className=\"w-5 h-5\" />\n                                </div>\n                                <div>\n                                    <p className=\"text-[10px] text-muted-foreground font-bold uppercase tracking-wider\">‰ΩìÈáç</p>\n                                    <p className=\"font-bold\">{friend.weight}{friend.weightUnit}</p>\n                                </div>\n                            </div>\n                        )}\n                        {(age !== null || friend.birthday) && (\n                            <div className=\"glass p-4 rounded-2xl flex items-center gap-3\">\n                                <div className=\"w-10 h-10 rounded-full bg-pink-500/10 flex items-center justify-center text-pink-600\">\n                                    <Cake className=\"w-5 h-5\" />\n                                </div>\n                                <div>\n                                    <p className=\"text-[10px] text-muted-foreground font-bold uppercase tracking-wider\">Âπ¥ÈΩ¢</p>\n                                    <p className=\"font-bold\">{age !== null ? `${age}Ê≠≥` : '‰∏çÊòé'}</p>\n                                </div>\n                            </div>\n                        )}\n                    </div>\n\n                    {/* Encounter Info */}\n                    <div className=\"glass rounded-3xl p-6 shadow-xl border-white/20 space-y-4\">\n                        <div className=\"flex items-center gap-3\">\n                            <div className=\"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center text-primary\">\n                                <Calendar className=\"w-5 h-5\" />\n                            </div>\n                            <div>\n                                <p className=\"text-xs text-muted-foreground font-bold uppercase tracking-wider\">Âá∫‰ºö„Å£„ÅüÊó•</p>\n                                <p className=\"font-bold\">{format(friend.metAt.toDate(), 'yyyyÂπ¥MÊúàdÊó• (E)', { locale: ja })}</p>\n                            </div>\n                        </div>\n\n                        {friend.location && (\n                            <div className=\"flex items-center gap-3\">\n                                <div className=\"w-10 h-10 rounded-full bg-green-500/10 flex items-center justify-center text-green-600\">\n                                    <MapPin className=\"w-5 h-5\" />\n                                </div>\n                                <div>\n                                    <p className=\"text-xs text-muted-foreground font-bold uppercase tracking-wider\">Âá∫‰ºö„Å£„ÅüÂ†¥ÊâÄ</p>\n                                    <p className=\"font-bold\">{friend.location}</p>\n                                </div>\n                            </div>\n                        )}\n                    </div>\n\n                    {/* Owner Info */}\n                    {(friend.ownerName || friend.ownerDetails || friend.contact || friend.address) && (\n                        <div className=\"space-y-3\">\n                            <h3 className=\"font-bold text-sm text-muted-foreground flex items-center gap-2 px-2 uppercase tracking-widest\">\n                                <User className=\"w-4 h-4\" /> È£º„ÅÑ‰∏ªÊÉÖÂ†±\n                            </h3>\n                            <div className=\"glass rounded-2xl p-5 text-sm leading-relaxed border-white/20 space-y-3 shadow-lg\">\n                                {friend.ownerName && (\n                                    <div className=\"flex items-start gap-3\">\n                                        <span className=\"font-bold min-w-[4rem] text-muted-foreground\">„ÅäÂêçÂâç</span>\n                                        <span className=\"font-medium text-foreground\">{friend.ownerName}</span>\n                                    </div>\n                                )}\n                                {friend.ownerDetails && (\n                                    <div className=\"flex items-start gap-3\">\n                                        <span className=\"font-bold min-w-[4rem] text-muted-foreground\">ÁâπÂæ¥</span>\n                                        <span className=\"font-medium text-foreground\">{friend.ownerDetails}</span>\n                                    </div>\n                                )}\n                                {friend.contact && (\n                                    <div className=\"flex items-start gap-3\">\n                                        <Phone className=\"w-4 h-4 text-primary/60 flex-shrink-0 mt-0.5\" />\n                                        <span className=\"font-medium text-foreground\">{friend.contact}</span>\n                                    </div>\n                                )}\n                                {friend.address && (\n                                    <div className=\"flex items-start gap-3\">\n                                        <Home className=\"w-4 h-4 text-primary/60 flex-shrink-0 mt-0.5\" />\n                                        <span className=\"font-medium text-foreground\">{friend.address}</span>\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                    )}\n\n                    {/* Features/Memo */}\n                    {friend.features && (\n                        <div className=\"space-y-3\">\n                            <h3 className=\"font-bold text-sm text-muted-foreground px-2 uppercase tracking-widest\">„É°„É¢„ÉªÁâπÂæ¥</h3>\n                            <div className=\"glass rounded-2xl p-5 text-sm leading-relaxed border-white/20 shadow-lg whitespace-pre-wrap font-medium\">\n                                {friend.features}\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </SheetContent>\n        </Sheet>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/features/FriendFormSheet.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'Scale' is defined but never used.",
        "line": 11,
        "column": 49,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 11,
        "endColumn": 54
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 22,
        "column": 20,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 22,
        "endColumn": 23,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [1065, 1068], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [1065, 1068], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "react-hooks/set-state-in-effect",
        "severity": 2,
        "message": "Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/features/FriendFormSheet.tsx:82:13\n  80 |     useEffect(() => {\n  81 |         if (friend && open) {\n> 82 |             setName(friend.name);\n     |             ^^^^^^^ Avoid calling setState() directly within an effect\n  83 |             setSpecies(friend.species || 'Canis lupus familiaris');\n  84 |             setBreed(friend.breed || '');\n  85 |             setGender(friend.gender || 'unknown');",
        "line": 82,
        "column": 13,
        "nodeType": null,
        "endLine": 82,
        "endColumn": 20
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 237,
        "column": 102,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 237,
        "endColumn": 105,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [9873, 9876], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [9873, 9876], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 3,
    "fatalErrorCount": 0,
    "warningCount": 1,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useState, useEffect, useMemo } from 'react';\nimport { Sheet, SheetContent, SheetHeader, SheetTitle } from '@/components/ui/sheet';\nimport { Button } from '@/components/ui/button';\nimport { Label } from '@/components/ui/label';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { DatePickerDropdown } from '@/components/ui/date-picker-dropdown';\nimport { StyledInput, SpeciesBreedSelector, GenderSelect, ColorSelect } from '@/components/ui/styled-form-fields';\nimport { PetAvatarEditor } from '@/components/features/pet-avatar-editor';\nimport { X, Loader2, MapPin, User, Phone, Home, Scale, Calendar as CalendarIcon, Heart } from 'lucide-react';\nimport { Timestamp } from 'firebase/firestore';\nimport { format } from 'date-fns';\nimport { useImageUpload } from '@/hooks/useImageUpload';\nimport { Friend } from '@/lib/types';\nimport { toast } from 'sonner';\n\ninterface FriendFormSheetProps {\n    friend?: Friend | null;\n    open: boolean;\n    onClose: () => void;\n    onSave: (data: any) => Promise<void>;\n    isSubmitting: boolean;\n    petId: string;\n}\n\nexport function FriendFormSheet({\n    friend,\n    open,\n    onClose,\n    onSave,\n    isSubmitting: isExternalSubmitting,\n    petId,\n}: FriendFormSheetProps) {\n    const { uploadImage, uploading } = useImageUpload();\n\n    // Basic Info\n    const [name, setName] = useState('');\n    const [species, setSpecies] = useState('Canis lupus familiaris');\n    const [breed, setBreed] = useState('');\n    const [gender, setGender] = useState<'male' | 'female' | 'unknown'>('unknown');\n    const [color, setColor] = useState('');\n\n    // Age/Birthday Logic\n    const [birthdayMode, setBirthdayMode] = useState<'birthday' | 'age'>('birthday');\n    const [birthday, setBirthday] = useState<Date | undefined>(undefined);\n    const [ageYears, setAgeYears] = useState('');\n    const [ageMonths, setAgeMonths] = useState('');\n\n    const calculatedBirthday = useMemo(() => {\n        if (birthdayMode !== 'age') return undefined;\n        if (!ageYears && !ageMonths) return undefined;\n        const now = new Date();\n        const years = parseInt(ageYears || '0');\n        const months = parseInt(ageMonths || '0');\n        const d = new Date(now);\n        d.setFullYear(d.getFullYear() - years);\n        d.setMonth(d.getMonth() - months);\n        return d;\n    }, [birthdayMode, ageYears, ageMonths]);\n\n    const [weight, setWeight] = useState('');\n    const [weightUnit, setWeightUnit] = useState<'kg' | 'g'>('kg');\n\n    // Meeting Info\n    const [metAt, setMetAt] = useState<Date>(new Date());\n    const [location, setLocation] = useState('');\n    const [memo, setMemo] = useState('');\n\n    // Owner Info\n    const [ownerName, setOwnerName] = useState('');\n    const [ownerDetails, setOwnerDetails] = useState('');\n    const [contact, setContact] = useState('');\n    const [address, setAddress] = useState('');\n\n    // Image state\n    const [pendingImageFile, setPendingImageFile] = useState<File | null>(null);\n    const [previewUrl, setPreviewUrl] = useState<string | null>(null);\n\n    useEffect(() => {\n        if (friend && open) {\n            setName(friend.name);\n            setSpecies(friend.species || 'Canis lupus familiaris');\n            setBreed(friend.breed || '');\n            setGender(friend.gender || 'unknown');\n            setColor(friend.color || '');\n            setBirthday(friend.birthday?.toDate());\n            setBirthdayMode('birthday');\n            setWeight(friend.weight?.toString() || '');\n            setWeightUnit(friend.weightUnit || 'kg');\n            setMetAt(friend.metAt.toDate());\n            setLocation(friend.location || '');\n            setMemo(friend.features || '');\n            setOwnerName(friend.ownerName || '');\n            setOwnerDetails(friend.ownerDetails || '');\n            setContact(friend.contact || '');\n            setAddress(friend.address || '');\n            setPreviewUrl(friend.images?.[0] || null);\n            setPendingImageFile(null);\n        } else if (open) {\n            // Reset for new friend\n            setName('');\n            setSpecies('Canis lupus familiaris');\n            setBreed('');\n            setGender('unknown');\n            setColor('');\n            setBirthday(undefined);\n            setBirthdayMode('birthday');\n            setWeight('');\n            setWeightUnit('kg');\n            setMetAt(new Date());\n            setLocation('');\n            setMemo('');\n            setOwnerName('');\n            setOwnerDetails('');\n            setContact('');\n            setAddress('');\n            setPreviewUrl(null);\n            setPendingImageFile(null);\n        }\n    }, [friend, open]);\n\n    const handleImageChange = (file: File) => {\n        setPendingImageFile(file);\n        setPreviewUrl(URL.createObjectURL(file));\n    };\n\n    const handleRemoveImage = () => {\n        setPendingImageFile(null);\n        setPreviewUrl(null);\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!name) { toast.error('„ÅäÂêçÂâç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ'); return; }\n\n        try {\n            let finalImageUrl = previewUrl || '';\n            if (pendingImageFile) {\n                finalImageUrl = await uploadImage(pendingImageFile, `pets/${petId}/friends`, {\n                    maxSizeMB: 1,\n                    maxWidthOrHeight: 1200,\n                    fileType: 'image/webp'\n                });\n            }\n\n            const data = {\n                name,\n                species,\n                breed,\n                gender,\n                color,\n                location,\n                features: memo,\n                images: finalImageUrl ? [finalImageUrl] : [],\n                metAt: metAt,\n                birthday: birthdayMode === 'age'\n                    ? (calculatedBirthday ? Timestamp.fromDate(calculatedBirthday) : undefined)\n                    : (birthday ? Timestamp.fromDate(birthday) : undefined),\n                weight: weight ? parseFloat(weight) : undefined,\n                weightUnit: weight ? weightUnit : undefined,\n                ownerName,\n                ownerDetails,\n                contact,\n                address,\n            };\n\n            await onSave(data);\n            onClose();\n        } catch (err) {\n            console.error(err);\n            toast.error('„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü');\n        }\n    };\n\n    const isSubmitting = isExternalSubmitting || uploading;\n\n    return (\n        <Sheet open={open} onOpenChange={(isOpen) => !isOpen && onClose()}>\n            <SheetContent side=\"bottom\" className=\"h-[95vh] rounded-t-3xl bg-background/95 backdrop-blur-xl border-t border-white/20 p-0 overflow-hidden\">\n                {/* Header */}\n                <SheetHeader className=\"sticky top-0 z-10 bg-background/80 backdrop-blur-md border-b border-white/10 px-4 py-3\">\n                    <div className=\"flex items-center justify-between\">\n                        <Button variant=\"ghost\" size=\"icon\" onClick={onClose} className=\"rounded-full w-9 h-9\">\n                            <X className=\"w-5 h-5\" />\n                        </Button>\n                        <SheetTitle className=\"text-sm font-bold\">\n                            {friend ? '„ÅäÂèãÈÅî„ÇíÁ∑®ÈõÜ' : '„ÅäÂèãÈÅî„ÇíÁôªÈå≤'}\n                        </SheetTitle>\n                        <div className=\"w-9\" />\n                    </div>\n                </SheetHeader>\n\n                <div className=\"overflow-y-auto h-full pb-32\">\n                    <form onSubmit={handleSubmit} className=\"px-6 py-8 space-y-10\">\n                        {/* Image Upload */}\n                        <div className=\"flex justify-center\">\n                            <PetAvatarEditor\n                                imageUrl={previewUrl}\n                                onImageChange={handleImageChange}\n                                onImageRemove={handleRemoveImage}\n                                disabled={isSubmitting}\n                            />\n                        </div>\n\n                        {/* Basic Info Section */}\n                        <section className=\"space-y-6\">\n                            <h2 className=\"text-xs font-bold text-muted-foreground border-b pb-2 flex items-center gap-2 uppercase tracking-widest\">\n                                <Heart className=\"w-3.5 h-3.5\" /> Âü∫Êú¨ÊÉÖÂ†±\n                            </h2>\n\n                            <div className=\"space-y-4\">\n                                <div className=\"space-y-2\">\n                                    <Label htmlFor=\"name\" className=\"text-xs font-bold ml-1\">„ÅäÂêçÂâç <span className=\"text-red-500\">*</span></Label>\n                                    <StyledInput\n                                        id=\"name\"\n                                        value={name}\n                                        onChange={e => setName(e.target.value)}\n                                        placeholder=\"„Éù„ÉÅ\"\n                                        className=\"h-14 text-xl font-bold rounded-2xl\"\n                                    />\n                                </div>\n\n                                <SpeciesBreedSelector\n                                    species={species}\n                                    breed={breed}\n                                    onChangeSpecies={(val) => {\n                                        setSpecies(val);\n                                        setBreed('');\n                                    }}\n                                    onChangeBreed={setBreed}\n                                />\n\n                                <div className=\"grid grid-cols-2 gap-4\">\n                                    <div className=\"space-y-2\">\n                                        <Label className=\"text-xs font-bold ml-1\">ÊÄßÂà•</Label>\n                                        <GenderSelect value={gender} onChange={(v) => setGender(v as any)} type=\"friend\" />\n                                    </div>\n                                    <div className=\"space-y-2\">\n                                        <Label className=\"text-xs font-bold ml-1\">ÊØõËâ≤</Label>\n                                        <ColorSelect value={color} onChange={setColor} />\n                                    </div>\n                                </div>\n\n                                <div className=\"space-y-4 pt-2\">\n                                    <Label className=\"text-xs font-bold ml-1\">Âπ¥ÈΩ¢„ÉªË™ïÁîüÊó•</Label>\n                                    <div className=\"space-y-6\">\n                                        <div className=\"flex bg-muted/30 p-1.5 rounded-2xl glass border border-white/10\">\n                                            <button\n                                                type=\"button\"\n                                                className={`flex-1 py-2 text-sm rounded-xl transition-all ${birthdayMode === 'birthday' ? 'bg-background shadow-lg font-bold text-primary border border-white/20' : 'text-muted-foreground'}`}\n                                                onClick={() => setBirthdayMode('birthday')}\n                                            >\n                                                Ë™ïÁîüÊó•\n                                            </button>\n                                            <button\n                                                type=\"button\"\n                                                className={`flex-1 py-2 text-sm rounded-xl transition-all ${birthdayMode === 'age' ? 'bg-background shadow-lg font-bold text-primary border border-white/20' : 'text-muted-foreground'}`}\n                                                onClick={() => setBirthdayMode('age')}\n                                            >\n                                                Âπ¥ÈΩ¢„Åã„Çâ\n                                            </button>\n                                        </div>\n\n                                        {birthdayMode === 'birthday' ? (\n                                            <DatePickerDropdown\n                                                date={birthday}\n                                                setDate={setBirthday}\n                                                className=\"w-full\"\n                                                toDate={new Date()}\n                                            />\n                                        ) : (\n                                            <div className=\"space-y-4\">\n                                                <div className=\"grid grid-cols-2 gap-4\">\n                                                    <div className=\"space-y-2\">\n                                                        <Label className=\"text-[10px] uppercase font-bold text-muted-foreground ml-1\">‰ΩïÊ≠≥Ôºü</Label>\n                                                        <div className=\"relative\">\n                                                            <StyledInput\n                                                                type=\"number\"\n                                                                min=\"0\"\n                                                                value={ageYears}\n                                                                onChange={e => setAgeYears(e.target.value)}\n                                                                className=\"h-12 pr-10 rounded-xl\"\n                                                            />\n                                                            <span className=\"absolute right-4 top-1/2 -translate-y-1/2 text-sm font-bold text-muted-foreground\">Ê≠≥</span>\n                                                        </div>\n                                                    </div>\n                                                    <div className=\"space-y-2\">\n                                                        <Label className=\"text-[10px] uppercase font-bold text-muted-foreground ml-1\">‰Ωï„É∂ÊúàÔºü</Label>\n                                                        <div className=\"relative\">\n                                                            <StyledInput\n                                                                type=\"number\"\n                                                                min=\"0\"\n                                                                max=\"11\"\n                                                                value={ageMonths}\n                                                                onChange={e => setAgeMonths(e.target.value)}\n                                                                className=\"h-12 pr-14 rounded-xl\"\n                                                            />\n                                                            <span className=\"absolute right-4 top-1/2 -translate-y-1/2 text-sm font-bold text-muted-foreground\">„É∂Êúà</span>\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                                {calculatedBirthday && (\n                                                    <p className=\"text-[10px] text-center text-muted-foreground font-medium bg-primary/5 py-2 rounded-lg\">\n                                                        Êé®ÂÆöË™ïÁîüÊó•: {format(calculatedBirthday, 'yyyy/M/d')}\n                                                    </p>\n                                                )}\n                                            </div>\n                                        )}\n                                    </div>\n                                </div>\n\n                                <div className=\"space-y-2 pt-2\">\n                                    <Label className=\"text-xs font-bold ml-1\">‰ΩìÈáç</Label>\n                                    <div className=\"flex gap-3\">\n                                        <StyledInput\n                                            type=\"number\"\n                                            step=\"0.01\"\n                                            value={weight}\n                                            onChange={e => setWeight(e.target.value)}\n                                            placeholder=\"0.00\"\n                                            className=\"h-14 flex-1 rounded-2xl\"\n                                        />\n                                        <Select value={weightUnit} onValueChange={(v: 'kg' | 'g') => setWeightUnit(v)}>\n                                            <SelectTrigger className=\"w-24 h-14 rounded-2xl bg-white/50 border-white/20 text-lg font-bold\">\n                                                <SelectValue />\n                                            </SelectTrigger>\n                                            <SelectContent>\n                                                <SelectItem value=\"kg\">kg</SelectItem>\n                                                <SelectItem value=\"g\">g</SelectItem>\n                                            </SelectContent>\n                                        </Select>\n                                    </div>\n                                </div>\n                            </div>\n                        </section>\n\n                        {/* Encounter Info Section */}\n                        <section className=\"space-y-6\">\n                            <h2 className=\"text-xs font-bold text-muted-foreground border-b pb-2 flex items-center gap-2 uppercase tracking-widest\">\n                                <CalendarIcon className=\"w-3.5 h-3.5\" /> Âá∫‰ºö„ÅÑ„ÅÆË®òÈå≤\n                            </h2>\n                            <div className=\"space-y-4\">\n                                <DatePickerDropdown\n                                    date={metAt}\n                                    setDate={d => d && setMetAt(d)}\n                                    label=\"Âá∫‰ºö„Å£„ÅüÊó•\"\n                                    className=\"w-full\"\n                                    toDate={new Date()}\n                                />\n\n                                <div className=\"space-y-2\">\n                                    <Label className=\"text-xs font-bold ml-1\">Âá∫‰ºö„Å£„ÅüÂ†¥ÊâÄ</Label>\n                                    <div className=\"relative\">\n                                        <MapPin className=\"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground z-10\" />\n                                        <StyledInput\n                                            value={location}\n                                            onChange={e => setLocation(e.target.value)}\n                                            placeholder=\"ÂÖ¨Âúí„ÄÅ„Éâ„ÉÉ„Ç∞„É©„É≥„Å™„Å©\"\n                                            className=\"pl-11 h-12 rounded-xl\"\n                                        />\n                                    </div>\n                                </div>\n\n                                <div className=\"space-y-2\">\n                                    <Label className=\"text-xs font-bold ml-1\">ÁâπÂæ¥„Éª„É°„É¢</Label>\n                                    <textarea\n                                        value={memo}\n                                        onChange={e => setMemo(e.target.value)}\n                                        placeholder=\"„Éï„É¨„É≥„Éâ„É™„Éº„ÄÅ„Åä„ÇÑ„Å§„ÅåÂ•Ω„Åç„ÄÅ„Å™„Å©\"\n                                        className=\"w-full bg-white/50 min-h-[120px] rounded-2xl border border-white/20 px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 transition-all\"\n                                    />\n                                </div>\n                            </div>\n                        </section>\n\n                        {/* Owner Info Section */}\n                        <section className=\"space-y-6\">\n                            <h2 className=\"text-xs font-bold text-muted-foreground border-b pb-2 flex items-center gap-2 uppercase tracking-widest\">\n                                <User className=\"w-3.5 h-3.5\" /> È£º„ÅÑ‰∏ªÊÉÖÂ†±\n                            </h2>\n                            <div className=\"space-y-4\">\n                                <div className=\"space-y-2\">\n                                    <Label className=\"text-xs font-bold ml-1\">È£º„ÅÑ‰∏ªÂêç</Label>\n                                    <StyledInput value={ownerName} onChange={e => setOwnerName(e.target.value)} placeholder=\"‚óã‚óã„Åï„Çì\" className=\"h-12 rounded-xl\" />\n                                </div>\n                                <div className=\"space-y-2\">\n                                    <Label className=\"text-xs font-bold ml-1\">ÁâπÂæ¥</Label>\n                                    <StyledInput value={ownerDetails} onChange={e => setOwnerDetails(e.target.value)} placeholder=\"„ÅÑ„Å§„ÇÇÂ∏ΩÂ≠ê„ÇíË¢´„Å£„Å¶„ÅÑ„Çã„ÄÅ„Å™„Å©\" className=\"h-12 rounded-xl\" />\n                                </div>\n                                <div className=\"space-y-2\">\n                                    <Label className=\"text-xs font-bold ml-1\">ÈÄ£Áµ°ÂÖà</Label>\n                                    <div className=\"relative\">\n                                        <Phone className=\"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground z-10\" />\n                                        <StyledInput value={contact} onChange={e => setContact(e.target.value)} className=\"pl-11 h-12 rounded-xl\" placeholder=\"ÈõªË©±Áï™Âè∑„ÇÑLINE„Å™„Å©\" />\n                                    </div>\n                                </div>\n                                <div className=\"space-y-2\">\n                                    <Label className=\"text-xs font-bold ml-1\">‰ΩèÊâÄ„ÉªÂú∞Âüü</Label>\n                                    <div className=\"relative\">\n                                        <Home className=\"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground z-10\" />\n                                        <StyledInput value={address} onChange={e => setAddress(e.target.value)} className=\"pl-11 h-12 rounded-xl\" placeholder=\"‚óã‚óãÂå∫‚óã‚óãÁî∫\" />\n                                    </div>\n                                </div>\n                            </div>\n                        </section>\n\n                        {/* Submit Button */}\n                        <div className=\"pt-6\">\n                            <Button\n                                type=\"submit\"\n                                disabled={isSubmitting}\n                                className=\"w-full h-16 rounded-2xl gradient-primary text-xl font-black shadow-xl shadow-primary/25 hover:scale-[1.02] active:scale-[0.98] transition-all\"\n                            >\n                                {isSubmitting ? (\n                                    <Loader2 className=\"w-8 h-8 animate-spin\" />\n                                ) : (\n                                    friend ? 'Êõ¥Êñ∞„Åô„Çã' : 'ÁôªÈå≤„Åô„Çã'\n                                )}\n                            </Button>\n                        </div>\n                    </form>\n                </div>\n            </SheetContent>\n        </Sheet>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/features/Header.tsx",
    "messages": [
      {
        "ruleId": "@next/next/no-img-element",
        "severity": 1,
        "message": "Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element",
        "line": 31,
        "column": 41,
        "nodeType": "JSXOpeningElement",
        "endLine": 31,
        "endColumn": 135
      }
    ],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 1,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useAuth } from '@/contexts/AuthContext';\nimport { PetSwitcher } from './PetSwitcher';\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\nimport { Button } from '@/components/ui/button';\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuSeparator, DropdownMenuTrigger } from '@/components/ui/dropdown-menu';\nimport { Settings, LogOut, Moon, Sun } from 'lucide-react';\nimport { useTheme } from 'next-themes';\nimport Link from 'next/link';\n\nexport function Header() {\n    const { userProfile, signOut } = useAuth();\n    const { theme, setTheme } = useTheme();\n\n    return (\n        <header className=\"sticky top-0 z-40 bg-white/30 dark:bg-black/30 backdrop-blur-xl border-b border-white/10 transition-colors\">\n            <div className=\"flex items-center justify-between h-14 px-4 max-w-2xl mx-auto\">\n                <PetSwitcher />\n                <div className=\"flex items-center gap-2\">\n                    <Button variant=\"ghost\" size=\"icon\" onClick={() => setTheme(theme === 'dark' ? 'light' : 'dark')} className=\"w-9 h-9\" title={theme === 'dark' ? '„É©„Ç§„Éà„É¢„Éº„Éâ„Å´Âàá„ÇäÊõø„Åà' : '„ÉÄ„Éº„ÇØ„É¢„Éº„Éâ„Å´Âàá„ÇäÊõø„Åà'}>\n                        <Sun className=\"w-4 h-4 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0\" />\n                        <Moon className=\"absolute w-4 h-4 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100\" />\n                    </Button>\n                    <DropdownMenu>\n                        <DropdownMenuTrigger asChild>\n                            <Button variant=\"ghost\" size=\"icon\" className=\"w-9 h-9 rounded-full\">\n                                <Avatar className=\"w-8 h-8\">\n                                    <AvatarImage src={userProfile?.avatarUrl} alt={userProfile?.displayName} />\n                                    <AvatarFallback className=\"bg-primary/10 flex items-center justify-center overflow-hidden\">\n                                        <img src=\"/ogp.webp\" alt=\"User\" className=\"w-full h-full object-cover opacity-50 grayscale\" />\n                                    </AvatarFallback>\n                                </Avatar>\n                            </Button>\n                        </DropdownMenuTrigger>\n                        <DropdownMenuContent align=\"end\" className=\"w-56\">\n                            <div className=\"px-2 py-1.5\">\n                                <p className=\"font-medium truncate\">{userProfile?.displayName}</p>\n                                <p className=\"text-xs text-muted-foreground truncate\">{userProfile?.email}</p>\n                            </div>\n                            <DropdownMenuSeparator />\n                            <DropdownMenuItem asChild><Link href=\"/profile\" className=\"cursor-pointer\"><Settings className=\"w-4 h-4 mr-2\" />Ë®≠ÂÆö</Link></DropdownMenuItem>\n                            <DropdownMenuSeparator />\n                            <DropdownMenuItem onClick={signOut} className=\"cursor-pointer text-destructive\"><LogOut className=\"w-4 h-4 mr-2\" />„É≠„Ç∞„Ç¢„Ç¶„Éà</DropdownMenuItem>\n                        </DropdownMenuContent>\n                    </DropdownMenu>\n                </div>\n            </div>\n        </header>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/features/PendingInvitations.tsx",
    "messages": [
      {
        "ruleId": "@next/next/no-img-element",
        "severity": 1,
        "message": "Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element",
        "line": 99,
        "column": 25,
        "nodeType": "JSXOpeningElement",
        "endLine": 99,
        "endColumn": 118
      }
    ],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 1,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { usePendingInvitations } from '@/hooks/usePendingInvitations';\nimport { useMembers } from '@/hooks/useMembers';\nimport type { Pet } from '@/lib/types';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\nimport { PawPrint, Check, X } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { toast } from 'sonner';\nimport { handleError } from '@/lib/errorHandler';\nimport { useState } from 'react';\n\nexport function PendingInvitations() {\n    const { invitations, loading } = usePendingInvitations();\n    const [processingId, setProcessingId] = useState<string | null>(null);\n\n    if (loading || invitations.length === 0) return null;\n\n    return (\n        <motion.div\n            initial={{ opacity: 0, y: -10 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"mb-6\"\n        >\n            <Card className=\"border-primary/50 bg-primary/5\">\n                <CardHeader className=\"pb-2\">\n                    <CardTitle className=\"text-base flex items-center gap-2\">\n                        <PawPrint className=\"w-4 h-4 text-primary\" />\n                        „Éö„ÉÉ„Éà„Å∏„ÅÆÊãõÂæÖ\n                    </CardTitle>\n                    <CardDescription>„ÅÇ„Å™„Åü„ÇíÊãõÂæÖ„Åó„Å¶„ÅÑ„Çã„Éö„ÉÉ„Éà„Åå„ÅÇ„Çä„Åæ„Åô</CardDescription>\n                </CardHeader>\n                <CardContent>\n                    <AnimatePresence>\n                        {invitations.map((invitation) => (\n                            <InvitationItem\n                                key={invitation.member.id}\n                                invitation={invitation}\n                                processingId={processingId}\n                                setProcessingId={setProcessingId}\n                            />\n                        ))}\n                    </AnimatePresence>\n                </CardContent>\n            </Card>\n        </motion.div>\n    );\n}\n\nfunction InvitationItem({\n    invitation,\n    processingId,\n    setProcessingId\n}: {\n    invitation: { pet: Pet; member: { id: string } };\n    processingId: string | null;\n    setProcessingId: (id: string | null) => void;\n}) {\n    const { acceptInvitation, declineInvitation } = useMembers(invitation.pet.id);\n    const isProcessing = processingId === invitation.member.id;\n\n    const handleAccept = async () => {\n        setProcessingId(invitation.member.id);\n        try {\n            await acceptInvitation(invitation.member.id);\n            toast.success(`${invitation.pet.name}„ÅÆ„ÉÅ„Éº„É†„Å´ÂèÇÂä†„Åó„Åæ„Åó„ÅüÔºÅ`);\n        } catch (error) {\n            handleError(error, { context: 'Invitation.accept', fallbackMessage: 'ÊãõÂæÖ„ÅÆÊâøË™ç„Å´Â§±Êïó„Åó„Åæ„Åó„Åü' });\n        } finally {\n            setProcessingId(null);\n        }\n    };\n\n    const handleDecline = async () => {\n        setProcessingId(invitation.member.id);\n        try {\n            await declineInvitation(invitation.member.id);\n            toast.success('ÊãõÂæÖ„ÇíËæûÈÄÄ„Åó„Åæ„Åó„Åü');\n        } catch (error) {\n            handleError(error, { context: 'Invitation.decline', fallbackMessage: 'ÊãõÂæÖ„ÅÆËæûÈÄÄ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü' });\n        } finally {\n            setProcessingId(null);\n        }\n    };\n\n    return (\n        <motion.div\n            initial={{ opacity: 0, height: 0 }}\n            animate={{ opacity: 1, height: 'auto' }}\n            exit={{ opacity: 0, height: 0 }}\n            className=\"flex items-center justify-between p-3 rounded-lg bg-card\"\n        >\n            <div className=\"flex items-center gap-3\">\n                <Avatar className=\"w-10 h-10\">\n                    <AvatarImage src={invitation.pet.avatarUrl} alt={invitation.pet.name} />\n                    <AvatarFallback className=\"bg-primary/10 flex items-center justify-center overflow-hidden\">\n                        <img src=\"/ogp.webp\" alt=\"Pet\" className=\"w-full h-full object-cover opacity-50 grayscale\" />\n                    </AvatarFallback>\n                </Avatar>\n                <div>\n                    <p className=\"font-medium\">{invitation.pet.name}</p>\n                    <p className=\"text-sm text-muted-foreground\">„Å∏„ÅÆÊãõÂæÖ</p>\n                </div>\n            </div>\n            <div className=\"flex gap-2\">\n                <Button\n                    size=\"sm\"\n                    variant=\"outline\"\n                    onClick={handleDecline}\n                    disabled={isProcessing}\n                >\n                    <X className=\"w-4 h-4\" />\n                </Button>\n                <Button\n                    size=\"sm\"\n                    className=\"gradient-primary\"\n                    onClick={handleAccept}\n                    disabled={isProcessing}\n                >\n                    <Check className=\"w-4 h-4\" />\n                </Button>\n            </div>\n        </motion.div>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/features/PetSwitcher.tsx",
    "messages": [
      {
        "ruleId": "@next/next/no-img-element",
        "severity": 1,
        "message": "Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element",
        "line": 63,
        "column": 29,
        "nodeType": "JSXOpeningElement",
        "endLine": 63,
        "endColumn": 122
      },
      {
        "ruleId": "@next/next/no-img-element",
        "severity": 1,
        "message": "Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element",
        "line": 76,
        "column": 33,
        "nodeType": "JSXOpeningElement",
        "endLine": 76,
        "endColumn": 126
      }
    ],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 2,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { usePets } from '@/hooks/usePets';\nimport { usePetContext } from '@/contexts/PetContext';\nimport { Button } from '@/components/ui/button';\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuSeparator, DropdownMenuTrigger } from '@/components/ui/dropdown-menu';\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\nimport { ChevronDown, Plus, Settings } from 'lucide-react';\nimport Link from 'next/link';\nimport { useEffect } from 'react';\n\nexport function PetSwitcher() {\n    const { pets, loading } = usePets();\n    const { selectedPet, setSelectedPet } = usePetContext();\n\n    useEffect(() => {\n        if (loading) return;\n\n        if (pets.length > 0) {\n            if (selectedPet) {\n                // ÈÅ∏Êäû‰∏≠„ÅÆ„Éö„ÉÉ„Éà„ÅåÊúÄÊñ∞„ÅÆ„É™„Çπ„Éà„Å´Â≠òÂú®„Åô„Çã„ÅãÁ¢∫Ë™ç„Åó„ÄÅ„Éá„Éº„Çø„ÅåÊõ¥Êñ∞„Åï„Çå„Å¶„ÅÑ„Çå„Å∞State„ÇÇÊõ¥Êñ∞\n                const updatedPet = pets.find(p => p.id === selectedPet.id);\n                if (updatedPet) {\n                    // JSON.stringify„ÅßÊØîËºÉ„Åó„Å¶Â§âÊõ¥„Åå„ÅÇ„Çå„Å∞Êõ¥Êñ∞ („É¨„É≥„ÉÄ„É™„É≥„Ç∞„É´„Éº„ÉóÈò≤Ê≠¢)\n                    if (JSON.stringify(updatedPet) !== JSON.stringify(selectedPet)) {\n                        setSelectedPet(updatedPet);\n                    }\n                } else {\n                    // ÈÅ∏Êäû‰∏≠„ÅÆ„Éö„ÉÉ„Éà„ÅåÂâäÈô§„Åï„Çå„ÅüÂ†¥Âêà„ÅØÊúÄÂàù„ÅÆ„Éö„ÉÉ„Éà„ÇíÈÅ∏Êäû\n                    setSelectedPet(pets[0]);\n                }\n            } else {\n                // Êú™ÈÅ∏Êäû„ÅÆÂ†¥Âêà„ÅØÊúÄÂàù„ÅÆ„Éö„ÉÉ„Éà„ÇíÈÅ∏Êäû\n                setSelectedPet(pets[0]);\n            }\n        } else {\n            // „Éö„ÉÉ„Éà„Åå1Âåπ„ÇÇ„ÅÑ„Å™„ÅÑÂ†¥Âêà„ÅØÈÅ∏ÊäûËß£Èô§\n            if (selectedPet) {\n                setSelectedPet(null);\n            }\n        }\n    }, [pets, loading, selectedPet, setSelectedPet]);\n\n    if (loading) return <div className=\"h-10 w-32 bg-muted animate-pulse rounded-lg\" />;\n\n    if (pets.length === 0) {\n        return (\n            <Link href=\"/pets/new\">\n                <Button variant=\"outline\" size=\"sm\" className=\"gap-2\">\n                    <Plus className=\"w-4 h-4\" />„Éö„ÉÉ„Éà„ÇíÁôªÈå≤\n                </Button>\n            </Link>\n        );\n    }\n\n    return (\n        <DropdownMenu>\n            <DropdownMenuTrigger asChild>\n                <Button variant=\"ghost\" className=\"gap-2 h-10 px-3\">\n                    <Avatar className=\"w-7 h-7\">\n                        <AvatarImage src={selectedPet?.avatarUrl} alt={selectedPet?.name} />\n                        <AvatarFallback className=\"bg-primary/10 flex items-center justify-center overflow-hidden\">\n                            <img src=\"/ogp.webp\" alt=\"Pet\" className=\"w-full h-full object-cover opacity-50 grayscale\" />\n                        </AvatarFallback>\n                    </Avatar>\n                    <span className=\"font-medium max-w-[100px] truncate\">{selectedPet?.name || '„Éö„ÉÉ„Éà„ÇíÈÅ∏Êäû'}</span>\n                    <ChevronDown className=\"w-4 h-4 text-muted-foreground\" />\n                </Button>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent align=\"start\" className=\"w-56\">\n                {pets.map((pet) => (\n                    <DropdownMenuItem key={pet.id} onClick={() => setSelectedPet(pet)} className=\"gap-3 cursor-pointer\">\n                        <Avatar className=\"w-8 h-8\">\n                            <AvatarImage src={pet.avatarUrl} alt={pet.name} />\n                            <AvatarFallback className=\"bg-primary/10 flex items-center justify-center overflow-hidden\">\n                                <img src=\"/ogp.webp\" alt=\"Pet\" className=\"w-full h-full object-cover opacity-50 grayscale\" />\n                            </AvatarFallback>\n                        </Avatar>\n                        <div className=\"flex-1 min-w-0\">\n                            <p className=\"font-medium truncate\">{pet.name}</p>\n                            {pet.breed && <p className=\"text-xs text-muted-foreground truncate\">{pet.breed}</p>}\n                        </div>\n                    </DropdownMenuItem>\n                ))}\n                <DropdownMenuSeparator />\n                {selectedPet && (\n                    <DropdownMenuItem asChild>\n                        <Link href={`/pets/settings?id=${selectedPet.id}`} className=\"gap-3 cursor-pointer\">\n                            <div className=\"w-8 h-8 rounded-full bg-muted flex items-center justify-center\"><Settings className=\"w-4 h-4\" /></div>\n                            <span>{selectedPet.name}„ÅÆË®≠ÂÆö</span>\n                        </Link>\n                    </DropdownMenuItem>\n                )}\n                <DropdownMenuItem asChild>\n                    <Link href=\"/pets/new\" className=\"gap-3 cursor-pointer\">\n                        <div className=\"w-8 h-8 rounded-full bg-muted flex items-center justify-center\"><Plus className=\"w-4 h-4\" /></div>\n                        <span>Êñ∞„Åó„ÅÑ„Éö„ÉÉ„Éà„ÇíËøΩÂä†</span>\n                    </Link>\n                </DropdownMenuItem>\n            </DropdownMenuContent>\n        </DropdownMenu>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/features/SideNav.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/features/WeightFormSheet.tsx",
    "messages": [
      {
        "ruleId": "react-hooks/set-state-in-effect",
        "severity": 2,
        "message": "Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/features/WeightFormSheet.tsx:35:13\n  33 |     useEffect(() => {\n  34 |         if (weightItem) {\n> 35 |             setValue(weightItem.value.toString());\n     |             ^^^^^^^^ Avoid calling setState() directly within an effect\n  36 |             setUnit(weightItem.unit);\n  37 |             setDate(weightItem.date.toDate());\n  38 |         } else {",
        "line": 35,
        "column": 13,
        "nodeType": null,
        "endLine": 35,
        "endColumn": 21
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useState, useEffect } from 'react';\nimport { Sheet, SheetContent, SheetHeader, SheetTitle } from '@/components/ui/sheet';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { DatePickerDropdown } from '@/components/ui/date-picker-dropdown';\nimport { X, Scale, Calendar as CalendarIcon, Loader2 } from 'lucide-react';\nimport { toast } from 'sonner';\nimport { type WeightItem } from '@/lib/types';\n\ninterface WeightFormSheetProps {\n    weightItem?: WeightItem | null;\n    open: boolean;\n    onClose: () => void;\n    onSave: (data: { value: number; unit: 'kg' | 'g'; date: Date }) => Promise<void>;\n    isSubmitting: boolean;\n}\n\nexport function WeightFormSheet({\n    weightItem,\n    open,\n    onClose,\n    onSave,\n    isSubmitting,\n}: WeightFormSheetProps) {\n    const [value, setValue] = useState('');\n    const [unit, setUnit] = useState<'kg' | 'g'>('kg');\n    const [date, setDate] = useState<Date>(new Date());\n\n    useEffect(() => {\n        if (weightItem) {\n            setValue(weightItem.value.toString());\n            setUnit(weightItem.unit);\n            setDate(weightItem.date.toDate());\n        } else {\n            setValue('');\n            setUnit('kg');\n            setDate(new Date());\n        }\n    }, [weightItem, open]);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        const numValue = parseFloat(value);\n        if (isNaN(numValue) || numValue <= 0) {\n            toast.error('Ê≠£„Åó„ÅÑ‰ΩìÈáç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');\n            return;\n        }\n        await onSave({ value: numValue, unit, date });\n        onClose();\n    };\n\n    return (\n        <Sheet open={open} onOpenChange={(isOpen) => !isOpen && onClose()}>\n            <SheetContent side=\"bottom\" className=\"h-[70vh] rounded-t-3xl bg-background/95 backdrop-blur-xl border-t border-white/20 p-0 overflow-hidden\">\n                {/* Header */}\n                <SheetHeader className=\"sticky top-0 z-10 bg-background/80 backdrop-blur-md border-b border-white/10 px-4 py-3\">\n                    <div className=\"flex items-center justify-between\">\n                        <Button variant=\"ghost\" size=\"icon\" onClick={onClose} className=\"rounded-full w-9 h-9\">\n                            <X className=\"w-5 h-5\" />\n                        </Button>\n                        <SheetTitle className=\"text-sm font-bold\">\n                            {weightItem ? '‰ΩìÈáç„ÇíÁ∑®ÈõÜ' : '‰ΩìÈáç„ÇíË®òÈå≤'}\n                        </SheetTitle>\n                        <div className=\"w-9\" />\n                    </div>\n                </SheetHeader>\n\n                <div className=\"overflow-y-auto h-full px-6 py-8\">\n                    <form onSubmit={handleSubmit} className=\"space-y-8\">\n                        {/* Value & Unit */}\n                        <div className=\"space-y-4\">\n                            <Label className=\"text-xs font-bold text-muted-foreground uppercase tracking-wider flex items-center gap-2\">\n                                <Scale className=\"w-3.5 h-3.5\" /> ‰ΩìÈáç\n                            </Label>\n                            <div className=\"flex gap-2\">\n                                <div className=\"relative flex-1\">\n                                    <Input\n                                        type=\"number\"\n                                        step=\"0.01\"\n                                        inputMode=\"decimal\"\n                                        placeholder=\"0.00\"\n                                        value={value}\n                                        onChange={(e) => setValue(e.target.value)}\n                                        className=\"h-14 text-2xl font-black rounded-2xl bg-white/50 border-white/20 focus:bg-white transition-all pl-4\"\n                                    />\n                                </div>\n                                <Select value={unit} onValueChange={(v: 'kg' | 'g') => setUnit(v)}>\n                                    <SelectTrigger className=\"w-24 h-14 rounded-2xl bg-white/50 border-white/20 text-lg font-bold\">\n                                        <SelectValue />\n                                    </SelectTrigger>\n                                    <SelectContent>\n                                        <SelectItem value=\"kg\">kg</SelectItem>\n                                        <SelectItem value=\"g\">g</SelectItem>\n                                    </SelectContent>\n                                </Select>\n                            </div>\n                        </div>\n\n                        {/* Date */}\n                        <div className=\"space-y-4\">\n                            <Label className=\"text-xs font-bold text-muted-foreground uppercase tracking-wider flex items-center gap-2\">\n                                <CalendarIcon className=\"w-3.5 h-3.5\" /> Êó•‰ªò\n                            </Label>\n                            <DatePickerDropdown\n                                date={date}\n                                setDate={(d) => d && setDate(d)}\n                                className=\"w-full h-14 rounded-2xl bg-white/50 border-white/20 text-lg font-bold justify-start px-4\"\n                            />\n                        </div>\n\n                        <div className=\"pt-8 px-2\">\n                            <Button\n                                type=\"submit\"\n                                disabled={isSubmitting}\n                                className=\"w-full h-14 rounded-2xl gradient-primary text-lg font-black shadow-xl shadow-primary/25 hover:scale-[1.02] active:scale-[0.98] transition-all\"\n                            >\n                                {isSubmitting ? (\n                                    <Loader2 className=\"w-6 h-6 animate-spin\" />\n                                ) : (\n                                    '‰øùÂ≠ò„Åô„Çã'\n                                )}\n                            </Button>\n                        </div>\n                    </form>\n                </div>\n            </SheetContent>\n        </Sheet>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/features/pet-avatar-editor.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'Button' is defined but never used.",
        "line": 6,
        "column": 10,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 6,
        "endColumn": 16
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'motion' is defined but never used.",
        "line": 9,
        "column": 10,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 9,
        "endColumn": 16
      }
    ],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 2,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useState, useRef } from 'react';\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\nimport { ImageCropper } from '@/components/ui/image-cropper';\nimport { Button } from '@/components/ui/button';\nimport { Camera, X, PawPrint } from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport { motion } from 'framer-motion';\n\ninterface PetAvatarEditorProps {\n    imageUrl?: string | null;\n    onImageChange: (file: File) => void;\n    onImageRemove: () => void;\n    disabled?: boolean;\n    className?: string;\n    avatarClassName?: string;\n    showRemoveButton?: boolean;\n}\n\nexport function PetAvatarEditor({\n    imageUrl,\n    onImageChange,\n    onImageRemove,\n    disabled = false,\n    className,\n    avatarClassName,\n    showRemoveButton = true,\n}: PetAvatarEditorProps) {\n    const fileInputRef = useRef<HTMLInputElement>(null);\n    const [cropperOpen, setCropperOpen] = useState(false);\n    const [originalImageSrc, setOriginalImageSrc] = useState<string | null>(null);\n\n    const handleImageSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\n        if (!e.target.files?.[0]) return;\n        const file = e.target.files[0];\n        const url = URL.createObjectURL(file);\n        setOriginalImageSrc(url);\n        setCropperOpen(true);\n        e.target.value = ''; // Reset for re-selection\n    };\n\n    const handleCropComplete = (croppedBlob: Blob) => {\n        const file = new File([croppedBlob], \"avatar.jpg\", { type: \"image/jpeg\" });\n        onImageChange(file);\n        setCropperOpen(false);\n        setOriginalImageSrc(null); // Clean up\n    };\n\n    const handleCropCancel = () => {\n        setCropperOpen(false);\n        setOriginalImageSrc(null);\n    };\n\n    return (\n        <div className={cn(\"relative group\", className)}>\n            <div className=\"absolute -inset-4 bg-gradient-to-tr from-primary to-orange-400 rounded-full opacity-30 blur-xl group-hover:opacity-40 transition duration-1000 animate-pulse\" />\n\n            <Avatar className={cn(\"w-32 h-32 md:w-40 md:h-40 border-4 border-white/50 dark:border-white/10 shadow-2xl relative z-10\", avatarClassName)}>\n                <AvatarImage src={imageUrl || undefined} className=\"object-cover\" />\n                <AvatarFallback className=\"bg-white/50 dark:bg-black/20 text-4xl backdrop-blur-md\">\n                    <PawPrint className=\"w-16 h-16 text-primary/50\" />\n                </AvatarFallback>\n            </Avatar>\n\n            {!disabled && (\n                <>\n                    <button\n                        type=\"button\"\n                        onClick={() => fileInputRef.current?.click()}\n                        disabled={disabled}\n                        className=\"absolute -bottom-2 -right-2 w-9 h-9 rounded-full bg-primary text-primary-foreground flex items-center justify-center shadow-lg hover:bg-primary/90 hover:scale-110 transition-all z-20\"\n                    >\n                        <Camera className=\"w-5 h-5\" />\n                    </button>\n                    <input\n                        ref={fileInputRef}\n                        type=\"file\"\n                        accept=\"image/*\"\n                        className=\"hidden\"\n                        onChange={handleImageSelect}\n                        disabled={disabled}\n                    />\n\n                    {imageUrl && showRemoveButton && (\n                        <button\n                            type=\"button\"\n                            onClick={onImageRemove}\n                            disabled={disabled}\n                            className=\"absolute -top-2 -right-2 w-9 h-9 rounded-full bg-destructive text-white flex items-center justify-center shadow-lg hover:bg-destructive/90 hover:scale-110 transition-all z-20\"\n                        >\n                            <X className=\"w-5 h-5\" />\n                        </button>\n                    )}\n                </>\n            )}\n\n            <ImageCropper\n                open={cropperOpen}\n                imageSrc={originalImageSrc}\n                onCropComplete={handleCropComplete}\n                onCancel={handleCropCancel}\n            />\n        </div>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/features/pet-basic-info-form.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'Input' is defined but never used.",
        "line": 3,
        "column": 10,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 3,
        "endColumn": 15
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 28,
        "column": 65,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 28,
        "endColumn": 68,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [921, 924], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [921, 924], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 65,
        "column": 51,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 65,
        "endColumn": 54,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [2652, 2655], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [2652, 2655], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 2,
    "fatalErrorCount": 0,
    "warningCount": 1,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { DatePickerDropdown } from '@/components/ui/date-picker-dropdown';\nimport { cn } from '@/lib/utils';\nimport { StyledInput, SpeciesBreedSelector, GenderSelect, ColorSelect } from '@/components/ui/styled-form-fields';\n\nexport interface PetBasicInfoData {\n    name: string;\n    species: string;\n    breed: string;\n    color: string;\n    gender: 'male' | 'female' | 'other' | '';\n    birthday: Date | undefined;\n    adoptionDate: Date | undefined;\n    microchipId: string;\n}\n\ninterface PetBasicInfoFormProps {\n    data: PetBasicInfoData;\n    onChange: (data: PetBasicInfoData) => void;\n    disabled?: boolean;\n    className?: string;\n}\n\nexport function PetBasicInfoForm({ data, onChange, disabled = false, className }: PetBasicInfoFormProps) {\n    const handleChange = (field: keyof PetBasicInfoData, value: any) => {\n        onChange({ ...data, [field]: value });\n    };\n\n    return (\n        <div className={cn(\"glass rounded-[2.5rem] p-8 shadow-xl space-y-6 relative overflow-hidden\", className)}>\n            <div className=\"absolute top-0 left-0 w-full h-1 bg-gradient-primary opacity-50\" />\n\n            <div className=\"flex items-center gap-2 mb-2\">\n                <div className=\"w-1 h-4 bg-primary rounded-full\" />\n                <h3 className=\"font-bold text-lg text-foreground/80\">Âü∫Êú¨ÊÉÖÂ†±</h3>\n            </div>\n\n            <div className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                    <Label htmlFor=\"name\" className=\"text-xs font-bold text-muted-foreground ml-1\">ÂêçÂâç <span className=\"text-destructive\">*</span></Label>\n                    <StyledInput\n                        id=\"name\"\n                        value={data.name}\n                        onChange={(e) => handleChange('name', e.target.value)}\n                        placeholder=\"„Éö„ÉÉ„Éà„ÅÆÂêçÂâç\"\n                        disabled={disabled}\n                    />\n                </div>\n\n                <SpeciesBreedSelector\n                    species={data.species}\n                    breed={data.breed}\n                    onChangeSpecies={(val) => onChange({ ...data, species: val, breed: '' })}\n                    onChangeBreed={(val) => handleChange('breed', val)}\n                    disabled={disabled}\n                />\n\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                    <div className=\"space-y-2\">\n                        <Label className=\"text-xs font-bold text-muted-foreground ml-1\">ÊÄßÂà•</Label>\n                        <GenderSelect\n                            value={data.gender as any}\n                            onChange={(val) => handleChange('gender', val)}\n                            type=\"pet\"\n                            disabled={disabled}\n                        />\n                    </div>\n                    <div className=\"space-y-2\">\n                        <Label className=\"text-xs font-bold text-muted-foreground ml-1\">ÊØõËâ≤</Label>\n                        <ColorSelect\n                            value={data.color}\n                            onChange={(val) => handleChange('color', val)}\n                            disabled={disabled}\n                        />\n                    </div>\n                </div>\n\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                    <DatePickerDropdown\n                        label=\"Ë™ïÁîüÊó•\"\n                        date={data.birthday}\n                        setDate={(d) => handleChange('birthday', d)}\n                        disabled={disabled}\n                    />\n                    <DatePickerDropdown\n                        label=\"„ÅÜ„Å°„ÅÆÂ≠êË®òÂøµÊó•\"\n                        date={data.adoptionDate}\n                        setDate={(d) => handleChange('adoptionDate', d)}\n                        disabled={disabled}\n                    />\n                </div>\n\n                <div className=\"space-y-2\">\n                    <Label htmlFor=\"microchipId\" className=\"text-xs font-bold text-muted-foreground ml-1\">„Éû„Ç§„ÇØ„É≠„ÉÅ„ÉÉ„ÉóID</Label>\n                    <StyledInput\n                        id=\"microchipId\"\n                        value={data.microchipId}\n                        onChange={(e) => handleChange('microchipId', e.target.value)}\n                        placeholder=\"„Éû„Ç§„ÇØ„É≠„ÉÅ„ÉÉ„ÉóIDÔºà‰ªªÊÑèÔºâ\"\n                        disabled={disabled}\n                    />\n                </div>\n            </div>\n        </div>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/alert-dialog.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/avatar.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/button.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/calendar.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/card.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/checkbox.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/collapsible.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/date-picker-dropdown.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/dialog.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/dropdown-menu.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/empty-state.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/image-cropper.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 26,
        "column": 64,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 26,
        "endColumn": 67,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [794, 797], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [794, 797], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 37,
        "column": 62,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 37,
        "endColumn": 65,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [1093, 1096], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [1093, 1096], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 37,
        "column": 86,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 37,
        "endColumn": 89,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [1117, 1120], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [1117, 1120], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 3,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useState, useCallback } from 'react';\nimport Cropper from 'react-easy-crop';\nimport {\n    Dialog,\n    DialogContent,\n    DialogFooter,\n    DialogHeader,\n    DialogTitle,\n} from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport getCroppedImg from '@/lib/cropImage';\nimport { Loader2, ZoomIn, ZoomOut } from 'lucide-react';\n\ninterface ImageCropperProps {\n    open: boolean;\n    imageSrc: string | null;\n    onCropComplete: (croppedImageBlob: Blob) => void;\n    onCancel: () => void;\n}\n\nexport function ImageCropper({ open, imageSrc, onCropComplete, onCancel }: ImageCropperProps) {\n    const [crop, setCrop] = useState({ x: 0, y: 0 });\n    const [zoom, setZoom] = useState(1);\n    const [croppedAreaPixels, setCroppedAreaPixels] = useState<any>(null);\n    const [isLoading, setIsLoading] = useState(false);\n\n    const onCropChange = (crop: { x: number; y: number }) => {\n        setCrop(crop);\n    };\n\n    const onZoomChange = (zoom: number) => {\n        setZoom(zoom);\n    };\n\n    const onCropCompleteCallback = useCallback((croppedArea: any, croppedAreaPixels: any) => {\n        setCroppedAreaPixels(croppedAreaPixels);\n    }, []);\n\n    const handleSave = async () => {\n        if (!imageSrc || !croppedAreaPixels) return;\n        setIsLoading(true);\n        try {\n            const croppedImage = await getCroppedImg(imageSrc, croppedAreaPixels);\n            if (croppedImage) {\n                onCropComplete(croppedImage);\n            }\n        } catch (e) {\n            console.error(e);\n        } finally {\n            setIsLoading(false);\n        }\n    };\n\n    return (\n        <Dialog open={open} onOpenChange={(val) => !val && onCancel()}>\n            <DialogContent className=\"sm:max-w-md\">\n                <DialogHeader>\n                    <DialogTitle>ÁîªÂÉè„ÅÆ‰ΩçÁΩÆ„Å®„Çµ„Ç§„Ç∫„ÇíË™øÊï¥</DialogTitle>\n                </DialogHeader>\n                <div className=\"relative w-full h-80 bg-black rounded-md overflow-hidden my-4\">\n                    {imageSrc && (\n                        <Cropper\n                            image={imageSrc}\n                            crop={crop}\n                            zoom={zoom}\n                            aspect={1}\n                            onCropChange={onCropChange}\n                            onCropComplete={onCropCompleteCallback}\n                            onZoomChange={onZoomChange}\n                        />\n                    )}\n                </div>\n                <div className=\"flex items-center gap-4 px-2\">\n                    <ZoomOut className=\"w-4 h-4 text-muted-foreground\" />\n                    <input\n                        type=\"range\"\n                        value={zoom}\n                        min={1}\n                        max={3}\n                        step={0.1}\n                        aria-labelledby=\"Zoom\"\n                        onChange={(e) => setZoom(Number(e.target.value))}\n                        className=\"w-full h-2 bg-secondary rounded-lg appearance-none cursor-pointer accent-primary\"\n                    />\n                    <ZoomIn className=\"w-4 h-4 text-muted-foreground\" />\n                </div>\n                <DialogFooter className=\"mt-4\">\n                    <Button variant=\"outline\" onClick={onCancel} disabled={isLoading}>\n                        „Ç≠„É£„É≥„Çª„É´\n                    </Button>\n                    <Button onClick={handleSave} disabled={isLoading} className=\"gradient-primary\">\n                        {isLoading && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                        Âàá„ÇäÊäú„Åè\n                    </Button>\n                </DialogFooter>\n            </DialogContent>\n        </Dialog>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/input.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/label.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/popover.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/select.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/separator.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/sheet.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/skeleton-loader.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/styled-form-fields.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-empty-object-type",
        "severity": 2,
        "message": "An interface declaring no members is equivalent to its supertype.",
        "line": 13,
        "column": 11,
        "nodeType": "Identifier",
        "messageId": "noEmptyInterfaceWithSuper",
        "endLine": 13,
        "endColumn": 27,
        "suggestions": [
          {
            "messageId": "replaceEmptyInterfaceWithSuper",
            "fix": {
              "range": [501, 574],
              "text": "type StyledInputProps = React.ComponentProps<typeof Input>"
            },
            "desc": "Replace empty interface with a type alias."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import React, { useMemo } from 'react';\nimport { Input } from '@/components/ui/input';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Label } from '@/components/ui/label';\nimport { SPECIES_DATA } from '@/lib/constants/species';\nimport { PET_COLORS } from '@/lib/constants/colors';\nimport { cn } from '@/lib/utils';\n\n// ==========================================\n// Styled Base Components\n// ==========================================\n\ninterface StyledInputProps extends React.ComponentProps<typeof Input> { }\n\nexport const StyledInput = React.forwardRef<HTMLInputElement, StyledInputProps>(\n    ({ className, ...props }, ref) => {\n        return (\n            <Input\n                ref={ref}\n                className={cn(\n                    \"h-12 rounded-xl bg-white/50 dark:bg-black/20 border-white/20 focus:scale-[1.01] transition-transform\",\n                    className\n                )}\n                {...props}\n            />\n        );\n    }\n);\nStyledInput.displayName = 'StyledInput';\n\ninterface StyledSelectProps {\n    value: string;\n    onValueChange: (value: string) => void;\n    placeholder?: string;\n    options?: { value: string; label: string; icon?: React.ReactNode }[];\n    children?: React.ReactNode;\n    disabled?: boolean;\n    className?: string;\n    triggerClassName?: string;\n}\n\nexport const StyledSelect = ({ value, onValueChange, placeholder = \"ÈÅ∏Êäû\", options, children, disabled, className, triggerClassName }: StyledSelectProps) => {\n    return (\n        <Select value={value} onValueChange={onValueChange} disabled={disabled}>\n            <SelectTrigger className={cn(\"h-12 rounded-xl bg-white/50 dark:bg-black/20 border-white/20\", triggerClassName)}>\n                <SelectValue placeholder={placeholder} />\n            </SelectTrigger>\n            <SelectContent className={cn(\"max-h-[300px]\", className)}>\n                {options ? options.map(opt => (\n                    <SelectItem key={opt.value} value={opt.value}>\n                        <div className=\"flex items-center gap-2\">\n                            {opt.icon}\n                            <span>{opt.label}</span>\n                        </div>\n                    </SelectItem>\n                )) : children}\n            </SelectContent>\n        </Select>\n    );\n};\n\n// ==========================================\n// Domain Specific Components\n// ==========================================\n\n// --- Gender Selector ---\ninterface GenderSelectProps {\n    value: string;\n    onChange: (value: string) => void;\n    type: 'human' | 'pet' | 'friend';\n    disabled?: boolean;\n}\n\nexport const GenderSelect = ({ value, onChange, type, disabled }: GenderSelectProps) => {\n    const options = useMemo(() => {\n        if (type === 'human') {\n            return [\n                { value: 'male', label: 'Áî∑ÊÄß' },\n                { value: 'female', label: 'Â•≥ÊÄß' },\n                { value: 'other', label: '„Åù„ÅÆ‰ªñ' },\n            ];\n        } else if (type === 'pet') {\n            return [\n                { value: 'male', label: 'Áî∑„ÅÆÂ≠ê ‚ôÇ' },\n                { value: 'female', label: 'Â•≥„ÅÆÂ≠ê ‚ôÄ' },\n                { value: 'other', label: '„Åù„ÅÆ‰ªñ' },\n            ];\n        } else {\n            // friend\n            return [\n                { value: 'male', label: 'Áî∑„ÅÆÂ≠ê (‚ôÇ)' },\n                { value: 'female', label: 'Â•≥„ÅÆÂ≠ê (‚ôÄ)' },\n                { value: 'unknown', label: '‰∏çÊòé' },\n            ];\n        }\n    }, [type]);\n\n    return (\n        <StyledSelect\n            value={value}\n            onValueChange={onChange}\n            options={options}\n            disabled={disabled}\n        />\n    );\n};\n\n// --- Color Selector ---\ninterface ColorSelectProps {\n    value: string;\n    onChange: (value: string) => void;\n    disabled?: boolean;\n}\n\nexport const ColorSelect = ({ value, onChange, disabled }: ColorSelectProps) => {\n    return (\n        <StyledSelect\n            value={value}\n            onValueChange={onChange}\n            disabled={disabled}\n        >\n            {PET_COLORS.map((c) => (\n                <SelectItem key={c.id} value={c.name}>\n                    <span className=\"flex items-center gap-2\">\n                        <span className=\"w-3 h-3 rounded-full border border-black/10\" style={{ backgroundColor: c.hex }} />\n                        {c.name}\n                    </span>\n                </SelectItem>\n            ))}\n        </StyledSelect>\n    );\n};\n\n// --- Species & Breed Selector ---\ninterface SpeciesBreedSelectorProps {\n    species: string;\n    breed: string;\n    onChangeSpecies: (species: string) => void;\n    onChangeBreed: (breed: string) => void;\n    disabled?: boolean;\n}\n\nexport const SpeciesBreedSelector = ({ species, breed, onChangeSpecies, onChangeBreed, disabled }: SpeciesBreedSelectorProps) => {\n    const speciesOptions = useMemo(() => [\n        // Áä¨„ÉªÁå´\n        { label: SPECIES_DATA.mammals.categories.dogs.label, value: SPECIES_DATA.mammals.categories.dogs.species, breeds: SPECIES_DATA.mammals.categories.dogs.breeds },\n        { label: SPECIES_DATA.mammals.categories.cats.label, value: SPECIES_DATA.mammals.categories.cats.species, breeds: SPECIES_DATA.mammals.categories.cats.breeds },\n        // Â∞èÂãïÁâ©\n        ...Object.values(SPECIES_DATA.mammals.categories.small_mammals.categories).map(c => ({ label: c.label, value: c.label, breeds: c.breeds })),\n        // È≥•È°û\n        ...Object.values(SPECIES_DATA.birds.categories).map(c => ({ label: c.label, value: c.label, breeds: c.breeds })),\n        // Áà¨Ëô´È°û\n        ...Object.values(SPECIES_DATA.reptiles.categories).map(c => ({ label: c.label, value: c.label, breeds: c.breeds })),\n        // ‰∏°ÁîüÈ°û\n        ...Object.values(SPECIES_DATA.amphibians.categories).map(c => ({ label: c.label, value: c.label, breeds: c.breeds })),\n        // È≠öÈ°û\n        ...Object.values(SPECIES_DATA.fish.categories).map(c => ({ label: c.label, value: c.label, breeds: c.breeds })),\n        // ÁÑ°ËÑäÊ§éÂãïÁâ©\n        ...Object.values(SPECIES_DATA.invertebrates.categories).map(c => ({ label: c.label, value: c.label, breeds: c.breeds })),\n        // „Åù„ÅÆ‰ªñ\n        { label: '„Åù„ÅÆ‰ªñ', value: 'other', breeds: [] }\n    ], []);\n\n    const currentSpecies = speciesOptions.find(opt => opt.value === species);\n    const breedOptions = currentSpecies?.breeds || [];\n    const isOtherSpecies = species === 'other';\n\n    return (\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n                <Label className=\"text-xs font-bold text-muted-foreground ml-1\">Á®ÆÈ°û</Label>\n                <StyledSelect\n                    value={species}\n                    onValueChange={(val) => {\n                        onChangeSpecies(val);\n                        // We do NOT call onChangeBreed('') here to avoid race conditions.\n                        // The parent must handle the breed reset if desired.\n                    }}\n                    options={speciesOptions.map(opt => ({ value: opt.value, label: opt.label }))}\n                    disabled={disabled}\n                />\n            </div>\n            <div className=\"space-y-2\">\n                <Label className=\"text-xs font-bold text-muted-foreground ml-1\">ÂìÅÁ®Æ</Label>\n                {!isOtherSpecies && breedOptions.length > 0 ? (\n                    <StyledSelect\n                        value={breed}\n                        onValueChange={onChangeBreed}\n                        disabled={disabled}\n                    >\n                        {breedOptions.map((b) => (\n                            <SelectItem key={b} value={b}>{b}</SelectItem>\n                        ))}\n                    </StyledSelect>\n                ) : (\n                    <StyledInput\n                        value={breed}\n                        onChange={(e) => onChangeBreed(e.target.value)}\n                        placeholder=\"ÂìÅÁ®Æ„ÇíÂÖ•Âäõ\"\n                        disabled={disabled}\n                    />\n                )}\n            </div>\n        </div>\n    );\n};\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/switch.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/tabs.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/components/ui/time-picker-input.tsx",
    "messages": [
      {
        "ruleId": "react-hooks/exhaustive-deps",
        "severity": 1,
        "message": "React Hook React.useEffect has missing dependencies: 'items' and 'value'. Either include them or remove the dependency array.",
        "line": 46,
        "column": 8,
        "nodeType": "ArrayExpression",
        "endLine": 46,
        "endColumn": 10,
        "suggestions": [
          {
            "desc": "Update the dependencies array to be: [items, value]",
            "fix": { "range": [1224, 1226], "text": "[items, value]" }
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 1,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport * as React from 'react';\nimport { Clock } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';\nimport { cn } from '@/lib/utils';\nimport { Label } from '@/components/ui/label';\n\ninterface TimePickerInputProps {\n    time: string; // \"HH:mm\" format\n    setTime: (time: string) => void;\n    label?: string;\n    placeholder?: string;\n    disabled?: boolean;\n    className?: string;\n    size?: 'sm' | 'md' | 'lg';\n}\n\nconst ITEM_HEIGHT = 40;\nconst VISIBLE_ITEMS = 5;\n\nfunction WheelColumn({\n    items,\n    value,\n    onChange,\n    label,\n}: {\n    items: number[];\n    value: number;\n    onChange: (v: number) => void;\n    label: string;\n}) {\n    const containerRef = React.useRef<HTMLDivElement>(null);\n    const isScrollingRef = React.useRef(false);\n    const scrollTimeoutRef = React.useRef<NodeJS.Timeout | null>(null);\n\n    // Scroll to initial value on mount\n    React.useEffect(() => {\n        if (containerRef.current) {\n            const index = items.indexOf(value);\n            if (index !== -1) {\n                containerRef.current.scrollTop = index * ITEM_HEIGHT;\n            }\n        }\n    }, []);\n\n    const handleScroll = () => {\n        if (scrollTimeoutRef.current) {\n            clearTimeout(scrollTimeoutRef.current);\n        }\n\n        isScrollingRef.current = true;\n\n        scrollTimeoutRef.current = setTimeout(() => {\n            if (containerRef.current) {\n                const scrollTop = containerRef.current.scrollTop;\n                const index = Math.round(scrollTop / ITEM_HEIGHT);\n                const clampedIndex = Math.max(0, Math.min(items.length - 1, index));\n\n                // Snap to position\n                containerRef.current.scrollTo({\n                    top: clampedIndex * ITEM_HEIGHT,\n                    behavior: 'smooth',\n                });\n\n                onChange(items[clampedIndex]);\n                isScrollingRef.current = false;\n            }\n        }, 100);\n    };\n\n    const handleItemClick = (item: number, index: number) => {\n        if (containerRef.current) {\n            containerRef.current.scrollTo({\n                top: index * ITEM_HEIGHT,\n                behavior: 'smooth',\n            });\n            onChange(item);\n        }\n    };\n\n    return (\n        <div className=\"flex flex-col items-center\">\n            <span className=\"text-[10px] font-bold text-muted-foreground uppercase tracking-wider mb-2\">\n                {label}\n            </span>\n            <div className=\"relative\">\n                {/* Selection highlight */}\n                <div\n                    className=\"absolute left-0 right-0 bg-primary/10 rounded-lg pointer-events-none z-0\"\n                    style={{\n                        top: ITEM_HEIGHT * 2,\n                        height: ITEM_HEIGHT,\n                    }}\n                />\n\n                {/* Gradient overlays */}\n                <div className=\"absolute inset-x-0 top-0 h-16 bg-gradient-to-b from-background to-transparent pointer-events-none z-10\" />\n                <div className=\"absolute inset-x-0 bottom-0 h-16 bg-gradient-to-t from-background to-transparent pointer-events-none z-10\" />\n\n                <div\n                    ref={containerRef}\n                    onScroll={handleScroll}\n                    className=\"overflow-y-auto scrollbar-hide\"\n                    style={{\n                        height: ITEM_HEIGHT * VISIBLE_ITEMS,\n                        scrollSnapType: 'y mandatory',\n                    }}\n                >\n                    {/* Top padding */}\n                    <div style={{ height: ITEM_HEIGHT * 2 }} />\n\n                    {items.map((item, index) => {\n                        const isSelected = item === value;\n                        return (\n                            <button\n                                key={item}\n                                type=\"button\"\n                                onClick={() => handleItemClick(item, index)}\n                                className={cn(\n                                    'w-16 flex items-center justify-center text-lg font-bold transition-all',\n                                    isSelected\n                                        ? 'text-primary scale-110'\n                                        : 'text-muted-foreground/50 hover:text-muted-foreground'\n                                )}\n                                style={{\n                                    height: ITEM_HEIGHT,\n                                    scrollSnapAlign: 'center',\n                                }}\n                            >\n                                {item.toString().padStart(2, '0')}\n                            </button>\n                        );\n                    })}\n\n                    {/* Bottom padding */}\n                    <div style={{ height: ITEM_HEIGHT * 2 }} />\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport function TimePickerInput({\n    time,\n    setTime,\n    label,\n    placeholder = '00:00',\n    disabled = false,\n    className,\n    size = 'md',\n}: TimePickerInputProps) {\n    const [isOpen, setIsOpen] = React.useState(false);\n    const [hours, minutes] = time ? time.split(':').map(Number) : [0, 0];\n\n    const handleHourChange = (h: number) => {\n        setTime(`${h.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`);\n    };\n\n    const handleMinuteChange = (m: number) => {\n        setTime(`${hours.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}`);\n    };\n\n    const sizeClasses = {\n        sm: 'h-10 text-sm',\n        md: 'h-12 text-base',\n        lg: 'h-14 text-lg',\n    };\n\n    const hourItems = Array.from({ length: 24 }, (_, i) => i);\n    const minuteItems = Array.from({ length: 60 }, (_, i) => i);\n\n    return (\n        <div className={cn('space-y-2', className)}>\n            {label && <Label className=\"text-xs font-bold text-muted-foreground ml-1\">{label}</Label>}\n            <Popover open={isOpen} onOpenChange={setIsOpen}>\n                <PopoverTrigger asChild>\n                    <Button\n                        variant=\"outline\"\n                        disabled={disabled}\n                        className={cn(\n                            'w-full justify-start text-left font-bold pl-3 pr-3 rounded-xl bg-white/50 dark:bg-black/20 border-white/20 hover:bg-white/60 dark:hover:bg-black/30 transition-all',\n                            sizeClasses[size],\n                            !time && 'text-muted-foreground font-normal'\n                        )}\n                    >\n                        <Clock className=\"mr-2 h-4 w-4 opacity-70\" />\n                        <span className=\"font-mono tracking-wider\">{time || placeholder}</span>\n                    </Button>\n                </PopoverTrigger>\n                <PopoverContent className=\"w-auto p-6 rounded-2xl glass border-white/20\" align=\"start\">\n                    <div className=\"flex items-center gap-2\">\n                        <WheelColumn\n                            items={hourItems}\n                            value={hours}\n                            onChange={handleHourChange}\n                            label=\"ÊôÇ\"\n                        />\n\n                        <span className=\"text-3xl font-black text-primary/50 mt-6\">:</span>\n\n                        <WheelColumn\n                            items={minuteItems}\n                            value={minutes}\n                            onChange={handleMinuteChange}\n                            label=\"ÂàÜ\"\n                        />\n                    </div>\n\n                    <div className=\"mt-4 pt-3 border-t border-white/10 flex justify-end\">\n                        <Button\n                            size=\"sm\"\n                            className=\"rounded-full gradient-primary px-6\"\n                            onClick={() => setIsOpen(false)}\n                        >\n                            ÂÆå‰∫Ü\n                        </Button>\n                    </div>\n                </PopoverContent>\n            </Popover>\n        </div>\n    );\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/contexts/AuthContext.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'getDoc' is defined but never used.",
        "line": 11,
        "column": 23,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 11,
        "endColumn": 29
      }
    ],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 1,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { createContext, useContext, useEffect, useState, ReactNode } from 'react';\nimport {\n    User as FirebaseUser,\n    onAuthStateChanged,\n    signInWithPopup,\n    GoogleAuthProvider,\n    signOut as firebaseSignOut\n} from 'firebase/auth';\nimport { doc, setDoc, getDoc, serverTimestamp, onSnapshot } from 'firebase/firestore';\nimport { auth, db } from '@/lib/firebase';\nimport type { User } from '@/lib/types';\n\ninterface AuthContextType {\n    user: FirebaseUser | null;\n    userProfile: User | null;\n    loading: boolean;\n    signInWithGoogle: () => Promise<void>;\n    signOut: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n    const [user, setUser] = useState<FirebaseUser | null>(null);\n    const [userProfile, setUserProfile] = useState<User | null>(null);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        let unsubscribeProfile: (() => void) | null = null;\n\n        const unsubscribeAuth = onAuthStateChanged(auth, async (firebaseUser) => {\n            // „É¶„Éº„Ç∂„ÉºÂàá„ÇäÊõø„Åà„Å™„Å©„ÅßÂÜçÁô∫ÁÅ´„Åó„ÅüÂ†¥Âêà„ÄÅÂâç„ÅÆ„É™„Çπ„Éä„Éº„ÇíËß£Èô§\n            if (unsubscribeProfile) {\n                unsubscribeProfile();\n                unsubscribeProfile = null;\n            }\n\n            setUser(firebaseUser);\n\n            if (firebaseUser) {\n                const userRef = doc(db, 'users', firebaseUser.uid);\n\n                // „É™„Ç¢„É´„Çø„Ç§„É†„É™„Çπ„Éä„Éº„ÇíË®≠ÂÆö\n                unsubscribeProfile = onSnapshot(userRef, async (docSnap) => {\n                    if (docSnap.exists()) {\n                        setUserProfile({ uid: firebaseUser.uid, ...docSnap.data() } as User);\n                    } else {\n                        // ÂàùÂõû„É≠„Ç∞„Ç§„É≥ÊôÇ„Å™„Å©„ÄÅ„Éâ„Ç≠„É•„É°„É≥„Éà„Åå„Å™„ÅÑÂ†¥Âêà„ÅØ‰ΩúÊàê\n                        const newUser: Record<string, unknown> = {\n                            displayName: firebaseUser.displayName || '„É¶„Éº„Ç∂„Éº',\n                            settings: { theme: 'system' },\n                            createdAt: serverTimestamp(),\n                            updatedAt: serverTimestamp(),\n                        };\n                        if (firebaseUser.photoURL) {\n                            newUser.avatarUrl = firebaseUser.photoURL;\n                        }\n                        if (firebaseUser.email) {\n                            newUser.email = firebaseUser.email;\n                        }\n\n                        try {\n                            await setDoc(userRef, newUser);\n                            // setDocÂæå„ÅÆÊõ¥Êñ∞„ÅØ„É™„Çπ„Éä„Éº„ÅåÊãæ„ÅÜ„Åå„ÄÅÂç≥ÊôÇÂèçÊò†„ÅÆ„Åü„ÇÅ\n                            setUserProfile({ uid: firebaseUser.uid, ...newUser } as User);\n                        } catch (e) {\n                            console.error(\"Error creating user profile:\", e);\n                        }\n                    }\n                    setLoading(false);\n                }, (error) => {\n                    console.error(\"Profile sync error:\", error);\n                    setLoading(false);\n                });\n            } else {\n                setUserProfile(null);\n                setLoading(false);\n            }\n        });\n\n        // „ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó\n        return () => {\n            unsubscribeAuth();\n            if (unsubscribeProfile) {\n                unsubscribeProfile();\n            }\n        };\n    }, []);\n\n    const signInWithGoogle = async () => {\n        const provider = new GoogleAuthProvider();\n        await signInWithPopup(auth, provider);\n    };\n\n    const signOut = async () => {\n        await firebaseSignOut(auth);\n    };\n\n    return (\n        <AuthContext.Provider value={{ user, userProfile, loading, signInWithGoogle, signOut }}>\n            {children}\n        </AuthContext.Provider>\n    );\n}\n\nexport function useAuth() {\n    const context = useContext(AuthContext);\n    if (context === undefined) {\n        throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/contexts/PetContext.tsx",
    "messages": [
      {
        "ruleId": "react-hooks/set-state-in-effect",
        "severity": 2,
        "message": "Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/contexts/PetContext.tsx:41:17\n  39 |                 // If current pet was deleted (or permission lost), fallback\n  40 |                 const fallback = pets.length > 0 ? pets[0] : null;\n> 41 |                 setSelectedPet(fallback);\n     |                 ^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  42 |             } else {\n  43 |                 // Update pet data in case name/avatar changed\n  44 |                 if (JSON.stringify(stillExists) !== JSON.stringify(selectedPet)) {",
        "line": 41,
        "column": 17,
        "nodeType": null,
        "endLine": 41,
        "endColumn": 31
      },
      {
        "ruleId": "react-hooks/exhaustive-deps",
        "severity": 1,
        "message": "React Hook useEffect has a missing dependency: 'selectedPet'. Either include it or remove the dependency array.",
        "line": 64,
        "column": 8,
        "nodeType": "ArrayExpression",
        "endLine": 64,
        "endColumn": 27,
        "suggestions": [
          {
            "desc": "Update the dependencies array to be: [pets, petsLoading, selectedPet]",
            "fix": {
              "range": [2384, 2403],
              "text": "[pets, petsLoading, selectedPet]"
            }
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 1,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { createContext, useContext, useState, ReactNode, useEffect } from 'react';\nimport type { Pet } from '@/lib/types';\nimport { usePets } from '@/hooks/usePets';\n\ninterface PetContextType {\n    selectedPet: Pet | null;\n    setSelectedPet: (pet: Pet | null) => void;\n    isPetLoading: boolean;\n}\n\nconst PetContext = createContext<PetContextType | undefined>(undefined);\n\nexport function PetProvider({ children }: { children: ReactNode }) {\n    const [selectedPet, setSelectedPetState] = useState<Pet | null>(null);\n    const { pets, loading: petsLoading } = usePets();\n    const [isInitialized, setIsInitialized] = useState(false);\n\n    // Wrapper for setSelectedPet to handle persistence\n    const setSelectedPet = (pet: Pet | null) => {\n        setSelectedPetState(pet);\n        if (pet) {\n            localStorage.setItem('selectedPetId', pet.id);\n        } else {\n            localStorage.removeItem('selectedPetId');\n        }\n    };\n\n    useEffect(() => {\n        if (petsLoading) return;\n\n        const storedPetId = localStorage.getItem('selectedPetId');\n\n        if (selectedPet) {\n            // Check if selected pet still exists\n            const stillExists = pets.find(p => p.id === selectedPet.id);\n            if (!stillExists) {\n                // If current pet was deleted (or permission lost), fallback\n                const fallback = pets.length > 0 ? pets[0] : null;\n                setSelectedPet(fallback);\n            } else {\n                // Update pet data in case name/avatar changed\n                if (JSON.stringify(stillExists) !== JSON.stringify(selectedPet)) {\n                    setSelectedPetState(stillExists); // Don't trigger persistence write unnecessarily loop, but here it's fine\n                }\n            }\n        } else {\n            // No pet selected currently\n            if (storedPetId) {\n                const storedPet = pets.find(p => p.id === storedPetId);\n                if (storedPet) {\n                    setSelectedPet(storedPet);\n                } else if (pets.length > 0) {\n                    // Stored ID not found, default to first\n                    setSelectedPet(pets[0]);\n                }\n            } else if (pets.length > 0) {\n                // No stored ID, default to first\n                setSelectedPet(pets[0]);\n            }\n        }\n        setIsInitialized(true);\n    }, [pets, petsLoading]);\n\n    return (\n        <PetContext.Provider value={{ selectedPet, setSelectedPet, isPetLoading: petsLoading || !isInitialized }}>\n            {children}\n        </PetContext.Provider>\n    );\n}\n\nexport function usePetContext() {\n    const context = useContext(PetContext);\n    if (context === undefined) {\n        throw new Error('usePetContext must be used within a PetProvider');\n    }\n    return context;\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/hooks/useCustomTasks.ts",
    "messages": [
      {
        "ruleId": "react-hooks/immutability",
        "severity": 2,
        "message": "Error: Cannot access variable before it is declared\n\n`seedDefaults` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/hooks/useCustomTasks.ts:46:23\n  44 |                 // „ÅÑ„ÇÑ„ÄÅÂçò„Å´Êõ∏„ÅçËæº„ÇÅ„Å∞Ê¨°„ÅØempty„Åß„ÅØ„Å™„Åè„Å™„Çã„ÅÆ„Åß„É´„Éº„Éó„ÅØÊ≠¢„Åæ„Çã„ÅØ„Åö„ÄÇ\n  45 |\n> 46 |                 await seedDefaults(petId, user.uid);\n     |                       ^^^^^^^^^^^^ `seedDefaults` accessed before it is declared\n  47 |                 return;\n  48 |             }\n  49 |\n\n/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/hooks/useCustomTasks.ts:61:5\n  59 |     }, [petId, user]);\n  60 |\n> 61 |     const seedDefaults = async (targetPetId: string, userId: string) => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 62 |         // ÈáçË§áÂÆüË°åÈò≤Ê≠¢„ÅÆ„Åü„ÇÅ„ÄÅÂÜçÂ∫¶get„Åó„Å¶Á¢∫Ë™ç\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 63 |         const q = query(collection(db, 'pets', targetPetId, 'tasks'));\n     ‚Ä¶\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 80 |         await batch.commit();\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 81 |     };\n     | ^^^^^^^ `seedDefaults` is declared here\n  82 |\n  83 |     const addTask = useCallback(async (taskData: { name: string; emoji: string }) => {\n  84 |         if (!petId || !user) throw new Error('„Éö„ÉÉ„Éà„ÅåÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');",
        "line": 46,
        "column": 23,
        "nodeType": null,
        "endLine": 46,
        "endColumn": 35
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport {\n    collection, query, orderBy, onSnapshot, addDoc, updateDoc, deleteDoc, doc, serverTimestamp, writeBatch, getDocs\n} from 'firebase/firestore';\nimport { db } from '@/lib/firebase';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { type CustomTask, ENTRY_TAGS } from '@/lib/types';\n\nexport function useCustomTasks(petId: string | null) {\n    const { user } = useAuth();\n    const [tasks, setTasks] = useState<CustomTask[]>([]);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        if (!petId || !user) {\n            setTasks([]);\n            setLoading(false);\n            return;\n        }\n\n        const tasksQuery = query(\n            collection(db, 'pets', petId, 'tasks'),\n            orderBy('order', 'asc')\n        );\n\n        const unsubscribe = onSnapshot(tasksQuery, async (snapshot) => {\n            if (snapshot.empty) {\n                // „Çø„Çπ„ÇØ„ÅåÁ©∫„ÅÆÂ†¥Âêà„ÄÅ„Éá„Éï„Ç©„É´„ÉàÂÄ§„Çí„Ç∑„Éº„Éâ„Åô„Çã\n                // ÁÑ°Èôê„É´„Éº„ÉóÈò≤Ê≠¢„ÅÆ„Åü„ÇÅ„ÄÅ‰∏ÄÂ∫¶„Å†„ÅëÂÆüË°å„Åô„Çã„Çà„ÅÜ„Å´„ÉÅ„Çß„ÉÉ„ÇØ„ÅåÂøÖË¶Å„Å†„Åå„ÄÅ\n                // onSnapshot„ÅØ„Éá„Éº„ÇøÂ§âÊõ¥ÊôÇ„ÅÆ„ÅøÁô∫ÁÅ´„Åô„Çã„ÄÇ\n                // „Åü„Å†„Åó„ÄÅÁ©∫Âà§ÂÆö -> writeBatch -> „Çπ„ÉÜ„Éº„ÉàÊõ¥Êñ∞ -> SnapshotÁô∫ÁÅ´ -> „Éá„Éº„Çø„ÅÇ„Çä -> ‰Ωï„ÇÇ„Åó„Å™„ÅÑ\n                // „Å®„ÅÑ„ÅÜÊµÅ„Çå„Å´„Å™„Çã„ÅØ„Åö„ÄÇ\n\n                // „Åü„Å†„Åó„ÄÅsnapshot.empty„ÅØ„Äå‰∏ÄËá¥„Åô„Çã„Éâ„Ç≠„É•„É°„É≥„Éà„Åå„Å™„ÅÑ„ÄçÂ†¥Âêà\n                // „Åì„Åì„ÅßÊõ∏„ÅçËæº„ÇÄ„Å®„ÄÅÂç≥Â∫ß„Å´Êñ∞„Åó„ÅÑsnapshot„ÅåÊµÅ„Çå„Å¶„Åè„Çã\n\n                // ÊòéÁ§∫ÁöÑ„Å´ÂàùÊúüÂåñ„Éï„É©„Ç∞„Å™„Å©„ÇíÁ¢∫Ë™ç„Åô„ÇãÊñπ„ÅåÂÆâÂÖ®„Å†„Åå„ÄÅÁ∞°ÊòìÁöÑ„Å´ÂÆüË£Ö„Åô„Çã„ÄÇ\n                // ÂêåÊôÇÂ§öÁô∫ÁöÑ„Å™Êõ∏„ÅçËæº„Åø„ÇíÈò≤„Åê„Åü„ÇÅ„ÄÅ„Åì„Åì„Åß„ÅÆÊõ∏„ÅçËæº„Åø„ÅØÈùûÂêåÊúü„ÅßË°å„ÅÑ„ÄÅ„Åã„Å§„É≠„ÉÉ„ÇØ„ÅåÂøÖË¶Å„Åã„ÇÇÔºü\n                // React„ÅÆuseEffectÂÜÖ„Å™„ÅÆ„Åß„ÄÅ„Éû„Ç¶„É≥„ÉàÊôÇ„ÅÆ1Âõû„ÅÆ„Åø...„Åß„ÅØ„Å™„ÅÑ„ÄÇsnapshot„ÅØ‰ΩïÂ∫¶„Åß„ÇÇÊù•„Çã„ÄÇ\n\n                // Êö´ÂÆöÂØæÁ≠ñ: loading„ÅåÂÆå‰∫Ü„Åó„Å¶„ÅÑ„Å™„ÅÑÂàùÂõû„ÅÆ„Åø„ÉÅ„Çß„ÉÉ„ÇØ„Åô„ÇãÔºü\n                // „ÅÑ„ÇÑ„ÄÅÂçò„Å´Êõ∏„ÅçËæº„ÇÅ„Å∞Ê¨°„ÅØempty„Åß„ÅØ„Å™„Åè„Å™„Çã„ÅÆ„Åß„É´„Éº„Éó„ÅØÊ≠¢„Åæ„Çã„ÅØ„Åö„ÄÇ\n\n                await seedDefaults(petId, user.uid);\n                return;\n            }\n\n            const tasksData = snapshot.docs.map((doc) => ({\n                id: doc.id,\n                ...doc.data(),\n            })) as CustomTask[];\n            setTasks(tasksData);\n            setLoading(false);\n        });\n\n        return () => unsubscribe();\n    }, [petId, user]);\n\n    const seedDefaults = async (targetPetId: string, userId: string) => {\n        // ÈáçË§áÂÆüË°åÈò≤Ê≠¢„ÅÆ„Åü„ÇÅ„ÄÅÂÜçÂ∫¶get„Åó„Å¶Á¢∫Ë™ç\n        const q = query(collection(db, 'pets', targetPetId, 'tasks'));\n        const snap = await getDocs(q);\n        if (!snap.empty) return;\n\n        const batch = writeBatch(db);\n        ENTRY_TAGS.forEach((tag, index) => {\n            const newRef = doc(collection(db, 'pets', targetPetId, 'tasks'));\n            batch.set(newRef, {\n                name: tag.label,\n                emoji: tag.emoji,\n                order: index,\n                createdBy: userId,\n                updatedBy: userId,\n                createdAt: serverTimestamp(),\n                updatedAt: serverTimestamp(),\n            });\n        });\n        await batch.commit();\n    };\n\n    const addTask = useCallback(async (taskData: { name: string; emoji: string }) => {\n        if (!petId || !user) throw new Error('„Éö„ÉÉ„Éà„ÅåÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');\n\n        const maxOrder = tasks.length > 0 ? Math.max(...tasks.map((t) => t.order)) + 1 : 0;\n\n        await addDoc(collection(db, 'pets', petId, 'tasks'), {\n            name: taskData.name,\n            emoji: taskData.emoji,\n            order: maxOrder,\n            createdBy: user.uid,\n            updatedBy: user.uid,\n            createdAt: serverTimestamp(),\n            updatedAt: serverTimestamp(),\n        });\n    }, [petId, user, tasks]);\n\n    const updateTask = useCallback(async (taskId: string, taskData: Partial<{ name: string; emoji: string }>) => {\n        if (!petId || !user) throw new Error('„Éö„ÉÉ„Éà„ÅåÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');\n\n        const taskRef = doc(db, 'pets', petId, 'tasks', taskId);\n        await updateDoc(taskRef, {\n            ...taskData,\n            updatedBy: user.uid,\n            updatedAt: serverTimestamp(),\n        });\n    }, [petId, user]);\n\n    const deleteTask = useCallback(async (taskId: string) => {\n        if (!petId) throw new Error('„Éö„ÉÉ„Éà„ÅåÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');\n\n        const taskRef = doc(db, 'pets', petId, 'tasks', taskId);\n        await deleteDoc(taskRef);\n    }, [petId]);\n\n    const reorderTasks = useCallback(async (reorderedTasks: CustomTask[]) => {\n        if (!petId || !user) throw new Error('„Éö„ÉÉ„Éà„ÅåÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');\n\n        const batch = writeBatch(db);\n        reorderedTasks.forEach((task, index) => {\n            const taskRef = doc(db, 'pets', petId, 'tasks', task.id);\n            batch.update(taskRef, {\n                order: index,\n                updatedBy: user.uid,\n                updatedAt: serverTimestamp(),\n            });\n        });\n\n        await batch.commit();\n    }, [petId, user]);\n\n    return { tasks, loading, addTask, updateTask, deleteTask, reorderTasks };\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/hooks/useEntries.ts",
    "messages": [
      {
        "ruleId": "react-hooks/set-state-in-effect",
        "severity": 2,
        "message": "Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/hooks/useEntries.ts:24:13\n  22 |     useEffect(() => {\n  23 |         if (!petId || !user) {\n> 24 |             setEntries([]);\n     |             ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  25 |             setLoading(false);\n  26 |             return;\n  27 |         }",
        "line": 24,
        "column": 13,
        "nodeType": null,
        "endLine": 24,
        "endColumn": 23
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 156,
        "column": 37,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 156,
        "endColumn": 40,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [5865, 5868], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [5865, 5868], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 157,
        "column": 45,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 157,
        "endColumn": 48,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [5944, 5947], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [5944, 5947], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 219,
        "column": 14,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 219,
        "endColumn": 17,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [8336, 8339], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [8336, 8339], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "react-hooks/exhaustive-deps",
        "severity": 1,
        "message": "React Hook useCallback has a missing dependency: 'updateMonthlySummary'. Either include it or remove the dependency array.",
        "line": 221,
        "column": 8,
        "nodeType": "ArrayExpression",
        "endLine": 221,
        "endColumn": 21,
        "suggestions": [
          {
            "desc": "Update the dependencies array to be: [petId, updateMonthlySummary, user]",
            "fix": {
              "range": [8350, 8363],
              "text": "[petId, updateMonthlySummary, user]"
            }
          }
        ]
      },
      {
        "ruleId": "react-hooks/exhaustive-deps",
        "severity": 1,
        "message": "React Hook useCallback has a missing dependency: 'updateMonthlySummary'. Either include it or remove the dependency array.",
        "line": 272,
        "column": 8,
        "nodeType": "ArrayExpression",
        "endLine": 272,
        "endColumn": 21,
        "suggestions": [
          {
            "desc": "Update the dependencies array to be: [petId, updateMonthlySummary, user]",
            "fix": {
              "range": [10671, 10684],
              "text": "[petId, updateMonthlySummary, user]"
            }
          }
        ]
      },
      {
        "ruleId": "react-hooks/exhaustive-deps",
        "severity": 1,
        "message": "React Hook useCallback has a missing dependency: 'updateMonthlySummary'. Either include it or remove the dependency array.",
        "line": 288,
        "column": 8,
        "nodeType": "ArrayExpression",
        "endLine": 288,
        "endColumn": 15,
        "suggestions": [
          {
            "desc": "Update the dependencies array to be: [petId, updateMonthlySummary]",
            "fix": {
              "range": [11267, 11274],
              "text": "[petId, updateMonthlySummary]"
            }
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 4,
    "fatalErrorCount": 0,
    "warningCount": 3,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useState, useEffect, useCallback, useRef } from 'react';\nimport {\n    collection, query, orderBy, onSnapshot, addDoc, updateDoc, deleteDoc, doc, serverTimestamp, Timestamp, limit as firestoreLimit, startAfter, getDocs, QueryDocumentSnapshot, getDoc, setDoc\n} from 'firebase/firestore';\nimport { db } from '@/lib/firebase';\nimport { useAuth } from '@/contexts/AuthContext';\nimport type { Entry, TimeType, EntrySummary, MonthlyEntries } from '@/lib/types';\nimport { format } from 'date-fns';\n\nconst PAGE_SIZE = 20;\n\n// Helper to get YYYY-MM document ID\nconst getMonthId = (date: Date) => format(date, 'yyyy-MM');\n\nexport function useCalendarEntries(petId: string | null, currentMonth: Date) {\n    const { user } = useAuth();\n    const [entries, setEntries] = useState<EntrySummary[]>([]);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        if (!petId || !user) {\n            setEntries([]);\n            setLoading(false);\n            return;\n        }\n\n        const monthId = getMonthId(currentMonth);\n        const docRef = doc(db, 'pets', petId, 'entry_months', monthId);\n\n        const unsubscribe = onSnapshot(docRef, (docSnap) => {\n            if (docSnap.exists()) {\n                const data = docSnap.data() as MonthlyEntries;\n                // Êó•‰ªòÈ†Ü„Å´„ÇΩ„Éº„ÉàÔºà„ÇØ„É©„Ç§„Ç¢„É≥„Éà„Çµ„Ç§„ÉâÔºâ\n                const sorted = (data.entries || []).sort((a, b) => b.date.toMillis() - a.date.toMillis());\n                setEntries(sorted);\n            } else {\n                setEntries([]);\n            }\n            setLoading(false);\n        });\n\n        return () => unsubscribe();\n    }, [petId, user, currentMonth]);\n\n    return { entries, loading };\n}\n\nexport function useEntries(petId: string | null) {\n    const { user } = useAuth();\n    // Pagination logic remains same for List View\n    const [entries, setEntries] = useState<Entry[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [hasMore, setHasMore] = useState(true);\n    const [loadingMore, setLoadingMore] = useState(false);\n    const lastDocRef = useRef<QueryDocumentSnapshot | null>(null);\n\n    // Initial Load (Pagination)\n    useEffect(() => {\n        if (!petId || !user) {\n            setEntries([]);\n            setLoading(false);\n            setHasMore(true);\n            return;\n        }\n\n        const entriesQuery = query(\n            collection(db, 'pets', petId, 'entries'),\n            orderBy('date', 'desc'),\n            firestoreLimit(PAGE_SIZE)\n        );\n\n        const unsubscribe = onSnapshot(entriesQuery, (snapshot) => {\n            const entriesData = snapshot.docs.map((doc) => ({ id: doc.id, ...doc.data() })) as Entry[];\n            setEntries(entriesData);\n            setLoading(false);\n            setHasMore(snapshot.docs.length === PAGE_SIZE);\n            lastDocRef.current = snapshot.docs[snapshot.docs.length - 1] || null;\n        });\n\n        return () => unsubscribe();\n    }, [petId, user]);\n\n    const loadMore = useCallback(async () => {\n        if (!petId || !lastDocRef.current || loadingMore || !hasMore) return;\n\n        setLoadingMore(true);\n        try {\n            const nextQuery = query(\n                collection(db, 'pets', petId, 'entries'),\n                orderBy('date', 'desc'),\n                startAfter(lastDocRef.current),\n                firestoreLimit(PAGE_SIZE)\n            );\n\n            const snapshot = await getDocs(nextQuery);\n            const newEntries = snapshot.docs.map((doc) => ({ id: doc.id, ...doc.data() })) as Entry[];\n\n            setEntries((prev) => {\n                const existingIds = new Set(prev.map((e) => e.id));\n                const uniqueNewEntries = newEntries.filter((e) => !existingIds.has(e.id));\n                return [...prev, ...uniqueNewEntries];\n            });\n\n            setHasMore(snapshot.docs.length === PAGE_SIZE);\n            lastDocRef.current = snapshot.docs[snapshot.docs.length - 1] || null;\n        } finally {\n            setLoadingMore(false);\n        }\n    }, [petId, loadingMore, hasMore]);\n\n    // Update Monthly Summary Helper\n    const updateMonthlySummary = async (\n        type: 'add' | 'update' | 'delete',\n        entryData: Partial<Entry> & { id: string; date: Timestamp },\n        oldDate?: Timestamp\n    ) => {\n        if (!petId) return;\n\n        const processUpdate = async (targetDate: Date, action: 'add' | 'remove' | 'update', data?: EntrySummary) => {\n            const monthId = getMonthId(targetDate);\n            const monthRef = doc(db, 'pets', petId, 'entry_months', monthId);\n            const monthSnap = await getDoc(monthRef);\n\n            let currentEntries: EntrySummary[] = monthSnap.exists()\n                ? (monthSnap.data() as MonthlyEntries).entries\n                : [];\n\n            if (action === 'add' && data) {\n                currentEntries.push(data);\n            } else if (action === 'remove') {\n                currentEntries = currentEntries.filter(e => e.id !== entryData.id);\n            } else if (action === 'update' && data) {\n                currentEntries = currentEntries.map(e => e.id === entryData.id ? data : e);\n            }\n\n            // Clean up empty months or update\n            if (currentEntries.length === 0 && monthSnap.exists()) {\n                await setDoc(monthRef, { entries: [] }, { merge: true }); // Keep doc empty or delete? Keep empty simpler.\n            } else {\n                await setDoc(monthRef, {\n                    id: monthId,\n                    entries: currentEntries\n                }, { merge: true });\n            }\n        };\n\n        const newDate = entryData.date.toDate();\n        const summary: EntrySummary = {\n            id: entryData.id,\n            date: entryData.date,\n            endDate: entryData.endDate,\n            title: entryData.title,\n            body: entryData.body,\n            type: entryData.type as any, // Cast for safety if partial\n            timeType: entryData.timeType as any,\n            tags: entryData.tags || [],\n            firstImageUrl: entryData.imageUrls?.[0],\n            isCompleted: entryData.isCompleted\n        };\n\n        if (type === 'add') {\n            await processUpdate(newDate, 'add', summary);\n        } else if (type === 'delete') {\n            await processUpdate(newDate, 'remove');\n        } else if (type === 'update') {\n            const oldDateObj = oldDate?.toDate();\n            // If date changed month, remove from old, add to new\n            if (oldDateObj && getMonthId(oldDateObj) !== getMonthId(newDate)) {\n                await processUpdate(oldDateObj, 'remove');\n                await processUpdate(newDate, 'add', summary);\n            } else {\n                await processUpdate(newDate, 'update', summary);\n            }\n        }\n    };\n\n\n    const addEntry = useCallback(async (entryData: {\n        type: 'diary' | 'schedule';\n        timeType?: TimeType;\n        title?: string;\n        body?: string;\n        tags: string[];\n        imageUrls: string[];\n        friendIds?: string[];\n        date: Date;\n        endDate?: Date;\n        isCompleted?: boolean;\n    }) => {\n        if (!petId || !user) throw new Error('„Éö„ÉÉ„Éà„ÅåÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');\n\n        const docData: Record<string, unknown> = {\n            type: entryData.type,\n            timeType: entryData.timeType || 'point',\n            tags: entryData.tags,\n            imageUrls: entryData.imageUrls,\n            date: Timestamp.fromDate(entryData.date),\n            createdBy: user.uid,\n            updatedBy: user.uid,\n            createdAt: serverTimestamp(),\n            updatedAt: serverTimestamp(),\n        };\n        if (entryData.title) docData.title = entryData.title;\n        if (entryData.body) docData.body = entryData.body;\n        if (entryData.friendIds) docData.friendIds = entryData.friendIds;\n        if (entryData.endDate) docData.endDate = Timestamp.fromDate(entryData.endDate);\n        if (entryData.isCompleted !== undefined) docData.isCompleted = entryData.isCompleted;\n\n        const docRef = await addDoc(collection(db, 'pets', petId, 'entries'), docData);\n\n        // Update Summary\n        await updateMonthlySummary('add', {\n            id: docRef.id,\n            ...entryData,\n            date: Timestamp.fromDate(entryData.date),\n            endDate: entryData.endDate ? Timestamp.fromDate(entryData.endDate) : undefined,\n        } as any);\n\n    }, [petId, user]);\n\n    const updateEntry = useCallback(async (entryId: string, entryData: Partial<{\n        type: 'diary' | 'schedule';\n        timeType: TimeType;\n        title?: string;\n        body?: string;\n        tags: string[];\n        imageUrls: string[];\n        friendIds?: string[];\n        date: Date;\n        endDate?: Date;\n        isCompleted?: boolean;\n    }>) => {\n        if (!petId || !user) throw new Error('„Éö„ÉÉ„Éà„ÅåÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');\n\n        // Need old data to check date change\n        const oldEntryDoc = await getDoc(doc(db, 'pets', petId, 'entries', entryId));\n        if (!oldEntryDoc.exists()) throw new Error('Entry not found');\n        const oldData = oldEntryDoc.data() as Entry;\n\n        const updateData: Record<string, unknown> = {\n            updatedBy: user.uid,\n            updatedAt: serverTimestamp()\n        };\n        if (entryData.type !== undefined) updateData.type = entryData.type;\n        if (entryData.timeType !== undefined) updateData.timeType = entryData.timeType;\n        if (entryData.title !== undefined) updateData.title = entryData.title;\n        if (entryData.body !== undefined) updateData.body = entryData.body;\n        if (entryData.tags !== undefined) updateData.tags = entryData.tags;\n        if (entryData.imageUrls !== undefined) updateData.imageUrls = entryData.imageUrls;\n        if (entryData.friendIds !== undefined) updateData.friendIds = entryData.friendIds;\n        if (entryData.date !== undefined) updateData.date = Timestamp.fromDate(entryData.date);\n        if (entryData.endDate !== undefined) updateData.endDate = Timestamp.fromDate(entryData.endDate);\n        if (entryData.isCompleted !== undefined) updateData.isCompleted = entryData.isCompleted;\n\n        const entryRef = doc(db, 'pets', petId, 'entries', entryId);\n        await updateDoc(entryRef, updateData);\n\n        // Update Summary\n        // Merge old data with new data for complete summary object\n        const mergedData = {\n            ...oldData,\n            ...entryData,\n            id: entryId,\n            date: entryData.date ? Timestamp.fromDate(entryData.date) : oldData.date,\n            endDate: entryData.endDate ? Timestamp.fromDate(entryData.endDate) : (oldData.endDate || undefined)\n        };\n\n        await updateMonthlySummary('update', mergedData, oldData.date);\n\n    }, [petId, user]);\n\n    const deleteEntry = useCallback(async (entryId: string) => {\n        if (!petId) throw new Error('„Éö„ÉÉ„Éà„ÅåÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');\n\n        // Need data to find month\n        const oldEntryDoc = await getDoc(doc(db, 'pets', petId, 'entries', entryId));\n        if (!oldEntryDoc.exists()) return; // Already deleted\n        const oldData = oldEntryDoc.data() as Entry;\n\n        const entryRef = doc(db, 'pets', petId, 'entries', entryId);\n        await deleteDoc(entryRef);\n\n        // Update Summary\n        await updateMonthlySummary('delete', { id: entryId, date: oldData.date });\n\n    }, [petId]);\n\n    // Keep these helpers for list view if necessary, but Calendar should use useCalendarEntries\n    const getEntriesByDateRange = useCallback((startDate: Date, endDate: Date) => {\n        return entries.filter((entry) => {\n            const entryDate = entry.date.toDate();\n            return entryDate >= startDate && entryDate <= endDate;\n        });\n    }, [entries]);\n\n    const getEntriesByDate = useCallback((date: Date) => {\n        const startOfDay = new Date(date);\n        startOfDay.setHours(0, 0, 0, 0);\n        const endOfDay = new Date(date);\n        endOfDay.setHours(23, 59, 59, 999);\n        return getEntriesByDateRange(startOfDay, endOfDay);\n    }, [getEntriesByDateRange]);\n\n    const getScheduleEntries = useCallback(() => {\n        return entries.filter((entry) => entry.type === 'schedule' && !entry.isCompleted);\n    }, [entries]);\n\n    const getTodaySchedules = useCallback(() => {\n        const today = new Date();\n        today.setHours(0, 0, 0, 0);\n        const tomorrow = new Date(today);\n        tomorrow.setDate(tomorrow.getDate() + 1);\n        return entries.filter((entry) => {\n            if (entry.type !== 'schedule') return false;\n            const entryDate = entry.date.toDate();\n            // „Åì„Åì„Åß„Å†„Åë entries state „Çí‰Ωø„ÅÜ„Å®„ÄÅ„É™„Çπ„ÉàË°®Á§∫„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑ„Éá„Éº„ÇøÔºà„Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥Â§ñÔºâ„ÅåÂèñ„Çå„Å™„ÅÑÂèØËÉΩÊÄß„Åå„ÅÇ„Çã„ÄÇ\n            // Êú¨Êù•„ÅØ‰ªäÊó•„ÅÆ‰∫àÂÆöÁî®„ÅÆÂ∞ÇÁî®„Éï„ÉÉ„ÇØ„Çí‰Ωú„Çã„Åã„ÄÅ„Åì„Åì„Åß„ÇÇ Firestore „ÇØ„Ç®„É™„ÇíÊäï„Åí„Çã„Åπ„Åç„Å†„Åå\n            // „ÅÑ„Å£„Åü„ÇìÊó¢Â≠ò„É≠„Ç∏„ÉÉ„ÇØÁ∂≠ÊåÅÔºà„Åü„Å†„Åó„Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥„Åï„Çå„Å¶„ÅÑ„Çã„ÅÆ„Åß‰∏çÊ≠£Á¢∫„Å™„É™„Çπ„ÇØ„ÅÇ„ÇäÔºâ\n            // ‚Äª„Ç´„É¨„É≥„ÉÄ„ÉºÊîπ‰øÆ„Åå„É°„Ç§„É≥„Å™„ÅÆ„Åß‰ªäÂõû„ÅØ„Çπ„Ç≥„Éº„ÉóÂ§ñ„Å®„Åô„Çã\n            return entryDate >= today && entryDate < tomorrow;\n        });\n    }, [entries]);\n\n    return {\n        entries,\n        loading,\n        hasMore,\n        loadingMore,\n        loadMore,\n        addEntry,\n        updateEntry,\n        deleteEntry,\n        getEntriesByDate,\n        getEntriesByDateRange,\n        getScheduleEntries,\n        getTodaySchedules,\n    };\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/hooks/useEntry.ts",
    "messages": [
      {
        "ruleId": "react-hooks/set-state-in-effect",
        "severity": 2,
        "message": "Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/hooks/useEntry.ts:17:13\n  15 |     useEffect(() => {\n  16 |         if (!petId || !entryId || !user) {\n> 17 |             setEntry(null);\n     |             ^^^^^^^^ Avoid calling setState() directly within an effect\n  18 |             setLoading(false);\n  19 |             return;\n  20 |         }",
        "line": 17,
        "column": 13,
        "nodeType": null,
        "endLine": 17,
        "endColumn": 21
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useState, useEffect } from 'react';\nimport { doc, onSnapshot } from 'firebase/firestore';\nimport { db } from '@/lib/firebase';\nimport type { Entry } from '@/lib/types';\nimport { useAuth } from '@/contexts/AuthContext';\n\nexport function useEntry(petId: string | null, entryId: string | null) {\n    const { user } = useAuth();\n    const [entry, setEntry] = useState<Entry | null>(null);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState<Error | null>(null);\n\n    useEffect(() => {\n        if (!petId || !entryId || !user) {\n            setEntry(null);\n            setLoading(false);\n            return;\n        }\n\n        setLoading(true);\n        const entryRef = doc(db, 'pets', petId, 'entries', entryId);\n\n        const unsubscribe = onSnapshot(entryRef,\n            (docSnap) => {\n                if (docSnap.exists()) {\n                    setEntry({ id: docSnap.id, ...docSnap.data() } as Entry);\n                } else {\n                    setEntry(null);\n                }\n                setLoading(false);\n            },\n            (err) => {\n                console.error(\"Error fetching entry:\", err);\n                setError(err);\n                setLoading(false);\n            }\n        );\n\n        return () => unsubscribe();\n    }, [petId, entryId, user]);\n\n    return { entry, loading, error };\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/hooks/useFriends.ts",
    "messages": [
      {
        "ruleId": "react-hooks/set-state-in-effect",
        "severity": 2,
        "message": "Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/hooks/useFriends.ts:20:13\n  18 |     useEffect(() => {\n  19 |         if (!petId || !user) {\n> 20 |             setFriends([]);\n     |             ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  21 |             setLoading(false);\n  22 |             return;\n  23 |         }",
        "line": 20,
        "column": 13,
        "nodeType": null,
        "endLine": 20,
        "endColumn": 23
      },
      {
        "ruleId": "react-hooks/set-state-in-effect",
        "severity": 2,
        "message": "Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/hooks/useFriends.ts:121:13\n  119 |     useEffect(() => {\n  120 |         if (!petId || !user || !friendId) {\n> 121 |             setLoading(false);\n      |             ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  122 |             return;\n  123 |         }\n  124 |",
        "line": 121,
        "column": 13,
        "nodeType": null,
        "endLine": 121,
        "endColumn": 23
      }
    ],
    "suppressedMessages": [],
    "errorCount": 2,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport {\n    collection, query, onSnapshot, addDoc, updateDoc, deleteDoc, doc, serverTimestamp, Timestamp\n} from 'firebase/firestore';\nimport { db } from '@/lib/firebase';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { Friend, FriendSortOption } from '@/lib/types';\nimport { getCache, setCache, cacheKeys, invalidateCachePattern } from '@/lib/cache';\n\nexport function useFriends(petId: string | null) {\n    const { user } = useAuth();\n    const [friends, setFriends] = useState<Friend[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [sortOption, setSortOption] = useState<FriendSortOption>('metAt_desc');\n\n    useEffect(() => {\n        if (!petId || !user) {\n            setFriends([]);\n            setLoading(false);\n            return;\n        }\n\n        // „Ç≠„É£„ÉÉ„Ç∑„É•„Åã„ÇâÂàùÊúü„Éá„Éº„Çø„Çí„É≠„Éº„Éâ\n        const cacheKey = cacheKeys.friends(petId);\n        const cached = getCache<Friend[]>(cacheKey);\n        if (cached) {\n            setFriends(cached);\n            setLoading(false);\n        }\n\n        const friendsQuery = query(collection(db, 'pets', petId, 'friends'));\n\n        const unsubscribe = onSnapshot(friendsQuery, (snapshot) => {\n            const friendsData = snapshot.docs.map((doc) => ({ id: doc.id, ...doc.data() })) as Friend[];\n            setFriends(friendsData);\n            setCache(cacheKey, friendsData);\n            setLoading(false);\n        });\n\n        return () => unsubscribe();\n    }, [petId, user]);\n\n    // Helper to get timestamp in milliseconds (handles both Timestamp and serialized object)\n    const getMillis = (ts: Timestamp | { seconds: number; nanoseconds: number }) => {\n        if (ts instanceof Timestamp) return ts.toMillis();\n        if (typeof ts === 'object' && 'seconds' in ts) return ts.seconds * 1000;\n        return 0;\n    };\n\n    // Client-side sorting because we might want dynamic sorting without re-fetching\n    const sortedFriends = [...friends].sort((a, b) => {\n        if (sortOption === 'metAt_desc') {\n            return getMillis(b.metAt) - getMillis(a.metAt);\n        } else if (sortOption === 'metAt_asc') {\n            return getMillis(a.metAt) - getMillis(b.metAt);\n        } else if (sortOption === 'name_asc') {\n            return a.name.localeCompare(b.name, 'ja');\n        }\n        return 0;\n    });\n\n    const addFriend = useCallback(async (friendData: Omit<Friend, 'id' | 'createdAt' | 'updatedAt' | 'createdBy' | 'updatedBy' | 'metAt'> & { metAt: Date }) => {\n        if (!petId || !user) throw new Error('„Éö„ÉÉ„Éà„ÅåÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');\n\n        const docData = {\n            ...friendData,\n            metAt: Timestamp.fromDate(friendData.metAt),\n            createdBy: user.uid,\n            updatedBy: user.uid,\n            createdAt: serverTimestamp(),\n            updatedAt: serverTimestamp(),\n        };\n\n        await addDoc(collection(db, 'pets', petId, 'friends'), docData);\n        invalidateCachePattern(cacheKeys.friends(petId));\n    }, [petId, user]);\n\n    const updateFriend = useCallback(async (friendId: string, friendData: Partial<Omit<Friend, 'metAt'>> & { metAt?: Date }) => {\n        if (!petId || !user) throw new Error('„Éö„ÉÉ„Éà„ÅåÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');\n\n        const updateData: Record<string, unknown> = {\n            ...friendData,\n            updatedBy: user.uid,\n            updatedAt: serverTimestamp()\n        };\n        if (friendData.metAt) {\n            updateData.metAt = Timestamp.fromDate(friendData.metAt);\n        }\n\n        const friendRef = doc(db, 'pets', petId, 'friends', friendId);\n        await updateDoc(friendRef, updateData);\n    }, [petId, user]);\n\n    const deleteFriend = useCallback(async (friendId: string) => {\n        if (!petId) throw new Error('„Éö„ÉÉ„Éà„ÅåÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');\n\n        const friendRef = doc(db, 'pets', petId, 'friends', friendId);\n        await deleteDoc(friendRef);\n    }, [petId]);\n\n    return {\n        friends: sortedFriends,\n        loading,\n        sortOption,\n        setSortOption,\n        addFriend,\n        updateFriend,\n        deleteFriend\n    };\n}\n\nexport function useFriend(petId: string | null, friendId: string) {\n    const { user } = useAuth();\n    const [friend, setFriend] = useState<Friend | null>(null);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        if (!petId || !user || !friendId) {\n            setLoading(false);\n            return;\n        }\n\n        const friendRef = doc(db, 'pets', petId, 'friends', friendId);\n        const unsubscribe = onSnapshot(friendRef, (docSnap) => {\n            if (docSnap.exists()) {\n                setFriend({ id: docSnap.id, ...docSnap.data() } as Friend);\n            } else {\n                setFriend(null);\n            }\n            setLoading(false);\n        });\n\n        return () => unsubscribe();\n    }, [petId, user, friendId]);\n\n    return { friend, loading };\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/hooks/useImageUpload.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/hooks/useMembers.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'setDoc' is defined but never used.",
        "line": 5,
        "column": 105,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 5,
        "endColumn": 111
      },
      {
        "ruleId": "react-hooks/set-state-in-effect",
        "severity": 2,
        "message": "Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/hooks/useMembers.ts:19:13\n  17 |     useEffect(() => {\n  18 |         if (!petId || !user) {\n> 19 |             setMembers([]);\n     |             ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  20 |             setLoading(false);\n  21 |             return;\n  22 |         }",
        "line": 19,
        "column": 13,
        "nodeType": null,
        "endLine": 19,
        "endColumn": 23
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 98,
        "column": 21,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 98,
        "endColumn": 24,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [3972, 3975], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [3972, 3975], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 2,
    "fatalErrorCount": 0,
    "warningCount": 1,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport {\n    collection, query, onSnapshot, addDoc, updateDoc, doc, serverTimestamp, where, getDocs, writeBatch, setDoc, documentId,\n} from 'firebase/firestore';\nimport { db } from '@/lib/firebase';\nimport { useAuth } from '@/contexts/AuthContext';\nimport type { Member, MemberRole, User } from '@/lib/types';\n\nexport function useMembers(petId: string | null) {\n    const { user } = useAuth();\n    const [members, setMembers] = useState<Member[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [currentUserRole, setCurrentUserRole] = useState<MemberRole | null>(null);\n\n    useEffect(() => {\n        if (!petId || !user) {\n            setMembers([]);\n            setLoading(false);\n            return;\n        }\n\n        setLoading(true);\n        const membersQuery = query(collection(db, 'pets', petId, 'members'));\n        const unsubscribe = onSnapshot(membersQuery, async (snapshot) => {\n            const membersData = snapshot.docs.map((doc) => ({ id: doc.id, ...doc.data() })) as Member[];\n\n            // „É¶„Éº„Ç∂„ÉºÊÉÖÂ†±„ÇíÂèñÂæó\n            const userIds = Array.from(new Set(membersData.map(m => m.userId).filter(id => id)));\n            const usersMap: Record<string, Partial<User>> = {};\n\n            if (userIds.length > 0) {\n                try {\n                    // Firestore 'in' query limitation is 30 (previously 10). handling consistently.\n                    const chunks = [];\n                    for (let i = 0; i < userIds.length; i += 30) {\n                        chunks.push(userIds.slice(i, i + 30));\n                    }\n\n                    for (const chunk of chunks) {\n                        const q = query(collection(db, 'users'), where(documentId(), 'in', chunk));\n                        const userSnaps = await getDocs(q);\n                        userSnaps.docs.forEach(doc => {\n                            usersMap[doc.id] = doc.data() as User;\n                        });\n                    }\n                } catch (error) {\n                    console.error(\"Error fetching member profiles:\", error);\n                }\n            }\n\n            // merge profiles\n            const enrichedMembers = membersData.map(m => ({\n                ...m,\n                userProfile: usersMap[m.userId] ? {\n                    displayName: usersMap[m.userId].displayName || '',\n                    nickname: usersMap[m.userId].nickname,\n                    avatarUrl: usersMap[m.userId].avatarUrl\n                } : undefined\n            }));\n\n            // removed/declined „ÅØÈô§Â§ñ„Åó„Å¶Ë°®Á§∫\n            const activeMembers = enrichedMembers.filter((m) => m.status !== 'removed' && m.status !== 'declined');\n            setMembers(activeMembers);\n\n            // ÁèæÂú®„ÅÆ„É¶„Éº„Ç∂„Éº„ÅÆ„É≠„Éº„É´„ÇíÂèñÂæó\n            const currentMember = activeMembers.find((m) => m.userId === user.uid || m.id === user.uid);\n            setCurrentUserRole(currentMember?.role || null);\n\n            setLoading(false);\n        });\n\n        return () => unsubscribe();\n    }, [petId, user]);\n\n    // „É°„É≥„Éê„Éº„ÇíÊãõÂæÖÔºà„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„ÅßÔºâ\n    const inviteMember = useCallback(async (email: string, role: MemberRole = 'editor', petInfo?: { name: string; avatarUrl?: string }) => {\n        if (!petId || !user) throw new Error('„Éö„ÉÉ„Éà„ÅåÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');\n        if (currentUserRole !== 'owner') throw new Error('„Ç™„Éº„Éä„Éº„ÅÆ„ÅøÊãõÂæÖ„Åß„Åç„Åæ„Åô');\n\n        const emailLower = email.toLowerCase();\n\n        // Êó¢„Å´ÊãõÂæÖÊ∏à„Åø„ÅãÁ¢∫Ë™çÔºàpending „Åæ„Åü„ÅØ active „ÅÆ„ÅøÔºâ\n        const existingQuery = query(\n            collection(db, 'pets', petId, 'members'),\n            where('inviteEmail', '==', emailLower)\n        );\n        const existingSnap = await getDocs(existingQuery);\n        const existingMember = existingSnap.docs.find((doc) => {\n            const data = doc.data();\n            return data.status === 'pending' || data.status === 'active';\n        });\n        if (existingMember) {\n            throw new Error('„Åì„ÅÆ„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„ÅØÊó¢„Å´ÊãõÂæÖÊ∏à„Åø„Åæ„Åü„ÅØ„É°„É≥„Éê„Éº„Åß„Åô');\n        }\n\n        const data: any = {\n            userId: '', // ÊâøË´æÊôÇ„Å´Ë®≠ÂÆö\n            inviteEmail: emailLower,\n            role: role,\n            status: 'pending',\n            invitedBy: user.uid,\n            invitedAt: serverTimestamp(),\n            updatedBy: user.uid,\n            createdAt: serverTimestamp(),\n            updatedAt: serverTimestamp(),\n        };\n\n        if (petInfo) {\n            data.petName = petInfo.name;\n            if (petInfo.avatarUrl) data.petAvatarUrl = petInfo.avatarUrl;\n        }\n\n        await addDoc(collection(db, 'pets', petId, 'members'), data);\n    }, [petId, user, currentUserRole]);\n\n    // ÊãõÂæÖ„ÇíÊâøË´æ\n    const acceptInvitation = useCallback(async (memberId: string) => {\n        if (!petId || !user) throw new Error('„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü');\n\n        // Êó¢Â≠ò„ÅÆÊãõÂæÖ„Éá„Éº„Çø„ÇíÂèñÂæó\n        // memberId „ÅØ„É©„É≥„ÉÄ„É†ID\n        const memberRef = doc(db, 'pets', petId, 'members', memberId);\n\n        // Batch„ÅßÂá¶ÁêÜÔºö\n        // 1. Êñ∞„Åó„ÅÑ„Éâ„Ç≠„É•„É°„É≥„Éà‰ΩúÊàêÔºàID: user.uidÔºâ\n        // 2. Âè§„ÅÑ„Éâ„Ç≠„É•„É°„É≥„ÉàÂâäÈô§\n        const batch = writeBatch(db);\n\n        // Êñ∞„Åó„ÅÑ„Éâ„Ç≠„É•„É°„É≥„Éà„ÅÆ„Éá„Éº„Çø (Êó¢Â≠ò„Éá„Éº„Çø„ÅØ„Çµ„Éº„Éê„ÉºÂÅ¥„ÅßÂèñ„Çå„Å™„ÅÑ„ÅÆ„Åß„ÄÅ„Éï„ÉÉ„ÇØ„ÅÆÂ§ñ„Åß„Éá„Éº„Çø„ÇíÊ∏°„ÅôË®≠Ë®à„ÅÆÊñπ„Åå„Ç≠„É¨„Ç§„Å†„Åå„ÄÅ\n        // „Åì„Åì„Åß„ÅØ updateDoc „ÅÆ‰ª£„Çè„Çä„Å´ setDoc „ÅßÊó¢Â≠òÈ†ÖÁõÆ„Çí‰∏äÊõ∏„Åç„Åô„Çã„Ç§„É°„Éº„Ç∏„Åß„ÄÅ\n        // „Åü„Å†„Åó„Éá„Éº„ÇøÁßªË°å„ÅåÂøÖË¶Å„Å™„ÅÆ„Åß„ÄÅ‰∏ÄÊó¶„ÇØ„É©„Ç§„Ç¢„É≥„Éà„ÅßË™≠„ÅøÂèñ„ÇãÂøÖË¶Å„Åå„ÅÇ„Çã„Åã„ÄÅ\n        // „ÅÇ„Çã„ÅÑ„ÅØ useMembers „ÅÆ members state „Åã„ÇâÊé¢„Åô„ÄÇ)\n\n        const invitation = members.find(m => m.id === memberId);\n        if (!invitation) throw new Error('ÊãõÂæÖ„Éá„Éº„Çø„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì');\n\n        const newMemberRef = doc(db, 'pets', petId, 'members', user.uid);\n\n        const newData = {\n            ...invitation, // Êó¢Â≠ò„Éá„Éº„Çø„Çí„Ç≥„Éî„Éº\n            id: user.uid, // ID‰∏äÊõ∏„ÅçÔºàÂøµ„ÅÆ„Åü„ÇÅÔºâ\n            userId: user.uid,\n            status: 'active',\n            updatedBy: user.uid,\n            updatedAt: serverTimestamp(),\n        };\n\n        // ‰∏çË¶Å„Å™„Éï„Ç£„Éº„É´„Éâ„Åå„ÅÇ„Çå„Å∞ÂâäÈô§„Åô„Åπ„Åç„Å†„Åå„ÄÅ„Å®„Çä„ÅÇ„Åà„Åö‰∏äÊõ∏„Åç\n        batch.set(newMemberRef, newData);\n        batch.delete(memberRef); // Âè§„ÅÑÊãõÂæÖ„ÇíÂâäÈô§\n\n        // „Éö„ÉÉ„ÉàËá™‰Ωì„ÅÆÊõ¥Êñ∞ (memberUids„ÅØÂªÉÊ≠¢„Å™„ÅÆ„Åß‰∏çË¶Å„Å†„Åå„ÄÅ„Çø„Ç§„É†„Çπ„Çø„É≥„ÉóÊõ¥Êñ∞„Å™„Å©„ÅÇ„Çå„Å∞)\n        // const petRef = doc(db, 'pets', petId);\n        // batch.update(petRef, { updatedAt: serverTimestamp() });\n\n        await batch.commit();\n    }, [petId, user, members]);\n\n    // ÊãõÂæÖ„ÇíËæûÈÄÄ\n    const declineInvitation = useCallback(async (memberId: string) => {\n        if (!petId || !user) throw new Error('„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü');\n\n        const memberRef = doc(db, 'pets', petId, 'members', memberId);\n        await updateDoc(memberRef, {\n            status: 'declined',\n            userId: user.uid,\n            updatedBy: user.uid,\n            updatedAt: serverTimestamp(),\n        });\n    }, [petId, user]);\n\n    // „É°„É≥„Éê„Éº„ÅÆÊ®©ÈôêÂ§âÊõ¥\n    const updateMemberRole = useCallback(async (memberId: string, newRole: MemberRole) => {\n        if (!petId || !user) throw new Error('„Éö„ÉÉ„Éà„ÅåÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');\n        if (currentUserRole !== 'owner') throw new Error('„Ç™„Éº„Éä„Éº„ÅÆ„ÅøÊ®©Èôê„ÇíÂ§âÊõ¥„Åß„Åç„Åæ„Åô');\n\n        const member = members.find((m) => m.id === memberId);\n        if (!member) throw new Error('„É°„É≥„Éê„Éº„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì');\n\n        // Ëá™ÂàÜËá™Ë∫´„ÅÆ„Ç™„Éº„Éä„ÉºÊ®©Èôê„ÇíÂ§ñ„ÅôÂ†¥Âêà„ÄÅ‰ªñ„Å´„Ç™„Éº„Éä„Éº„Åå„ÅÑ„Çã„ÅãÁ¢∫Ë™ç\n        if (member.userId === user.uid && member.role === 'owner' && newRole !== 'owner') {\n            const otherOwners = members.filter((m) => m.role === 'owner' && m.id !== memberId);\n            if (otherOwners.length === 0) {\n                throw new Error('ÊúÄ‰Ωé1‰∫∫„ÅÆ„Ç™„Éº„Éä„Éº„ÅåÂøÖË¶Å„Åß„Åô„ÄÇÂÖà„Å´‰ªñ„ÅÆ„É°„É≥„Éê„Éº„Çí„Ç™„Éº„Éä„Éº„Å´Ë®≠ÂÆö„Åó„Å¶„Åè„Å†„Åï„ÅÑ');\n            }\n        }\n\n        const memberRef = doc(db, 'pets', petId, 'members', memberId);\n        await updateDoc(memberRef, {\n            role: newRole,\n            updatedBy: user.uid,\n            updatedAt: serverTimestamp(),\n        });\n    }, [petId, user, currentUserRole, members]);\n\n    // „Ç™„Éº„Éä„ÉºÊ®©Èôê„ÅÆË≠≤Ê∏°\n    const transferOwnership = useCallback(async (newOwnerId: string) => {\n        if (!petId || !user) throw new Error('„Éö„ÉÉ„Éà„ÅåÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');\n        if (currentUserRole !== 'owner') throw new Error('„Ç™„Éº„Éä„Éº„ÅÆ„ÅøÊ®©Èôê„ÇíË≠≤Ê∏°„Åß„Åç„Åæ„Åô');\n\n        const newOwner = members.find((m) => m.id === newOwnerId);\n        if (!newOwner) throw new Error('„É°„É≥„Éê„Éº„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì');\n        if (newOwner.role === 'owner') throw new Error('Êó¢„Å´„Ç™„Éº„Éä„Éº„Åß„Åô');\n\n        // Êñ∞„Åó„ÅÑ„Ç™„Éº„Éä„Éº„ÇíË®≠ÂÆö\n        const newOwnerRef = doc(db, 'pets', petId, 'members', newOwnerId);\n        await updateDoc(newOwnerRef, {\n            role: 'owner',\n            updatedBy: user.uid,\n            updatedAt: serverTimestamp(),\n        });\n\n        // ÁèæÂú®„ÅÆ„É¶„Éº„Ç∂„Éº„Çí editor „Å´Â§âÊõ¥\n        const currentMember = members.find((m) => m.userId === user.uid || m.id === user.uid);\n        if (currentMember) {\n            const currentMemberRef = doc(db, 'pets', petId, 'members', currentMember.id);\n            await updateDoc(currentMemberRef, {\n                role: 'editor',\n                updatedBy: user.uid,\n                updatedAt: serverTimestamp(),\n            });\n        }\n    }, [petId, user, currentUserRole, members]);\n\n    // „É°„É≥„Éê„Éº„ÇíÂâäÈô§\n    const removeMember = useCallback(async (memberId: string) => {\n        if (!petId || !user) throw new Error('„Éö„ÉÉ„Éà„ÅåÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');\n        if (currentUserRole !== 'owner') throw new Error('„Ç™„Éº„Éä„Éº„ÅÆ„ÅøÂâäÈô§„Åß„Åç„Åæ„Åô');\n\n        const member = members.find((m) => m.id === memberId);\n        if (!member) throw new Error('„É°„É≥„Éê„Éº„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì');\n\n        // „Ç™„Éº„Éä„Éº„ÅØÂâäÈô§„Åß„Åç„Å™„ÅÑÔºàËá™ÂàÜÂê´„ÇÄÔºâ\n        if (member.role === 'owner') {\n            throw new Error('„Ç™„Éº„Éä„Éº„ÅØÂâäÈô§„Åß„Åç„Åæ„Åõ„Çì„ÄÇÂÖà„Å´Ê®©Èôê„ÇíÂ§âÊõ¥„Åó„Å¶„Åè„Å†„Åï„ÅÑ');\n        }\n\n        const batch = writeBatch(db);\n\n        // Áâ©ÁêÜÂâäÈô§\n        const memberRef = doc(db, 'pets', petId, 'members', memberId);\n        batch.delete(memberRef);\n\n        await batch.commit();\n    }, [petId, user, currentUserRole, members]);\n\n    // Ëá™ÂàÜ„ÅåËÑ±ÈÄÄ\n    const leaveTeam = useCallback(async () => {\n        if (!petId || !user) throw new Error('„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü');\n        if (currentUserRole === 'owner') {\n            const otherOwners = members.filter((m) => m.role === 'owner' && m.userId !== user.uid);\n            if (otherOwners.length === 0) {\n                throw new Error('„ÅÇ„Å™„Åü„ÅåÂîØ‰∏Ä„ÅÆ„Ç™„Éº„Éä„Éº„Åß„Åô„ÄÇËÑ±ÈÄÄ„Åô„ÇãÂâç„Å´‰ªñ„ÅÆ„É°„É≥„Éê„Éº„Çí„Ç™„Éº„Éä„Éº„Å´Ë®≠ÂÆö„Åó„Å¶„Åè„Å†„Åï„ÅÑ');\n            }\n        }\n\n        const currentMember = members.find((m) => m.userId === user.uid || m.id === user.uid);\n        if (!currentMember) throw new Error('„É°„É≥„Éê„Éº„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì');\n\n        const batch = writeBatch(db);\n\n        // Áâ©ÁêÜÂâäÈô§\n        const memberRef = doc(db, 'pets', petId, 'members', currentMember.id);\n        batch.delete(memberRef);\n\n        await batch.commit();\n    }, [petId, user, currentUserRole, members]);\n\n    // Ê®©Èôê„Å´Âøú„Åò„ÅüÊìç‰ΩúÂèØÂê¶\n    const canEdit = currentUserRole === 'owner' || currentUserRole === 'editor';\n    const canManageMembers = currentUserRole === 'owner';\n\n    return {\n        members,\n        loading,\n        currentUserRole,\n        isOwner: currentUserRole === 'owner',\n        canEdit,\n        canManageMembers,\n        inviteMember,\n        acceptInvitation,\n        declineInvitation,\n        updateMemberRole,\n        transferOwnership,\n        removeMember,\n        leaveTeam,\n    };\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/hooks/usePendingInvitations.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'useCallback' is defined but never used.",
        "line": 3,
        "column": 31,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 3,
        "endColumn": 42
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'collection' is defined but never used.",
        "line": 4,
        "column": 10,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 4,
        "endColumn": 20
      },
      {
        "ruleId": "react-hooks/set-state-in-effect",
        "severity": 2,
        "message": "Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/hooks/usePendingInvitations.ts:21:13\n  19 |     useEffect(() => {\n  20 |         if (!user?.email) {\n> 21 |             setInvitations([]);\n     |             ^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  22 |             setLoading(false);\n  23 |             return;\n  24 |         }",
        "line": 21,
        "column": 13,
        "nodeType": null,
        "endLine": 21,
        "endColumn": 27
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 2,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { collection, query, where, onSnapshot, collectionGroup } from 'firebase/firestore';\nimport { db } from '@/lib/firebase';\nimport { useAuth } from '@/contexts/AuthContext';\nimport type { Pet, Member } from '@/lib/types';\n\ninterface PendingInvitation {\n    pet: Pet;\n    member: Member;\n}\n\nexport function usePendingInvitations() {\n    const { user } = useAuth();\n    const [invitations, setInvitations] = useState<PendingInvitation[]>([]);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        if (!user?.email) {\n            setInvitations([]);\n            setLoading(false);\n            return;\n        }\n\n        // Ëá™ÂàÜÂÆõ„ÅÆ‰øùÁïô‰∏≠„ÅÆÊãõÂæÖ„ÇíÂèñÂæó\n        const invitationsQuery = query(\n            collectionGroup(db, 'members'),\n            where('inviteEmail', '==', user.email.toLowerCase()),\n            where('status', '==', 'pending')\n        );\n\n        const unsubscribe = onSnapshot(invitationsQuery, (snapshot) => {\n            const pendingInvitations: PendingInvitation[] = [];\n\n            snapshot.docs.forEach((docSnap) => {\n                const member = { id: docSnap.id, ...docSnap.data() } as Member;\n                const petRef = docSnap.ref.parent.parent;\n\n                if (petRef) {\n                    pendingInvitations.push({\n                        pet: {\n                            id: petRef.id,\n                            name: member.petName || '‰∏çÊòé„Å™„Éö„ÉÉ„Éà',\n                            avatarUrl: member.petAvatarUrl,\n                            // ‰ªñ„ÅÆÂøÖÈ†à„Éï„Ç£„Éº„É´„Éâ„ÅØÈÅ©ÂΩì„Å´Âüã„ÇÅ„Çã„Åã„ÄÅPartial„Å´„Åô„Çã\n                            createdAt: member.createdAt,\n                            updatedAt: member.updatedAt,\n                            createdBy: '',\n                            updatedBy: '',\n                        } as Pet,\n                        member,\n                    });\n                }\n            });\n\n            setInvitations(pendingInvitations);\n            setLoading(false);\n        });\n\n        return () => unsubscribe();\n    }, [user]);\n\n    return { invitations, loading };\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/hooks/usePets.ts",
    "messages": [
      {
        "ruleId": "react-hooks/set-state-in-effect",
        "severity": 2,
        "message": "Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/hooks/usePets.ts:18:13\n  16 |     useEffect(() => {\n  17 |         if (!user) {\n> 18 |             setPets([]);\n     |             ^^^^^^^ Avoid calling setState() directly within an effect\n  19 |             setLoading(false);\n  20 |             return;\n  21 |         }",
        "line": 18,
        "column": 13,
        "nodeType": null,
        "endLine": 18,
        "endColumn": 20
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport {\n    collection, query, where, onSnapshot, addDoc, updateDoc, deleteDoc, doc, serverTimestamp, collectionGroup, setDoc, Timestamp,\n} from 'firebase/firestore';\nimport { db } from '@/lib/firebase';\nimport { useAuth } from '@/contexts/AuthContext';\nimport type { Pet, Member } from '@/lib/types';\n\nexport function usePets() {\n    const { user } = useAuth();\n    const [pets, setPets] = useState<Pet[]>([]);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        if (!user) {\n            setPets([]);\n            setLoading(false);\n            return;\n        }\n\n        let petUnsubscribes: (() => void)[] = [];\n\n        const membersQuery = query(\n            collectionGroup(db, 'members'),\n            where('userId', '==', user.uid),\n            where('status', '==', 'active')\n        );\n\n        const unsubscribeMembers = onSnapshot(membersQuery, (snapshot) => {\n            // Êó¢Â≠ò„ÅÆ„Éö„ÉÉ„Éà„É™„Çπ„Éä„Éº„ÇíËß£Èô§\n            petUnsubscribes.forEach(unsub => unsub());\n            petUnsubscribes = [];\n\n            const petIds = snapshot.docs.map((doc) => doc.ref.parent.parent?.id).filter(Boolean) as string[];\n            const uniquePetIds = Array.from(new Set(petIds));\n\n            if (uniquePetIds.length === 0) {\n                setPets([]);\n                setLoading(false);\n                return;\n            }\n\n            // Êñ∞„Åó„ÅÑ„Éö„ÉÉ„Éà„É™„Çπ„Éà„Å´Âü∫„Å•„ÅÑ„Å¶State„ÇíÂàùÊúüÂåñÔºàÂâäÈô§„Åï„Çå„Åü„Éö„ÉÉ„Éà„ÇíÈô§ÂéªÔºâ\n            setPets(prev => prev.filter(p => uniquePetIds.includes(p.id)));\n\n            // ÂêÑ„Éö„ÉÉ„Éà„ÅÆ„É™„Çπ„Éä„Éº„ÇíË®≠ÂÆö\n            uniquePetIds.forEach((petId) => {\n                const petRef = doc(db, 'pets', petId);\n                const unsub = onSnapshot(petRef, (petSnap) => {\n                    if (petSnap.exists()) {\n                        const petData = { id: petSnap.id, ...petSnap.data() } as Pet;\n                        setPets((prev) => {\n                            const index = prev.findIndex((p) => p.id === petId);\n                            if (index >= 0) {\n                                // Â§âÊõ¥„Åå„Å™„ÅÑÂ†¥Âêà„ÅØÊõ¥Êñ∞„Åó„Å™„ÅÑÔºà„É¨„É≥„ÉÄ„É™„É≥„Ç∞ÊúÄÈÅ©ÂåñÔºâ\n                                if (JSON.stringify(prev[index]) === JSON.stringify(petData)) return prev;\n                                const updated = [...prev];\n                                updated[index] = petData;\n                                return updated;\n                            }\n                            return [...prev, petData];\n                        });\n                    } else {\n                        // „Éö„ÉÉ„ÉàËá™‰Ωì„ÅåÂâäÈô§„Åï„Çå„ÅüÂ†¥Âêà\n                        setPets((prev) => prev.filter((p) => p.id !== petId));\n                    }\n                }, (error) => {\n                    console.error(`Error fetching pet ${petId}:`, error);\n                    // Ê®©Èôê„Ç®„É©„Éº„Å™„Å©„ÅßË™≠„ÇÅ„Å™„Åè„Å™„Å£„ÅüÂ†¥Âêà„ÇÇÂâäÈô§\n                    setPets((prev) => prev.filter((p) => p.id !== petId));\n                });\n                petUnsubscribes.push(unsub);\n            });\n\n            setLoading(false);\n        });\n\n        return () => {\n            unsubscribeMembers();\n            petUnsubscribes.forEach(unsub => unsub());\n        };\n    }, [user]);\n\n    const addPet = useCallback(async (petData: Omit<Pet, 'id' | 'createdAt' | 'createdBy' | 'updatedAt' | 'updatedBy' | 'memberUids'>) => {\n        if (!user) throw new Error('Ë™çË®º„ÅåÂøÖË¶Å„Åß„Åô');\n\n        // 1. „Éö„ÉÉ„Éà‰ΩúÊàê (memberUids„ÅØ‰∏çË¶Å)\n        const petRef = await addDoc(collection(db, 'pets'), {\n            ...petData,\n            createdBy: user.uid,\n            updatedBy: user.uid,\n            createdAt: serverTimestamp(),\n            updatedAt: serverTimestamp(),\n        });\n\n        const memberData: Partial<Member> = {\n            userId: user.uid,\n            role: 'owner',\n            status: 'active',\n            inviteEmail: user.email?.toLowerCase() || '',\n            invitedBy: user.uid,\n            invitedAt: Timestamp.now(),\n            updatedBy: user.uid,\n            createdAt: Timestamp.now(),\n            updatedAt: Timestamp.now(),\n            // Ë°®Á§∫Áî®ÔºàÈùûÊ≠£Ë¶èÂåñÔºâ\n            petName: petData.name,\n        };\n\n        if (petData.avatarUrl) {\n            memberData.petAvatarUrl = petData.avatarUrl;\n        }\n\n        // 2. „É°„É≥„Éê„Éº‰ΩúÊàê (ID„ÇíUID„Å´„Åô„Çã)\n        await setDoc(doc(db, 'pets', petRef.id, 'members', user.uid), memberData);\n\n        return petRef.id;\n    }, [user]);\n\n    const updatePet = useCallback(async (petId: string, petData: Partial<Omit<Pet, 'id' | 'createdAt' | 'createdBy' | 'updatedAt' | 'updatedBy' | 'memberUids'>>) => {\n        if (!user) throw new Error('Ë™çË®º„ÅåÂøÖË¶Å„Åß„Åô');\n        const petRef = doc(db, 'pets', petId);\n        await updateDoc(petRef, {\n            ...petData,\n            updatedBy: user.uid,\n            updatedAt: serverTimestamp()\n        });\n    }, [user]);\n\n    const deletePet = useCallback(async (petId: string) => {\n        const petRef = doc(db, 'pets', petId);\n        await deleteDoc(petRef);\n    }, []);\n\n    return { pets, loading, addPet, updatePet, deletePet };\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/hooks/useTimeFormat.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/hooks/useWeights.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/lib/cache.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'_error' is defined but never used.",
        "line": 52,
        "column": 14,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 52,
        "endColumn": 20
      }
    ],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 1,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "/**\n * „Çª„ÉÉ„Ç∑„Éß„É≥„Éô„Éº„Çπ„ÅÆ„Ç≠„É£„ÉÉ„Ç∑„É•„É¶„Éº„ÉÜ„Ç£„É™„ÉÜ„Ç£\n * \n * „Çø„Éñ„ÇíÈñâ„Åò„Çã„Å®„ÇØ„É™„Ç¢„Åï„Çå„ÇãsessionStorage„Çí‰ΩøÁî®\n * ÂàùÊúü„Éá„Éº„Çø„É≠„Éº„Éâ„ÇíÈ´òÈÄüÂåñ„Åó„Å§„Å§„ÄÅonSnapshot„Åß„É™„Ç¢„É´„Çø„Ç§„É†Êõ¥Êñ∞„ÇíÁ∂≠ÊåÅ\n */\n\ninterface CacheEntry<T> {\n    data: T;\n    timestamp: number;\n}\n\nconst CACHE_PREFIX = 'aina_cache_';\nconst DEFAULT_TTL = 5 * 60 * 1000; // 5ÂàÜ\n\n/**\n * „Ç≠„É£„ÉÉ„Ç∑„É•„Åã„Çâ„Éá„Éº„Çø„ÇíÂèñÂæó\n */\nexport function getCache<T>(key: string): T | null {\n    if (typeof window === 'undefined') return null;\n\n    try {\n        const cached = sessionStorage.getItem(CACHE_PREFIX + key);\n        if (!cached) return null;\n\n        const entry: CacheEntry<T> = JSON.parse(cached);\n\n        // TTL„ÉÅ„Çß„ÉÉ„ÇØ\n        if (Date.now() - entry.timestamp > DEFAULT_TTL) {\n            sessionStorage.removeItem(CACHE_PREFIX + key);\n            return null;\n        }\n\n        return entry.data;\n    } catch {\n        return null;\n    }\n}\n\n/**\n * „Ç≠„É£„ÉÉ„Ç∑„É•„Å´„Éá„Éº„Çø„Çí‰øùÂ≠ò\n */\nexport function setCache<T>(key: string, data: T): void {\n    if (typeof window === 'undefined') return;\n\n    try {\n        const entry: CacheEntry<T> = {\n            data,\n            timestamp: Date.now(),\n        };\n        sessionStorage.setItem(CACHE_PREFIX + key, JSON.stringify(entry));\n    } catch (_error) {\n        // sessionStorage„Åå„ÅÑ„Å£„Å±„ÅÑ„ÅÆÂ†¥Âêà„ÅØÂè§„ÅÑ„Ç≠„É£„ÉÉ„Ç∑„É•„Çí„ÇØ„É™„Ç¢\n        console.warn('[Cache] Storage full, clearing old entries');\n        clearOldCache();\n    }\n}\n\n/**\n * ÁâπÂÆö„ÅÆ„Ç≠„É£„ÉÉ„Ç∑„É•„ÇíÂâäÈô§\n */\nexport function removeCache(key: string): void {\n    if (typeof window === 'undefined') return;\n    sessionStorage.removeItem(CACHE_PREFIX + key);\n}\n\n/**\n * „Éë„Çø„Éº„É≥„Å´„Éû„ÉÉ„ÉÅ„Åô„Çã„Ç≠„É£„ÉÉ„Ç∑„É•„ÇíÂâäÈô§\n */\nexport function invalidateCachePattern(pattern: string): void {\n    if (typeof window === 'undefined') return;\n\n    const keysToRemove: string[] = [];\n    for (let i = 0; i < sessionStorage.length; i++) {\n        const key = sessionStorage.key(i);\n        if (key?.startsWith(CACHE_PREFIX) && key.includes(pattern)) {\n            keysToRemove.push(key);\n        }\n    }\n    keysToRemove.forEach(key => sessionStorage.removeItem(key));\n}\n\n/**\n * ÂÖ®„Ç≠„É£„ÉÉ„Ç∑„É•„Çí„ÇØ„É™„Ç¢\n */\nexport function clearAllCache(): void {\n    if (typeof window === 'undefined') return;\n\n    const keysToRemove: string[] = [];\n    for (let i = 0; i < sessionStorage.length; i++) {\n        const key = sessionStorage.key(i);\n        if (key?.startsWith(CACHE_PREFIX)) {\n            keysToRemove.push(key);\n        }\n    }\n    keysToRemove.forEach(key => sessionStorage.removeItem(key));\n}\n\n/**\n * Âè§„ÅÑ„Ç≠„É£„ÉÉ„Ç∑„É•„Ç®„É≥„Éà„É™„ÇíÂâäÈô§\n */\nfunction clearOldCache(): void {\n    const keysToRemove: string[] = [];\n    for (let i = 0; i < sessionStorage.length; i++) {\n        const key = sessionStorage.key(i);\n        if (key?.startsWith(CACHE_PREFIX)) {\n            try {\n                const entry = JSON.parse(sessionStorage.getItem(key) || '{}');\n                if (Date.now() - entry.timestamp > DEFAULT_TTL) {\n                    keysToRemove.push(key);\n                }\n            } catch {\n                keysToRemove.push(key);\n            }\n        }\n    }\n    keysToRemove.forEach(key => sessionStorage.removeItem(key));\n}\n\n/**\n * „Ç≠„É£„ÉÉ„Ç∑„É•„Ç≠„ÉºÁîüÊàê„Éò„É´„Éë„Éº\n */\nexport const cacheKeys = {\n    pets: (userId: string) => `pets_${userId}`,\n    friends: (petId: string) => `friends_${petId}`,\n    weights: (petId: string) => `weights_${petId}`,\n    entries: (petId: string, month: string) => `entries_${petId}_${month}`,\n    tasks: (petId: string) => `tasks_${petId}`,\n};\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/lib/constants/colors.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/lib/constants/species.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/lib/cropImage.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 1,
        "message": "'_reject' is defined but never used.",
        "line": 84,
        "column": 34,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 84,
        "endColumn": 41
      }
    ],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 1,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "export const createImage = (url: string): Promise<HTMLImageElement> =>\n    new Promise((resolve, reject) => {\n        const image = new Image()\n        image.addEventListener('load', () => resolve(image))\n        image.addEventListener('error', (error) => reject(error))\n        image.setAttribute('crossOrigin', 'anonymous')\n        image.src = url\n    })\n\nexport function getRadianAngle(degreeValue: number) {\n    return (degreeValue * Math.PI) / 180\n}\n\n/**\n * Returns the new bounding area of a rotated rectangle.\n */\nexport function rotateSize(width: number, height: number, rotation: number) {\n    const rotRad = getRadianAngle(rotation)\n\n    return {\n        width:\n            Math.abs(Math.cos(rotRad) * width) + Math.abs(Math.sin(rotRad) * height),\n        height:\n            Math.abs(Math.sin(rotRad) * width) + Math.abs(Math.cos(rotRad) * height),\n    }\n}\n\n/**\n * This function was adapted from the one in the ReadMe of https://github.com/DominicTobias/react-image-crop\n */\nexport default async function getCroppedImg(\n    imageSrc: string,\n    pixelCrop: { x: number; y: number; width: number; height: number },\n    rotation = 0,\n    flip = { horizontal: false, vertical: false }\n): Promise<Blob | null> {\n    const image = await createImage(imageSrc)\n    const canvas = document.createElement('canvas')\n    const ctx = canvas.getContext('2d')\n\n    if (!ctx) {\n        return null\n    }\n\n    const rotRad = getRadianAngle(rotation)\n\n    // calculate bounding box of the rotated image\n    const { width: bBoxWidth, height: bBoxHeight } = rotateSize(\n        image.width,\n        image.height,\n        rotation\n    )\n\n    // set canvas size to match the bounding box\n    canvas.width = bBoxWidth\n    canvas.height = bBoxHeight\n\n    // translate canvas context to a central location to allow rotating and flipping around the center\n    ctx.translate(bBoxWidth / 2, bBoxHeight / 2)\n    ctx.rotate(rotRad)\n    ctx.scale(flip.horizontal ? -1 : 1, flip.vertical ? -1 : 1)\n    ctx.translate(-image.width / 2, -image.height / 2)\n\n    // draw rotated image\n    ctx.drawImage(image, 0, 0)\n\n    // croppedAreaPixels values are bounding box relative\n    // extract the cropped image using these values\n    const data = ctx.getImageData(\n        pixelCrop.x,\n        pixelCrop.y,\n        pixelCrop.width,\n        pixelCrop.height\n    )\n\n    // set canvas width to final desired crop size - this will clear existing context\n    canvas.width = pixelCrop.width\n    canvas.height = pixelCrop.height\n\n    // paste generated rotate image at the top left corner\n    ctx.putImageData(data, 0, 0)\n\n    // As a blob\n    return new Promise((resolve, _reject) => {\n        canvas.toBlob((file) => {\n            resolve(file)\n        }, 'image/jpeg')\n    })\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/lib/errorHandler.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/lib/firebase.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/lib/types.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "/Users/nakajimadaichi/huku/ebi/firebase/aina-life/src/lib/utils.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  }
]
